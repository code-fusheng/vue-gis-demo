import{a6 as Oe,a as Se,g as Yt,bg as on,D as Xe,n as Z,r as ft,Z as ht,z as es,_ as Kr,Y as Zr,$ as Wt,a0 as $i,m as Ke,a3 as Qe,ao as Ut,bh as bl,bi as ts,b3 as Ll,Q as Ot,b0 as Al,bj as is,bk as qr,ae as Hr,ac as De,v as an,bl as ro,bm as Ie,u as je,W as Ge,E as no,an as rr,ag as Ol,ab as yi,o as so,bn as Ct,bo as nr,bp as ln,K as ut,bq as Er,aj as rs,ai as Fi,br as ns,bs as oo,L as Fl,a1 as Ml,a4 as ss,bt as vt,bu as Nl,a2 as cn,O as Gl,a7 as Yr,a9 as Dl,a8 as zl,bv as Vl,bw as _i,bx as jl,J as ao,H as lo,ap as co,by as os,b1 as Lt,bz as kl,bA as uo,al as Bl,bB as Ul,bC as $l,d as Ae,b6 as ho,bc as as,i as Kl,bD as fo,aP as go,B as Zl,bE as ql,bF as Hl,bG as Yl,bH as mo,bI as Wl,bJ as Xl,M as Wr,aX as ls,b7 as Ql,b8 as Jl,bK as cs,bL as ec,ba as Tr,V as fi,bM as us,x as tc,bf as ic,b9 as hs,bN as Xt,bO as po,bP as un,bQ as sr,h as nt,P as He,aI as yo,aJ as hn,aK as dn,aG as fn,bR as rc,k as or,af as _o,bS as nc,bT as sc,bU as oc,a_ as ac,bV as lc,bW as cc,bX as uc,bY as hc,bZ as ds,b_ as dc,b$ as fc,c0 as gc,c1 as mc,c2 as pc,c3 as ki,c4 as wo,c5 as vo,c6 as So,c7 as yc,c8 as fs,c9 as gs,A as _c,ca as xr,cb as wc,cc as vc,cd as ms,ce as ps,cf as Sc,cg as Cc,ch as Ec,ci as Tc,cj as xc,ck as Rc,cl as Pc,cm as Ic,cn as bc,co as Lc,cp as Ac,cq as Oc,S as Ee,T as Ki,F as Be,C as Zi,e as ot,cr as Rr,b as Me,G as oi,cs as ai,ct as ys,j as _s,cu as Fc,cv as Mc}from"./Select-73cfa6a9.js";import{b as Et,e as Ei,d as Ti,f as qi,g as Nc,X as xi,h as ar,i as Gc,E as Co,j as Eo,k as Pr,r as To,l as lr,m as Dc,n as zc,o as xo,p as wi,q as Ir,s as cr,t as Ro,I as Vc,u as gn,T as Bt,A as jc,v as Po,w as Io,x as kc,U as bo,y as Bc,z as Uc,L as $c,O as Bi,B as Kc,C as Zc,G as qc,H as Hc,J as Yc,K as Wc,N as Mi,F as Xc,Z as Qc,a as Jc,D as eu,M as tu,c as iu}from"./ZoomToExtent-75a5a125.js";import{h as Tt,i as de,j as ru,r as Ri,b as Pt,o as yt,c as Gt,a as We,d as H,w as Y,k as ws,l as nu,e as ie,t as Dt,F as li,f as ci}from"./index-13ed24c7.js";import{C as su,a as ou}from"./Cluster-5304c38e.js";import br from"./__vite-browser-external-024afdea.js";import{V as au,S as lu}from"./Viewer-0cc3e44d.js";function ur(n,e,t,i){const r=document.createElement("script"),s="olc_"+Oe(e);function o(){delete window[s],r.parentNode.removeChild(r)}r.async=!0,r.src=n+(n.includes("?")?"&":"?")+(i||"callback")+"="+s;const a=setTimeout(function(){o(),t&&t()},1e4);window[s]=function(l){clearTimeout(a),o(),e(l)},document.head.appendChild(r)}function cu(n){const e=n[0],t=new Array(e);let i=1<<e-1,r,s;for(r=0;r<e;++r)s=48,n[1]&i&&(s+=1),n[2]&i&&(s+=2),t[r]=String.fromCharCode(s),i>>=1;return t.join("")}const uu='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>';class hu extends Et{constructor(e){const t=e.hidpi!==void 0?e.hidpi:!1;super({cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,opaque:!0,projection:Se("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,tilePixelRatio:t?2:1,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.hidpi_=t,this.culture_=e.culture!==void 0?e.culture:"en-us",this.maxZoom_=e.maxZoom!==void 0?e.maxZoom:-1,this.apiKey_=e.key,this.imagerySet_=e.imagerySet;const i="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+this.apiKey_+"&c="+this.culture_;ur(i,this.handleImageryMetadataResponse.bind(this),void 0,"jsonp")}getApiKey(){return this.apiKey_}getImagerySet(){return this.imagerySet_}handleImageryMetadataResponse(e){if(e.statusCode!=200||e.statusDescription!="OK"||e.authenticationResultCode!="ValidCredentials"||e.resourceSets.length!=1||e.resourceSets[0].resources.length!=1){this.setState("error");return}const t=e.resourceSets[0].resources[0],i=this.maxZoom_==-1?t.zoomMax:this.maxZoom_,r=this.getProjection(),s=Ei(r),o=this.hidpi_?2:1,a=t.imageWidth==t.imageHeight?t.imageWidth/o:[t.imageWidth/o,t.imageHeight/o],l=Ti({extent:s,minZoom:t.zoomMin,maxZoom:i,tileSize:a});this.tileGrid=l;const u=this.culture_,c=this.hidpi_;if(this.tileUrlFunction=qi(t.imageUrlSubdomains.map(function(p){const _=[0,0,0],w=t.imageUrl.replace("{subdomain}",p).replace("{culture}",u);return function(v,E,x){if(!v)return;Nc(v[0],v[1],v[2],_);let L=w;return c&&(L+="&dpi=d1&device=mobile"),L.replace("{quadkey}",cu(_))}})),t.imageryProviders){const p=Yt(Se("EPSG:4326"),this.getProjection());this.setAttributions(_=>{const w=[],v=_.viewState,E=this.getTileGrid(),x=E.getZForResolution(v.resolution,this.zDirection),P=E.getTileCoordForCoordAndZ(v.center,x)[0];return t.imageryProviders.map(function(b){let O=!1;const k=b.coverageAreas;for(let K=0,z=k.length;K<z;++K){const D=k[K];if(P>=D.zoomMin&&P<=D.zoomMax){const V=D.bbox,Q=[V[1],V[0],V[3],V[2]],W=on(Q,p);if(Xe(W,_.extent)){O=!0;break}}}O&&w.push(b.attribution)}),w.push(uu),w})}this.setState("ready")}}const du=hu;class fu extends xi{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,maxZoom:e.maxZoom!==void 0?e.maxZoom:18,minZoom:e.minZoom,projection:e.projection,transition:e.transition,wrapX:e.wrapX,zDirection:e.zDirection}),this.account_=e.account,this.mapId_=e.map||"",this.config_=e.config||{},this.templateCache_={},this.initializeMap_()}getConfig(){return this.config_}updateConfig(e){Object.assign(this.config_,e),this.initializeMap_()}setConfig(e){this.config_=e||{},this.initializeMap_()}initializeMap_(){const e=JSON.stringify(this.config_);if(this.templateCache_[e]){this.applyTemplate_(this.templateCache_[e]);return}let t="https://"+this.account_+".carto.com/api/v1/map";this.mapId_&&(t+="/named/"+this.mapId_);const i=new XMLHttpRequest;i.addEventListener("load",this.handleInitResponse_.bind(this,e)),i.addEventListener("error",this.handleInitError_.bind(this)),i.open("POST",t),i.setRequestHeader("Content-type","application/json"),i.send(JSON.stringify(this.config_))}handleInitResponse_(e,t){const i=t.target;if(!i.status||i.status>=200&&i.status<300){let r;try{r=JSON.parse(i.responseText)}catch{this.setState("error");return}this.applyTemplate_(r),this.templateCache_[e]=r,this.setState("ready")}else this.setState("error")}handleInitError_(e){this.setState("error")}applyTemplate_(e){const t="https://"+e.cdn_url.https+"/"+this.account_+"/api/v1/map/"+e.layergroupid+"/{z}/{x}/{y}.png";this.setUrl(t)}}const gu=fu;function Lo(n){return n instanceof Image||n instanceof HTMLCanvasElement||n instanceof HTMLVideoElement?n:null}function mu(n){return n instanceof Uint8Array||n instanceof Uint8ClampedArray||n instanceof Float32Array||n instanceof DataView?n:null}let ui=null;function pu(n){ui||(ui=ft(n.width,n.height,void 0,{willReadFrequently:!0}));const e=ui.canvas,t=n.width;e.width!==t&&(e.width=t);const i=n.height;return e.height!==i&&(e.height=i),ui.drawImage(n,t,i),ui.getImageData(0,0,t,i).data}const yu=[256,256];let _u=class extends ar{constructor(e){const t=Z.IDLE;super(e.tileCoord,t,{transition:e.transition,interpolate:e.interpolate}),this.loader_=e.loader,this.data_=null,this.error_=null,this.size_=e.size||null}getSize(){if(this.size_)return this.size_;const e=Lo(this.data_);return e?[e.width,e.height]:yu}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Z.IDLE&&this.state!==Z.ERROR)return;this.state=Z.LOADING,this.changed();const e=this;this.loader_().then(function(t){e.data_=t,e.state=Z.LOADED,e.changed()}).catch(function(t){e.error_=t,e.state=Z.ERROR,e.changed()})}};const Ao=_u;class wu extends Ao{constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8Array(4)),interpolate:e.interpolate,transition:e.transition}),this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const t=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),i=this.targetTileGrid_.getExtent();let r=this.sourceTileGrid_.getExtent();const s=i?ht(t,i):t;if(es(s)===0){this.state=Z.EMPTY;return}const o=e.sourceProj,a=o.getExtent();a&&(r?r=ht(r,a):r=a);const l=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),u=e.targetProj,c=Gc(o,u,s,l);if(!isFinite(c)||c<=0){this.state=Z.EMPTY;return}const p=e.errorThreshold!==void 0?e.errorThreshold:Co;if(this.triangulation_=new Eo(o,u,s,r,c*p,l),this.triangulation_.getTriangles().length===0){this.state=Z.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(c);let _=this.triangulation_.calculateSourceExtent();if(r&&(o.canWrapX()?(_[1]=Kr(_[1],r[1],r[3]),_[3]=Kr(_[3],r[1],r[3])):_=ht(_,r)),!es(_))this.state=Z.EMPTY;else{const w=this.sourceTileGrid_.getTileRangeForExtentAndZ(_,this.sourceZ_),v=e.getTileFunction;for(let E=w.minX;E<=w.maxX;E++)for(let x=w.minY;x<=w.maxY;x++){const L=v(this.sourceZ_,E,x,this.pixelRatio_);L&&this.sourceTiles_.push(L)}this.sourceTiles_.length===0&&(this.state=Z.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const e=[];if(this.sourceTiles_.forEach(t=>{if(!t||t.getState()!==Z.LOADED)return;const i=t.getSize(),r=this.gutter_;let s;const o=mu(t.getData());o?s=o:s=pu(Lo(t.getData()));const a=[i[0]+2*r,i[1]+2*r],l=s instanceof Float32Array,u=a[0]*a[1],c=l?Float32Array:Uint8Array,p=new c(s.buffer),_=c.BYTES_PER_ELEMENT,w=_*p.length/u,v=p.byteLength/a[1],E=Math.floor(v/_/a[0]),x=u*E;let L=p;if(p.length!==x){L=new c(x);let P=0,b=0;const O=a[0]*E;for(let k=0;k<a[1];++k){for(let K=0;K<O;++K)L[P++]=p[b+K];b+=v/_}}e.push({extent:this.sourceTileGrid_.getTileCoordExtent(t.tileCoord),data:new Uint8Array(L.buffer),dataType:c,bytesPerPixel:w,pixelSize:a})}),this.sourceTiles_.length=0,e.length===0)this.state=Z.ERROR;else{const t=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(t),r=typeof i=="number"?i:i[0],s=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(t),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let u,c;const p=e[0].bytesPerPixel,_=Math.ceil(p/3);for(let w=_-1;w>=0;--w){const v=[];for(let O=0,k=e.length;O<k;++O){const K=e[O],z=K.data,D=K.pixelSize,V=D[0],Q=D[1],W=ft(V,Q,Pr),pe=W.createImageData(V,Q),ce=pe.data;let ue=w*3;for(let Re=0,Pe=ce.length;Re<Pe;Re+=4)ce[Re]=z[ue],ce[Re+1]=z[ue+1],ce[Re+2]=z[ue+2],ce[Re+3]=255,ue+=p;W.putImageData(pe,0,0),v.push({extent:K.extent,image:W.canvas})}const E=To(r,s,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,v,this.gutter_,!1,!1);for(let O=0,k=v.length;O<k;++O){const z=v[O].image.getContext("2d");Zr(z),Pr.push(z.canvas)}const x=E.getContext("2d"),L=x.getImageData(0,0,E.width,E.height);Zr(x),Pr.push(E),u||(c=new Uint8Array(p*L.width*L.height),u=new e[0].dataType(c.buffer));const P=L.data;let b=w*3;for(let O=0,k=P.length;O<k;O+=4)P[O+3]===255?(c[b]=P[O],c[b+1]=P[O+1],c[b+2]=P[O+2]):(c[b]=0,c[b+1]=0,c[b+2]=0),b+=p}this.reprojData_=u,this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(s*this.pixelRatio_)],this.state=Z.LOADED}this.changed()}load(){if(this.state!==Z.IDLE&&this.state!==Z.ERROR)return;this.state=Z.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(t=>{const i=t.getState();if(i!==Z.IDLE&&i!==Z.LOADING)return;e++;const r=Wt(t,Ke.CHANGE,function(){const s=t.getState();(s==Z.LOADED||s==Z.ERROR||s==Z.EMPTY)&&($i(r),e--,e===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(r)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(t){t.getState()==Z.IDLE&&t.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach($i),this.sourcesListenerKeys_=null}}const vu=wu;class Su extends lr{constructor(e){const t=e.projection===void 0?"EPSG:3857":e.projection;let i=e.tileGrid;i===void 0&&t&&(i=Ti({extent:Ei(t),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:t,tileGrid:i,opaque:e.opaque,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?Qe(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.tileCacheForProjection_={}}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;const t=this.getTileGrid();return t?Qe(t.getTileSize(e)):[256,256]}getGutterForProjection(e){const t=this.getProjection();return!t||Ut(t,e)?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,t,i,r,s){const o=this.getTileCacheForProjection(r),a=wi(e,t,i);if(o.containsKey(a)){const x=o.get(a);if(x&&x.key==this.getKey())return x}const l=this.getTileGrid(),u=Math.max.apply(null,l.getResolutions().map((x,L)=>{const P=Qe(l.getTileSize(L)),b=this.getTileSize(L);return Math.max(b[0]/P[0],b[1]/P[1])})),c=this.getTileGridForProjection(s),p=this.getTileGridForProjection(r),_=[e,t,i],w=this.getTileCoordForTileUrlFunction(_,r),v=Object.assign({sourceProj:s,sourceTileGrid:c,targetProj:r,targetTileGrid:p,tileCoord:_,wrappedTileCoord:w,pixelRatio:u,gutter:this.getGutterForProjection(s),getTileFunction:(x,L,P,b)=>this.getTile(x,L,P,b,s)},this.tileOptions),E=new vu(v);return E.key=this.getKey(),E}getTile(e,t,i,r,s){const o=this.getProjection();if(o&&s&&!Ut(o,s))return this.getReprojTile_(e,t,i,s,o);const a=this.getTileSize(e),l=wi(e,t,i);if(this.tileCache.containsKey(l))return this.tileCache.get(l);const u=this.loader_;function c(){return bl(function(){return u(e,t,i)})}const p=Object.assign({tileCoord:[e,t,i],loader:c,size:a},this.tileOptions),_=new Ao(p);return _.key=this.getKey(),_.addEventListener(Ke.CHANGE,this.handleTileChange_),this.tileCache.set(l,_),_}handleTileChange_(e){const t=e.target,i=Oe(t),r=t.getState();let s;r==Z.LOADING?(this.tileLoadingKeys_[i]=!0,s=Ir.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],s=r==Z.ERROR?Ir.TILELOADERROR:r==Z.LOADED?Ir.TILELOADEND:void 0),s&&this.dispatchEvent(new Dc(s,t))}getTileGridForProjection(e){const t=this.getProjection();if(this.tileGrid&&(!t||Ut(t,e)))return this.tileGrid;const i=Oe(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=zc(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,t){const i=Se(e);if(i){const r=Oe(i);r in this.tileGridForProjection_||(this.tileGridForProjection_[r]=t)}}getTileCacheForProjection(e){const t=this.getProjection();if(!t||Ut(t,e))return this.tileCache;const i=Oe(e);return i in this.tileCacheForProjection_||(this.tileCacheForProjection_[i]=new xo(.1)),this.tileCacheForProjection_[i]}expireCache(e,t){const i=this.getTileCacheForProjection(e);this.tileCache.expireCache(this.tileCache==i?t:{});for(const r in this.tileCacheForProjection_){const s=this.tileCacheForProjection_[r];s.expireCache(s==i?t:{})}}clear(){super.clear();for(const e in this.tileCacheForProjection_)this.tileCacheForProjection_[e].clear()}}const Oo=Su;function Fe(n){return(e,...t)=>Cu(n,e,t)}function ei(n,e){return Fe(Fo(n,e).get)}const{apply:Cu,construct:Am,defineProperty:Om,get:Fm,getOwnPropertyDescriptor:Fo,getPrototypeOf:mn,has:Mm,ownKeys:Eu,set:Nm,setPrototypeOf:Gm}=Reflect,{iterator:Pi,species:Dm,toStringTag:Tu,for:zm}=Symbol,xu=Object,{create:pn,defineProperty:Ru,freeze:Vm,is:jm}=xu,Pu=Array,Iu=Pu.prototype,Mo=Iu[Pi],bu=Fe(Mo),No=ArrayBuffer,Lu=No.prototype;ei(Lu,"byteLength");const vs=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:null;vs&&ei(vs.prototype,"byteLength");const Go=mn(Uint8Array);Go.from;const ze=Go.prototype;ze[Pi];Fe(ze.keys);Fe(ze.values);Fe(ze.entries);Fe(ze.set);Fe(ze.reverse);Fe(ze.fill);Fe(ze.copyWithin);Fe(ze.sort);Fe(ze.slice);Fe(ze.subarray);ei(ze,"buffer");ei(ze,"byteOffset");ei(ze,"length");ei(ze,Tu);const ti=Uint32Array,Au=Float32Array,vi=mn([][Pi]()),Do=Fe(vi.next),Ou=Fe(function*(){}().next),Fu=mn(vi),Mu=DataView.prototype,Nu=Fe(Mu.getUint16),yn=WeakMap,zo=yn.prototype,Vo=Fe(zo.get),Gu=Fe(zo.set),jo=new yn,Du=pn(null,{next:{value:function(){const e=Vo(jo,this);return Do(e)}},[Pi]:{value:function(){return this}}});function zu(n){if(n[Pi]===Mo&&vi.next===Do)return n;const e=pn(Du);return Gu(jo,e,bu(n)),e}const Vu=new yn,ju=pn(Fu,{next:{value:function(){const e=Vo(Vu,this);return Ou(e)},writable:!0,configurable:!0}});for(const n of Eu(vi))n!=="next"&&Ru(ju,n,Fo(vi,n));const ko=new No(4),ku=new Au(ko),Bu=new ti(ko),it=new ti(512),rt=new ti(512);for(let n=0;n<256;++n){const e=n-127;e<-27?(it[n]=0,it[n|256]=32768,rt[n]=24,rt[n|256]=24):e<-14?(it[n]=1024>>-e-14,it[n|256]=1024>>-e-14|32768,rt[n]=-e-1,rt[n|256]=-e-1):e<=15?(it[n]=e+15<<10,it[n|256]=e+15<<10|32768,rt[n]=13,rt[n|256]=13):e<128?(it[n]=31744,it[n|256]=64512,rt[n]=24,rt[n|256]=24):(it[n]=31744,it[n|256]=64512,rt[n]=13,rt[n|256]=13)}const _n=new ti(2048),ii=new ti(64),Bo=new ti(64);for(let n=1;n<1024;++n){let e=n<<13,t=0;for(;!(e&8388608);)e<<=1,t-=8388608;e&=-8388609,t+=947912704,_n[n]=e|t}for(let n=1024;n<2048;++n)_n[n]=939524096+(n-1024<<13);for(let n=1;n<31;++n)ii[n]=n<<23;ii[31]=1199570944;ii[32]=2147483648;for(let n=33;n<63;++n)ii[n]=2147483648+(n-32<<23);ii[63]=3347054592;for(let n=1;n<64;++n)n!==32&&(Bo[n]=1024);function Uu(n){const e=n>>10;return Bu[0]=_n[Bo[e]+(n&1023)]+ii[e],ku[0]}function Uo(n,e,...t){return Uu(Nu(n,e,...zu(t)))}var qt={},$u={get exports(){return qt},set exports(n){qt=n}};function $o(n,e,t){const i=t&&t.debug||!1;i&&console.log("getting "+e+" in "+n);const r=typeof n=="object"?n.outer:n,s=`${e}\\="([^"]*)"`;i&&console.log("pattern:",s);const a=new RegExp(s).exec(r);if(i&&console.log("match:",a),a)return a[1]}$u.exports=$o;qt.default=$o;var Hi={},Ku={get exports(){return Hi},set exports(n){Hi=n}},Yi={},Zu={get exports(){return Yi},set exports(n){Yi=n}},Wi={},qu={get exports(){return Wi},set exports(n){Wi=n}};function Ko(n,e,t){const r=new RegExp(e).exec(n.slice(t));return r?t+r.index:-1}qu.exports=Ko;Wi.default=Ko;var Xi={},Hu={get exports(){return Xi},set exports(n){Xi=n}};function Zo(n,e,t){const r=new RegExp(e).exec(n.slice(t));return r?t+r.index+r[0].length-1:-1}Hu.exports=Zo;Xi.default=Zo;var Qi={},Yu={get exports(){return Qi},set exports(n){Qi=n}};function qo(n,e){const t=new RegExp(e,"g"),i=n.match(t);return i?i.length:0}Yu.exports=qo;Qi.default=qo;const Wu=Wi,Lr=Xi,Ss=Qi;function Ho(n,e,t){const i=t&&t.debug||!1,r=!(t&&typeof t.nested===!1),s=t&&t.startIndex||0;i&&console.log("[xml-utils] starting findTagByName with",e," and ",t);const o=Wu(n,`<${e}[ >/]`,s);if(i&&console.log("[xml-utils] start:",o),o===-1)return;const a=n.slice(o+e.length);let l=Lr(a,"^[^<]*[ /]>",0);const u=l!==-1&&a[l-1]==="/";if(i&&console.log("[xml-utils] selfClosing:",u),u===!1)if(r){let w=0,v=1,E=0;for(;(l=Lr(a,"[ /]"+e+">",w))!==-1;){const x=a.substring(w,l+1);if(v+=Ss(x,"<"+e),E+=Ss(x,"/"+e+">"),E>=v)break;w=l}}else l=Lr(a,"[ /]"+e+">",0);const c=o+e.length+l+1;if(i&&console.log("[xml-utils] end:",c),c===-1)return;const p=n.slice(o,c);let _;return u?_=null:_=p.slice(p.indexOf(">")+1,p.lastIndexOf("<")),{inner:_,outer:p,start:o,end:c}}Zu.exports=Ho;Yi.default=Ho;const Xu=Yi;function Yo(n,e,t){const i=[],r=t&&t.debug||!1,s=t&&typeof t.nested=="boolean"?t.nested:!0;let o=t&&t.startIndex||0,a;for(;a=Xu(n,e,{debug:r,startIndex:o});)s?o=a.start+1+e.length:o=a.end,i.push(a);return r&&console.log("findTagsByName found",i.length,"tags"),i}Ku.exports=Yo;Hi.default=Yo;const mi={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},st={};for(const n in mi)mi.hasOwnProperty(n)&&(st[mi[n]]=parseInt(n,10));const Qu=[st.BitsPerSample,st.ExtraSamples,st.SampleFormat,st.StripByteCounts,st.StripOffsets,st.StripRowCounts,st.TileByteCounts,st.TileOffsets,st.SubIFDs],Ar={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},ne={};for(const n in Ar)Ar.hasOwnProperty(n)&&(ne[Ar[n]]=parseInt(n,10));const Ve={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},Ju={Unspecified:0,Assocalpha:1,Unassalpha:2},km={Version:0,AddCompression:1},Bm={None:0,Deflate:1},eh={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"};function th(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<n.length;++o,a+=3)s=256-n[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function ih(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3);let s;for(let o=0,a=0;o<n.length;++o,a+=3)s=n[o]/e*256,r[a]=s,r[a+1]=s,r[a+2]=s;return r}function rh(n,e){const{width:t,height:i}=n,r=new Uint8Array(t*i*3),s=e.length/3,o=e.length/3*2;for(let a=0,l=0;a<n.length;++a,l+=3){const u=n[a];r[l]=e[u]/65536*256,r[l+1]=e[u+s]/65536*256,r[l+2]=e[u+o]/65536*256}return r}function nh(n){const{width:e,height:t}=n,i=new Uint8Array(e*t*3);for(let r=0,s=0;r<n.length;r+=4,s+=3){const o=n[r],a=n[r+1],l=n[r+2],u=n[r+3];i[s]=255*((255-o)/256)*((255-u)/256),i[s+1]=255*((255-a)/256)*((255-u)/256),i[s+2]=255*((255-l)/256)*((255-u)/256)}return i}function sh(n){const{width:e,height:t}=n,i=new Uint8ClampedArray(e*t*3);for(let r=0,s=0;r<n.length;r+=3,s+=3){const o=n[r],a=n[r+1],l=n[r+2];i[s]=o+1.402*(l-128),i[s+1]=o-.34414*(a-128)-.71414*(l-128),i[s+2]=o+1.772*(a-128)}return i}const oh=.95047,ah=1,lh=1.08883;function ch(n){const{width:e,height:t}=n,i=new Uint8Array(e*t*3);for(let r=0,s=0;r<n.length;r+=3,s+=3){const o=n[r+0],a=n[r+1]<<24>>24,l=n[r+2]<<24>>24;let u=(o+16)/116,c=a/500+u,p=u-l/200,_,w,v;c=oh*(c*c*c>.008856?c*c*c:(c-16/116)/7.787),u=ah*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),p=lh*(p*p*p>.008856?p*p*p:(p-16/116)/7.787),_=c*3.2406+u*-1.5372+p*-.4986,w=c*-.9689+u*1.8758+p*.0415,v=c*.0557+u*-.204+p*1.057,_=_>.0031308?1.055*_**(1/2.4)-.055:12.92*_,w=w>.0031308?1.055*w**(1/2.4)-.055:12.92*w,v=v>.0031308?1.055*v**(1/2.4)-.055:12.92*v,i[s]=Math.max(0,Math.min(1,_))*255,i[s+1]=Math.max(0,Math.min(1,w))*255,i[s+2]=Math.max(0,Math.min(1,v))*255}return i}const Wo=new Map;function xt(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>Wo.set(t,e))}async function Xo(n){const e=Wo.get(n.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${n.Compression}`);const t=await e();return new t(n)}xt([void 0,1],()=>Tt(()=>import("./raw-7a0fe838.js"),["assets/raw-7a0fe838.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));xt(5,()=>Tt(()=>import("./lzw-901d9363.js"),["assets/lzw-901d9363.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));xt(6,()=>{throw new Error("old style JPEG compression is not supported.")});xt(7,()=>Tt(()=>import("./jpeg-2f15dd85.js"),["assets/jpeg-2f15dd85.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));xt([8,32946],()=>Tt(()=>import("./deflate-29fb883b.js"),["assets/deflate-29fb883b.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));xt(32773,()=>Tt(()=>import("./packbits-90020365.js"),["assets/packbits-90020365.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));xt(34887,()=>Tt(()=>import("./lerc-cbcb5697.js"),["assets/lerc-cbcb5697.js","assets/pako.esm-bae9e474.js","assets/basedecoder-3573ccae.js","assets/Select-73cfa6a9.js","assets/index-820b305b.js","assets/ZoomToExtent-75a5a125.js","assets/index-13ed24c7.js","assets/index-688c06c1.css","assets/Cluster-5304c38e.js","assets/__vite-browser-external-024afdea.js","assets/Viewer-0cc3e44d.js"]).then(n=>n.default));xt(50001,()=>Tt(()=>import("./webimage-aa764004.js"),["assets/webimage-aa764004.js","assets/basedecoder-3573ccae.js"]).then(n=>n.default));function hr(n,e,t,i=1){return new(Object.getPrototypeOf(n)).constructor(e*t*i)}function uh(n,e,t,i,r){const s=e/i,o=t/r;return n.map(a=>{const l=hr(a,i,r);for(let u=0;u<r;++u){const c=Math.min(Math.round(o*u),t-1);for(let p=0;p<i;++p){const _=Math.min(Math.round(s*p),e-1),w=a[c*e+_];l[u*i+p]=w}}return l})}function Ht(n,e,t){return(1-t)*n+t*e}function hh(n,e,t,i,r){const s=e/i,o=t/r;return n.map(a=>{const l=hr(a,i,r);for(let u=0;u<r;++u){const c=o*u,p=Math.floor(c),_=Math.min(Math.ceil(c),t-1);for(let w=0;w<i;++w){const v=s*w,E=v%1,x=Math.floor(v),L=Math.min(Math.ceil(v),e-1),P=a[p*e+x],b=a[p*e+L],O=a[_*e+x],k=a[_*e+L],K=Ht(Ht(P,b,E),Ht(O,k,E),c%1);l[u*i+w]=K}}return l})}function dh(n,e,t,i,r,s="nearest"){switch(s.toLowerCase()){case"nearest":return uh(n,e,t,i,r);case"bilinear":case"linear":return hh(n,e,t,i,r);default:throw new Error(`Unsupported resampling method: '${s}'`)}}function fh(n,e,t,i,r,s){const o=e/i,a=t/r,l=hr(n,i,r,s);for(let u=0;u<r;++u){const c=Math.min(Math.round(a*u),t-1);for(let p=0;p<i;++p){const _=Math.min(Math.round(o*p),e-1);for(let w=0;w<s;++w){const v=n[c*e*s+_*s+w];l[u*i*s+p*s+w]=v}}}return l}function gh(n,e,t,i,r,s){const o=e/i,a=t/r,l=hr(n,i,r,s);for(let u=0;u<r;++u){const c=a*u,p=Math.floor(c),_=Math.min(Math.ceil(c),t-1);for(let w=0;w<i;++w){const v=o*w,E=v%1,x=Math.floor(v),L=Math.min(Math.ceil(v),e-1);for(let P=0;P<s;++P){const b=n[p*e*s+x*s+P],O=n[p*e*s+L*s+P],k=n[_*e*s+x*s+P],K=n[_*e*s+L*s+P],z=Ht(Ht(b,O,E),Ht(k,K,E),c%1);l[u*i*s+w*s+P]=z}}}return l}function mh(n,e,t,i,r,s,o="nearest"){switch(o.toLowerCase()){case"nearest":return fh(n,e,t,i,r,s);case"bilinear":case"linear":return gh(n,e,t,i,r,s);default:throw new Error(`Unsupported resampling method: '${o}'`)}}function ph(n,e,t){let i=0;for(let r=e;r<t;++r)i+=n[r];return i}function Xr(n,e,t){switch(n){case 1:if(e<=8)return new Uint8Array(t);if(e<=16)return new Uint16Array(t);if(e<=32)return new Uint32Array(t);break;case 2:if(e===8)return new Int8Array(t);if(e===16)return new Int16Array(t);if(e===32)return new Int32Array(t);break;case 3:switch(e){case 16:case 32:return new Float32Array(t);case 64:return new Float64Array(t)}break}throw Error("Unsupported data format/bitsPerSample")}function yh(n,e){return(n===1||n===2)&&e<=32&&e%8===0?!1:!(n===3&&(e===16||e===32||e===64))}function _h(n,e,t,i,r,s,o){const a=new DataView(n),l=t===2?o*s:o*s*i,u=t===2?1:i,c=Xr(e,r,l),p=parseInt("1".repeat(r),2);if(e===1){let _;t===1?_=i*r:_=r;let w=s*_;w&7&&(w=w+7&-8);for(let v=0;v<o;++v){const E=v*w;for(let x=0;x<s;++x){const L=E+x*u*r;for(let P=0;P<u;++P){const b=L+P*r,O=(v*s+x)*u+P,k=Math.floor(b/8),K=b%8;if(K+r<=8)c[O]=a.getUint8(k)>>8-r-K&p;else if(K+r<=16)c[O]=a.getUint16(k)>>16-r-K&p;else if(K+r<=24){const z=a.getUint16(k)<<8|a.getUint8(k+2);c[O]=z>>24-r-K&p}else c[O]=a.getUint32(k)>>32-r-K&p}}}}return c.buffer}class wh{constructor(e,t,i,r,s,o){this.fileDirectory=e,this.geoKeys=t,this.dataView=i,this.littleEndian=r,this.tiles=s?{}:null,this.isTiled=!e.StripOffsets;const a=e.PlanarConfiguration;if(this.planarConfiguration=typeof a>"u"?1:a,this.planarConfiguration!==1&&this.planarConfiguration!==2)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return typeof this.fileDirectory.SamplesPerPixel<"u"?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:typeof this.fileDirectory.RowsPerStrip<"u"?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(e){return this.isTiled||(e+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-e*this.getTileHeight()}getBytesPerPixel(){let e=0;for(let t=0;t<this.fileDirectory.BitsPerSample.length;++t)e+=this.getSampleByteSize(t);return e}getSampleByteSize(e){if(e>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${e} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[e]/8)}getReaderForSample(e){const t=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1,i=this.fileDirectory.BitsPerSample[e];switch(t){case 1:if(i<=8)return DataView.prototype.getUint8;if(i<=16)return DataView.prototype.getUint16;if(i<=32)return DataView.prototype.getUint32;break;case 2:if(i<=8)return DataView.prototype.getInt8;if(i<=16)return DataView.prototype.getInt16;if(i<=32)return DataView.prototype.getInt32;break;case 3:switch(i){case 16:return function(r,s){return Uo(this,r,s)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}break}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(e=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[e]:1}getBitsPerSample(e=0){return this.fileDirectory.BitsPerSample[e]}getArrayForSample(e,t){const i=this.getSampleFormat(e),r=this.getBitsPerSample(e);return Xr(i,r,t)}async getTileOrStrip(e,t,i,r,s){const o=Math.ceil(this.getWidth()/this.getTileWidth()),a=Math.ceil(this.getHeight()/this.getTileHeight());let l;const{tiles:u}=this;this.planarConfiguration===1?l=t*o+e:this.planarConfiguration===2&&(l=i*o*a+t*o+e);let c,p;this.isTiled?(c=this.fileDirectory.TileOffsets[l],p=this.fileDirectory.TileByteCounts[l]):(c=this.fileDirectory.StripOffsets[l],p=this.fileDirectory.StripByteCounts[l]);const _=(await this.source.fetch([{offset:c,length:p}],s))[0];let w;return u===null||!u[l]?(w=(async()=>{let v=await r.decode(this.fileDirectory,_);const E=this.getSampleFormat(),x=this.getBitsPerSample();return yh(E,x)&&(v=_h(v,E,this.planarConfiguration,this.getSamplesPerPixel(),x,this.getTileWidth(),this.getBlockHeight(t))),v})(),u!==null&&(u[l]=w)):w=u[l],{x:e,y:t,sample:i,data:await w}}async _readRaster(e,t,i,r,s,o,a,l,u){const c=this.getTileWidth(),p=this.getTileHeight(),_=this.getWidth(),w=this.getHeight(),v=Math.max(Math.floor(e[0]/c),0),E=Math.min(Math.ceil(e[2]/c),Math.ceil(_/c)),x=Math.max(Math.floor(e[1]/p),0),L=Math.min(Math.ceil(e[3]/p),Math.ceil(w/p)),P=e[2]-e[0];let b=this.getBytesPerPixel();const O=[],k=[];for(let D=0;D<t.length;++D)this.planarConfiguration===1?O.push(ph(this.fileDirectory.BitsPerSample,0,t[D])/8):O.push(0),k.push(this.getReaderForSample(t[D]));const K=[],{littleEndian:z}=this;for(let D=x;D<L;++D)for(let V=v;V<E;++V)for(let Q=0;Q<t.length;++Q){const W=Q,pe=t[Q];this.planarConfiguration===2&&(b=this.getSampleByteSize(Q));const ce=this.getTileOrStrip(V,D,pe,s,u).then(ue=>{const Re=ue.data,Pe=new DataView(Re),ye=this.getBlockHeight(ue.y),_e=ue.y*p,Le=ue.x*c,at=_e+ye,Je=(ue.x+1)*c,$=k[W],et=Math.min(ye,ye-(at-e[3]),w-_e),M=Math.min(c,c-(Je-e[2]),_-Le);for(let ae=Math.max(0,e[1]-_e);ae<et;++ae)for(let ve=Math.max(0,e[0]-Le);ve<M;++ve){const ni=(ae*c+ve)*b,Ce=$.call(Pe,ni+O[W],z);let pt;r?(pt=(ae+_e-e[1])*P*t.length+(ve+Le-e[0])*t.length+W,i[pt]=Ce):(pt=(ae+_e-e[1])*P+ve+Le-e[0],i[W][pt]=Ce)}});K.push(ce)}if(await Promise.all(K),o&&e[2]-e[0]!==o||a&&e[3]-e[1]!==a){let D;return r?D=mh(i,e[2]-e[0],e[3]-e[1],o,a,t.length,l):D=dh(i,e[2]-e[0],e[3]-e[1],o,a,l),D.width=o,D.height=a,D}return i.width=o||e[2]-e[0],i.height=a||e[3]-e[1],i}async readRasters({window:e,samples:t=[],interleave:i,pool:r=null,width:s,height:o,resampleMethod:a,fillValue:l,signal:u}={}){const c=e||[0,0,this.getWidth(),this.getHeight()];if(c[0]>c[2]||c[1]>c[3])throw new Error("Invalid subsets");const p=c[2]-c[0],_=c[3]-c[1],w=p*_,v=this.getSamplesPerPixel();if(!t||!t.length)for(let P=0;P<v;++P)t.push(P);else for(let P=0;P<t.length;++P)if(t[P]>=v)return Promise.reject(new RangeError(`Invalid sample index '${t[P]}'.`));let E;if(i){const P=this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,b=Math.max.apply(null,this.fileDirectory.BitsPerSample);E=Xr(P,b,w*t.length),l&&E.fill(l)}else{E=[];for(let P=0;P<t.length;++P){const b=this.getArrayForSample(t[P],w);Array.isArray(l)&&P<l.length?b.fill(l[P]):l&&!Array.isArray(l)&&b.fill(l),E.push(b)}}const x=r||await Xo(this.fileDirectory);return await this._readRaster(c,t,E,i,x,s,o,a,u)}async readRGB({window:e,interleave:t=!0,pool:i=null,width:r,height:s,resampleMethod:o,enableAlpha:a=!1,signal:l}={}){const u=e||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=this.fileDirectory.PhotometricInterpretation;if(c===Ve.RGB){let L=[0,1,2];if(this.fileDirectory.ExtraSamples!==Ju.Unspecified&&a){L=[];for(let P=0;P<this.fileDirectory.BitsPerSample.length;P+=1)L.push(P)}return this.readRasters({window:e,interleave:t,samples:L,pool:i,width:r,height:s,resampleMethod:o,signal:l})}let p;switch(c){case Ve.WhiteIsZero:case Ve.BlackIsZero:case Ve.Palette:p=[0];break;case Ve.CMYK:p=[0,1,2,3];break;case Ve.YCbCr:case Ve.CIELab:p=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const _={window:u,interleave:!0,samples:p,pool:i,width:r,height:s,resampleMethod:o,signal:l},{fileDirectory:w}=this,v=await this.readRasters(_),E=2**this.fileDirectory.BitsPerSample[0];let x;switch(c){case Ve.WhiteIsZero:x=th(v,E);break;case Ve.BlackIsZero:x=ih(v,E);break;case Ve.Palette:x=rh(v,w.ColorMap);break;case Ve.CMYK:x=nh(v);break;case Ve.YCbCr:x=sh(v);break;case Ve.CIELab:x=ch(v);break;default:throw new Error("Unsupported photometric interpretation.")}if(!t){const L=new Uint8Array(x.length/3),P=new Uint8Array(x.length/3),b=new Uint8Array(x.length/3);for(let O=0,k=0;O<x.length;O+=3,++k)L[k]=x[O],P[k]=x[O+1],b[k]=x[O+2];x=[L,P,b]}return x.width=v.width,x.height=v.height,x}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const e=[];for(let t=0;t<this.fileDirectory.ModelTiepoint.length;t+=6)e.push({i:this.fileDirectory.ModelTiepoint[t],j:this.fileDirectory.ModelTiepoint[t+1],k:this.fileDirectory.ModelTiepoint[t+2],x:this.fileDirectory.ModelTiepoint[t+3],y:this.fileDirectory.ModelTiepoint[t+4],z:this.fileDirectory.ModelTiepoint[t+5]});return e}getGDALMetadata(e=null){const t={};if(!this.fileDirectory.GDAL_METADATA)return null;const i=this.fileDirectory.GDAL_METADATA;let r=Hi(i,"Item");e===null?r=r.filter(s=>qt(s,"sample")===void 0):r=r.filter(s=>Number(qt(s,"sample"))===e);for(let s=0;s<r.length;++s){const o=r[s];t[qt(o,"name")]=o.inner}return t}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const e=this.fileDirectory.GDAL_NODATA;return Number(e.substring(0,e.length-1))}getOrigin(){const e=this.fileDirectory.ModelTiepoint,t=this.fileDirectory.ModelTransformation;if(e&&e.length===6)return[e[3],e[4],e[5]];if(t)return[t[3],t[7],t[11]];throw new Error("The image does not have an affine transformation.")}getResolution(e=null){const t=this.fileDirectory.ModelPixelScale,i=this.fileDirectory.ModelTransformation;if(t)return[t[0],-t[1],t[2]];if(i)return[i[0],i[5],i[10]];if(e){const[r,s,o]=e.getResolution();return[r*e.getWidth()/this.getWidth(),s*e.getHeight()/this.getHeight(),o*e.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return this.geoKeys.GTRasterTypeGeoKey===1}getBoundingBox(){const e=this.getOrigin(),t=this.getResolution(),i=e[0],r=e[1],s=i+t[0]*this.getWidth(),o=r+t[1]*this.getHeight();return[Math.min(i,s),Math.min(r,o),Math.max(i,s),Math.max(r,o)]}}const Qo=wh;class vh{constructor(e){this._dataView=new DataView(e)}get buffer(){return this._dataView.buffer}getUint64(e,t){const i=this.getUint32(e,t),r=this.getUint32(e+4,t);let s;if(t){if(s=i+2**32*r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}if(s=2**32*i+r,!Number.isSafeInteger(s))throw new Error(`${s} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return s}getInt64(e,t){let i=0;const r=(this._dataView.getUint8(e+(t?7:0))&128)>0;let s=!0;for(let o=0;o<8;o++){let a=this._dataView.getUint8(e+(t?o:7-o));r&&(s?a!==0&&(a=~(a-1)&255,s=!1):a=~a&255),i+=a*256**o}return r&&(i=-i),i}getUint8(e,t){return this._dataView.getUint8(e,t)}getInt8(e,t){return this._dataView.getInt8(e,t)}getUint16(e,t){return this._dataView.getUint16(e,t)}getInt16(e,t){return this._dataView.getInt16(e,t)}getUint32(e,t){return this._dataView.getUint32(e,t)}getInt32(e,t){return this._dataView.getInt32(e,t)}getFloat16(e,t){return Uo(this._dataView,e,t)}getFloat32(e,t){return this._dataView.getFloat32(e,t)}getFloat64(e,t){return this._dataView.getFloat64(e,t)}}class Sh{constructor(e,t,i,r){this._dataView=new DataView(e),this._sliceOffset=t,this._littleEndian=i,this._bigTiff=r}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(e,t){return this.sliceOffset<=e&&this.sliceTop>=e+t}readUint8(e){return this._dataView.getUint8(e-this._sliceOffset,this._littleEndian)}readInt8(e){return this._dataView.getInt8(e-this._sliceOffset,this._littleEndian)}readUint16(e){return this._dataView.getUint16(e-this._sliceOffset,this._littleEndian)}readInt16(e){return this._dataView.getInt16(e-this._sliceOffset,this._littleEndian)}readUint32(e){return this._dataView.getUint32(e-this._sliceOffset,this._littleEndian)}readInt32(e){return this._dataView.getInt32(e-this._sliceOffset,this._littleEndian)}readFloat32(e){return this._dataView.getFloat32(e-this._sliceOffset,this._littleEndian)}readFloat64(e){return this._dataView.getFloat64(e-this._sliceOffset,this._littleEndian)}readUint64(e){const t=this.readUint32(e),i=this.readUint32(e+4);let r;if(this._littleEndian){if(r=t+2**32*i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*t+i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}readInt64(e){let t=0;const i=(this._dataView.getUint8(e+(this._littleEndian?7:0))&128)>0;let r=!0;for(let s=0;s<8;s++){let o=this._dataView.getUint8(e+(this._littleEndian?s:7-s));i&&(r?o!==0&&(o=~(o-1)&255,r=!1):o=~o&255),t+=o*256**s}return i&&(t=-t),t}readOffset(e){return this._bigTiff?this.readUint64(e):this.readUint32(e)}}const Ch=typeof navigator<"u"&&navigator.hardwareConcurrency||2;class Eh{constructor(e=Ch,t){this.workers=null,this._awaitingDecoder=null,this.size=e,this.messageId=0,e&&(this._awaitingDecoder=t?Promise.resolve(t):new Promise(i=>{Tt(()=>import("./decoder-bb67c6bf.js"),[]).then(r=>{i(r.create)})}),this._awaitingDecoder.then(i=>{this._awaitingDecoder=null,this.workers=[];for(let r=0;r<e;r++)this.workers.push({worker:i(),idle:!0})}))}async decode(e,t){return this._awaitingDecoder&&await this._awaitingDecoder,this.size===0?Xo(e).then(i=>i.decode(e,t)):new Promise(i=>{const r=this.workers.find(a=>a.idle)||this.workers[Math.floor(Math.random()*this.size)];r.idle=!1;const s=this.messageId++,o=a=>{a.data.id===s&&(r.idle=!0,i(a.data.decoded),r.worker.removeEventListener("message",o))};r.worker.addEventListener("message",o),r.worker.postMessage({fileDirectory:e,buffer:t,id:s},[t])})}destroy(){this.workers&&(this.workers.forEach(e=>{e.worker.terminate()}),this.workers=null)}}const Th=Eh,Cs=`\r
\r
`;function Jo(n){if(typeof Object.fromEntries<"u")return Object.fromEntries(n);const e={};for(const[t,i]of n)e[t.toLowerCase()]=i;return e}function xh(n){const e=n.split(`\r
`).map(t=>{const i=t.split(":").map(r=>r.trim());return i[0]=i[0].toLowerCase(),i});return Jo(e)}function Rh(n){const[e,...t]=n.split(";").map(r=>r.trim()),i=t.map(r=>r.split("="));return{type:e,params:Jo(i)}}function Qr(n){let e,t,i;return n&&([,e,t,i]=n.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),t=parseInt(t,10),i=parseInt(i,10)),{start:e,end:t,total:i}}function Ph(n,e){let t=null;const i=new TextDecoder("ascii"),r=[],s=`--${e}`,o=`${s}--`;for(let a=0;a<10;++a)i.decode(new Uint8Array(n,a,s.length))===s&&(t=a);if(t===null)throw new Error("Could not find initial boundary");for(;t<n.byteLength;){const a=i.decode(new Uint8Array(n,t,Math.min(s.length+1024,n.byteLength-t)));if(a.length===0||a.startsWith(o))break;if(!a.startsWith(s))throw new Error("Part does not start with boundary");const l=a.substr(s.length+2);if(l.length===0)break;const u=l.indexOf(Cs),c=xh(l.substr(0,u)),{start:p,end:_,total:w}=Qr(c["content-range"]),v=t+s.length+u+Cs.length,E=parseInt(_,10)+1-parseInt(p,10);r.push({headers:c,data:n.slice(v,v+E),offset:p,length:E,fileSize:w}),t=v+E+4}return r}class wn{async fetch(e,t=void 0){return Promise.all(e.map(i=>this.fetchSlice(i,t)))}async fetchSlice(e){throw new Error(`fetching of slice ${e} not possible, not implemented`)}get fileSize(){return null}async close(){}}class Ih extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if(typeof e.maxAge=="number"&&e.maxAge===0)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if(typeof this.onEviction=="function")for(const[t,i]of e)this.onEviction(t,i.value)}_deleteIfExpired(e,t){return typeof t.expiry=="number"&&t.expiry<=Date.now()?(typeof this.onEviction=="function"&&this.onEviction(e,t.value),this.delete(e)):!1}_getOrDeleteIfExpired(e,t){if(this._deleteIfExpired(e,t)===!1)return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const i=t.get(e);return this._getItemValue(e,i)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield e)}for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(this._deleteIfExpired(e,t)===!1)return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:i=this.maxAge}={}){const r=typeof i=="number"&&i!==Number.POSITIVE_INFINITY?Date.now()+i:void 0;this.cache.has(e)?this.cache.set(e,{value:t,expiry:r}):this._set(e,{value:t,expiry:r})}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):this.oldCache.has(e)?!this._deleteIfExpired(e,this.oldCache.get(e)):!1}peek(e){if(this.cache.has(e))return this._peek(e,this.cache);if(this.oldCache.has(e))return this._peek(e,this.oldCache)}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],i=t.length-e;i<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(i>0&&this._emitEvictions(t.slice(0,i)),this.oldCache=new Map(t.slice(i)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,i]=e;this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}for(const e of this.oldCache){const[t,i]=e;this.cache.has(t)||this._deleteIfExpired(t,i)===!1&&(yield[t,i.value])}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const i=e[t],[r,s]=i;this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const i=e[t],[r,s]=i;this.cache.has(r)||this._deleteIfExpired(r,s)===!1&&(yield[r,s.value])}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[i,r]of this.entriesAscending())e.call(t,r,i,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}async function bh(n){return new Promise(e=>setTimeout(e,n))}function Lh(n,e){const t=Array.isArray(n)?n:Array.from(n),i=Array.isArray(e)?e:Array.from(e);return t.map((r,s)=>[r,i[s]])}class Qt extends Error{constructor(e){super(e),Error.captureStackTrace&&Error.captureStackTrace(this,Qt),this.name="AbortError"}}class Ah extends Error{constructor(e,t){super(t),this.errors=e,this.message=t,this.name="AggregateError"}}const Oh=Ah;class Fh{constructor(e,t,i=null){this.offset=e,this.length=t,this.data=i}get top(){return this.offset+this.length}}class Es{constructor(e,t,i){this.offset=e,this.length=t,this.blockIds=i}}class Mh extends wn{constructor(e,{blockSize:t=65536,cacheSize:i=100}={}){super(),this.source=e,this.blockSize=t,this.blockCache=new Ih({maxSize:i,onEviction:(r,s)=>{this.evictedBlocks.set(r,s)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(e,t){const i=[],r=[],s=[];this.evictedBlocks.clear();for(const{offset:_,length:w}of e){let v=_+w;const{fileSize:E}=this;E!==null&&(v=Math.min(v,E));const x=Math.floor(_/this.blockSize)*this.blockSize;for(let L=x;L<v;L+=this.blockSize){const P=Math.floor(L/this.blockSize);!this.blockCache.has(P)&&!this.blockRequests.has(P)&&(this.blockIdsToFetch.add(P),r.push(P)),this.blockRequests.has(P)&&i.push(this.blockRequests.get(P)),s.push(P)}}await bh(),this.fetchBlocks(t);const o=[];for(const _ of r)this.blockRequests.has(_)&&o.push(this.blockRequests.get(_));await Promise.allSettled(i),await Promise.allSettled(o);const a=[],l=s.filter(_=>this.abortedBlockIds.has(_)||!this.blockCache.has(_));if(l.forEach(_=>this.blockIdsToFetch.add(_)),l.length>0&&t&&!t.aborted){this.fetchBlocks(null);for(const _ of l){const w=this.blockRequests.get(_);if(!w)throw new Error(`Block ${_} is not in the block requests`);a.push(w)}await Promise.allSettled(a)}if(t&&t.aborted)throw new Qt("Request was aborted");const u=s.map(_=>this.blockCache.get(_)||this.evictedBlocks.get(_)),c=u.filter(_=>!_);if(c.length)throw new Oh(c,"Request failed");const p=new Map(Lh(s,u));return this.readSliceData(e,p)}fetchBlocks(e){if(this.blockIdsToFetch.size>0){const t=this.groupBlocks(this.blockIdsToFetch),i=this.source.fetch(t,e);for(let r=0;r<t.length;++r){const s=t[r];for(const o of s.blockIds)this.blockRequests.set(o,(async()=>{try{const a=(await i)[r],l=o*this.blockSize,u=l-a.offset,c=Math.min(u+this.blockSize,a.data.byteLength),p=a.data.slice(u,c),_=new Fh(l,p.byteLength,p,o);this.blockCache.set(o,_),this.abortedBlockIds.delete(o)}catch(a){if(a.name==="AbortError")a.signal=e,this.blockCache.delete(o),this.abortedBlockIds.add(o);else throw a}finally{this.blockRequests.delete(o)}})())}this.blockIdsToFetch.clear()}}groupBlocks(e){const t=Array.from(e).sort((o,a)=>o-a);if(t.length===0)return[];let i=[],r=null;const s=[];for(const o of t)r===null||r+1===o?(i.push(o),r=o):(s.push(new Es(i[0]*this.blockSize,i.length*this.blockSize,i)),i=[o],r=o);return s.push(new Es(i[0]*this.blockSize,i.length*this.blockSize,i)),s}readSliceData(e,t){return e.map(i=>{let r=i.offset+i.length;this.fileSize!==null&&(r=Math.min(this.fileSize,r));const s=Math.floor(i.offset/this.blockSize),o=Math.floor(r/this.blockSize),a=new ArrayBuffer(i.length),l=new Uint8Array(a);for(let u=s;u<=o;++u){const c=t.get(u),p=c.offset-i.offset,_=c.top-r;let w=0,v=0,E;p<0?w=-p:p>0&&(v=p),_<0?E=c.length-w:E=r-c.offset-w;const x=new Uint8Array(c.data,w,E);l.set(x,v)}return a})}}class vn{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(e){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class Sn{constructor(e){this.url=e}async request({headers:e,credentials:t,signal:i}={}){throw new Error("request is not implemented")}}class Nh extends vn{constructor(e){super(),this.response=e}get status(){return this.response.status}getHeader(e){return this.response.headers.get(e)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class Gh extends Sn{constructor(e,t){super(e),this.credentials=t}async request({headers:e,credentials:t,signal:i}={}){const r=await fetch(this.url,{headers:e,credentials:t,signal:i});return new Nh(r)}}class Dh extends vn{constructor(e,t){super(),this.xhr=e,this.data=t}get status(){return this.xhr.status}getHeader(e){return this.xhr.getResponseHeader(e)}async getData(){return this.data}}class zh extends Sn{constructRequest(e,t){return new Promise((i,r)=>{const s=new XMLHttpRequest;s.open("GET",this.url),s.responseType="arraybuffer";for(const[o,a]of Object.entries(e))s.setRequestHeader(o,a);s.onload=()=>{const o=s.response;i(new Dh(s,o))},s.onerror=r,s.onabort=()=>r(new Qt("Request aborted")),s.send(),t&&(t.aborted&&s.abort(),t.addEventListener("abort",()=>s.abort()))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class Vh extends vn{constructor(e,t){super(),this.response=e,this.dataPromise=t}get status(){return this.response.statusCode}getHeader(e){return this.response.headers[e]}async getData(){return await this.dataPromise}}class jh extends Sn{constructor(e){super(e),this.parsedUrl=br.parse(this.url),this.httpApi=this.parsedUrl.protocol==="http:"?br:br}constructRequest(e,t){return new Promise((i,r)=>{const s=this.httpApi.get({...this.parsedUrl,headers:e},o=>{const a=new Promise(l=>{const u=[];o.on("data",c=>{u.push(c)}),o.on("end",()=>{const c=Buffer.concat(u).buffer;l(c)}),o.on("error",r)});i(new Vh(o,a))});s.on("error",r),t&&(t.aborted&&s.destroy(new Qt("Request aborted")),t.addEventListener("abort",()=>s.destroy(new Qt("Request aborted"))))})}async request({headers:e,signal:t}={}){return await this.constructRequest(e,t)}}class Cn extends wn{constructor(e,t,i,r){super(),this.client=e,this.headers=t,this.maxRanges=i,this.allowFullFile=r,this._fileSize=null}async fetch(e,t){return this.maxRanges>=e.length?this.fetchSlices(e,t):(this.maxRanges>0&&e.length>1,Promise.all(e.map(i=>this.fetchSlice(i,t))))}async fetchSlices(e,t){const i=await this.client.request({headers:{...this.headers,Range:`bytes=${e.map(({offset:r,length:s})=>`${r}-${r+s}`).join(",")}`},signal:t});if(i.ok)if(i.status===206){const{type:r,params:s}=Rh(i.getHeader("content-type"));if(r==="multipart/byteranges"){const p=Ph(await i.getData(),s.boundary);return this._fileSize=p[0].fileSize||null,p}const o=await i.getData(),{start:a,end:l,total:u}=Qr(i.getHeader("content-range"));this._fileSize=u||null;const c=[{data:o,offset:a,length:l-a}];if(e.length>1){const p=await Promise.all(e.slice(1).map(_=>this.fetchSlice(_,t)));return c.concat(p)}return c}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const r=await i.getData();return this._fileSize=r.byteLength,[{data:r,offset:0,length:r.byteLength}]}else throw new Error("Error fetching data.")}async fetchSlice(e,t){const{offset:i,length:r}=e,s=await this.client.request({headers:{...this.headers,Range:`bytes=${i}-${i+r}`},signal:t});if(s.ok)if(s.status===206){const o=await s.getData(),{total:a}=Qr(s.getHeader("content-range"));return this._fileSize=a||null,{data:o,offset:i,length:r}}else{if(!this.allowFullFile)throw new Error("Server responded with full file");const o=await s.getData();return this._fileSize=o.byteLength,{data:o,offset:0,length:o.byteLength}}else throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function En(n,{blockSize:e,cacheSize:t}){return e===null?n:new Mh(n,{blockSize:e,cacheSize:t})}function kh(n,{headers:e={},credentials:t,maxRanges:i=0,allowFullFile:r=!1,...s}={}){const o=new Gh(n,t),a=new Cn(o,e,i,r);return En(a,s)}function Bh(n,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...r}={}){const s=new zh(n),o=new Cn(s,e,t,i);return En(o,r)}function Uh(n,{headers:e={},maxRanges:t=0,allowFullFile:i=!1,...r}={}){const s=new jh(n),o=new Cn(s,e,t,i);return En(o,r)}function Jr(n,{forceXHR:e=!1,...t}={}){return typeof fetch=="function"&&!e?kh(n,t):typeof XMLHttpRequest<"u"?Bh(n,t):Uh(n,t)}class $h extends wn{constructor(e){super(),this.file=e}async fetchSlice(e,t){return new Promise((i,r)=>{const s=this.file.slice(e.offset,e.offset+e.length),o=new FileReader;o.onload=a=>i(a.target.result),o.onerror=r,o.onabort=r,o.readAsArrayBuffer(s),t&&t.addEventListener("abort",()=>o.abort())})}}function Kh(n){return new $h(n)}function en(n){switch(n){case ne.BYTE:case ne.ASCII:case ne.SBYTE:case ne.UNDEFINED:return 1;case ne.SHORT:case ne.SSHORT:return 2;case ne.LONG:case ne.SLONG:case ne.FLOAT:case ne.IFD:return 4;case ne.RATIONAL:case ne.SRATIONAL:case ne.DOUBLE:case ne.LONG8:case ne.SLONG8:case ne.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${n}`)}}function Zh(n){const e=n.GeoKeyDirectory;if(!e)return null;const t={};for(let i=4;i<=e[3]*4;i+=4){const r=eh[e[i]],s=e[i+1]?mi[e[i+1]]:null,o=e[i+2],a=e[i+3];let l=null;if(!s)l=a;else{if(l=n[s],typeof l>"u"||l===null)throw new Error(`Could not get value of geoKey '${r}'.`);typeof l=="string"?l=l.substring(a,a+o-1):l.subarray&&(l=l.subarray(a,a+o),o===1&&(l=l[0]))}t[r]=l}return t}function zt(n,e,t,i){let r=null,s=null;const o=en(e);switch(e){case ne.BYTE:case ne.ASCII:case ne.UNDEFINED:r=new Uint8Array(t),s=n.readUint8;break;case ne.SBYTE:r=new Int8Array(t),s=n.readInt8;break;case ne.SHORT:r=new Uint16Array(t),s=n.readUint16;break;case ne.SSHORT:r=new Int16Array(t),s=n.readInt16;break;case ne.LONG:case ne.IFD:r=new Uint32Array(t),s=n.readUint32;break;case ne.SLONG:r=new Int32Array(t),s=n.readInt32;break;case ne.LONG8:case ne.IFD8:r=new Array(t),s=n.readUint64;break;case ne.SLONG8:r=new Array(t),s=n.readInt64;break;case ne.RATIONAL:r=new Uint32Array(t*2),s=n.readUint32;break;case ne.SRATIONAL:r=new Int32Array(t*2),s=n.readInt32;break;case ne.FLOAT:r=new Float32Array(t),s=n.readFloat32;break;case ne.DOUBLE:r=new Float64Array(t),s=n.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e===ne.RATIONAL||e===ne.SRATIONAL)for(let a=0;a<t;a+=2)r[a]=s.call(n,i+a*o),r[a+1]=s.call(n,i+(a*o+4));else for(let a=0;a<t;++a)r[a]=s.call(n,i+a*o);return e===ne.ASCII?new TextDecoder("utf-8").decode(r):r}class qh{constructor(e,t,i){this.fileDirectory=e,this.geoKeyDirectory=t,this.nextIFDByteOffset=i}}class Ni extends Error{constructor(e){super(`No image at index ${e}`),this.index=e}}class ea{async readRasters(e={}){const{window:t,width:i,height:r}=e;let{resX:s,resY:o,bbox:a}=e;const l=await this.getImage();let u=l;const c=await this.getImageCount(),p=l.getBoundingBox();if(t&&a)throw new Error('Both "bbox" and "window" passed.');if(i||r){if(t){const[v,E]=l.getOrigin(),[x,L]=l.getResolution();a=[v+t[0]*x,E+t[1]*L,v+t[2]*x,E+t[3]*L]}const w=a||p;if(i){if(s)throw new Error("Both width and resX passed");s=(w[2]-w[0])/i}if(r){if(o)throw new Error("Both width and resY passed");o=(w[3]-w[1])/r}}if(s||o){const w=[];for(let v=0;v<c;++v){const E=await this.getImage(v),{SubfileType:x,NewSubfileType:L}=E.fileDirectory;(v===0||x===2||L&1)&&w.push(E)}w.sort((v,E)=>v.getWidth()-E.getWidth());for(let v=0;v<w.length;++v){const E=w[v],x=(p[2]-p[0])/E.getWidth(),L=(p[3]-p[1])/E.getHeight();if(u=E,s&&s>x||o&&o>L)break}}let _=t;if(a){const[w,v]=l.getOrigin(),[E,x]=u.getResolution(l);_=[Math.round((a[0]-w)/E),Math.round((a[1]-v)/x),Math.round((a[2]-w)/E),Math.round((a[3]-v)/x)],_=[Math.min(_[0],_[2]),Math.min(_[1],_[3]),Math.max(_[0],_[2]),Math.max(_[1],_[3])]}return u.readRasters({...e,window:_})}}class Jt extends ea{constructor(e,t,i,r,s={}){super(),this.source=e,this.littleEndian=t,this.bigTiff=i,this.firstIFDOffset=r,this.cache=s.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(e,t){const i=this.bigTiff?4048:1024;return new Sh((await this.source.fetch([{offset:e,length:typeof t<"u"?t:i}]))[0],e,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(e){const t=this.bigTiff?20:12,i=this.bigTiff?8:2;let r=await this.getSlice(e);const s=this.bigTiff?r.readUint64(e):r.readUint16(e),o=s*t+(this.bigTiff?16:6);r.covers(e,o)||(r=await this.getSlice(e,o));const a={};let l=e+(this.bigTiff?8:2);for(let p=0;p<s;l+=t,++p){const _=r.readUint16(l),w=r.readUint16(l+2),v=this.bigTiff?r.readUint64(l+4):r.readUint32(l+4);let E,x;const L=en(w),P=l+(this.bigTiff?12:8);if(L*v<=(this.bigTiff?8:4))E=zt(r,w,v,P);else{const b=r.readOffset(P),O=en(w)*v;if(r.covers(b,O))E=zt(r,w,v,b);else{const k=await this.getSlice(b,O);E=zt(k,w,v,b)}}v===1&&Qu.indexOf(_)===-1&&!(w===ne.RATIONAL||w===ne.SRATIONAL)?x=E[0]:x=E,a[mi[_]]=x}const u=Zh(a),c=r.readOffset(e+i+t*s);return new qh(a,u,c)}async requestIFD(e){if(this.ifdRequests[e])return this.ifdRequests[e];if(e===0)return this.ifdRequests[e]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[e];if(!this.ifdRequests[e-1])try{this.ifdRequests[e-1]=this.requestIFD(e-1)}catch(t){throw t instanceof Ni?new Ni(e):t}return this.ifdRequests[e]=(async()=>{const t=await this.ifdRequests[e-1];if(t.nextIFDByteOffset===0)throw new Ni(e);return this.parseFileDirectoryAt(t.nextIFDByteOffset)})(),this.ifdRequests[e]}async getImage(e=0){const t=await this.requestIFD(e);return new Qo(t.fileDirectory,t.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let e=0,t=!0;for(;t;)try{await this.requestIFD(e),++e}catch(i){if(i instanceof Ni)t=!1;else throw i}return e}async getGhostValues(){const e=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const t="GDAL_STRUCTURAL_METADATA_SIZE=",i=t.length+100;let r=await this.getSlice(e,i);if(t===zt(r,ne.ASCII,t.length,e)){const o=zt(r,ne.ASCII,i,e).split(`
`)[0],a=Number(o.split("=")[1].split(" ")[0])+o.length;a>i&&(r=await this.getSlice(e,a));const l=zt(r,ne.ASCII,a,e);this.ghostValues={},l.split(`
`).filter(u=>u.length>0).map(u=>u.split("=")).forEach(([u,c])=>{this.ghostValues[u]=c})}return this.ghostValues}static async fromSource(e,t,i){const r=(await e.fetch([{offset:0,length:1024}],i))[0],s=new vh(r),o=s.getUint16(0,0);let a;if(o===18761)a=!0;else if(o===19789)a=!1;else throw new TypeError("Invalid byte order value.");const l=s.getUint16(2,a);let u;if(l===42)u=!1;else if(l===43){if(u=!0,s.getUint16(4,a)!==8)throw new Error("Unsupported offset byte-size.")}else throw new TypeError("Invalid magic number.");const c=u?s.getUint64(8,a):s.getUint32(4,a);return new Jt(e,a,u,c,t)}close(){return typeof this.source.close=="function"?this.source.close():!1}}class Hh extends ea{constructor(e,t){super(),this.mainFile=e,this.overviewFiles=t,this.imageFiles=[e].concat(t),this.fileDirectoriesPerFile=null,this.fileDirectoriesPerFileParsing=null,this.imageCount=null}async parseFileDirectoriesPerFile(){const e=[this.mainFile.parseFileDirectoryAt(this.mainFile.firstIFDOffset)].concat(this.overviewFiles.map(t=>t.parseFileDirectoryAt(t.firstIFDOffset)));return this.fileDirectoriesPerFile=await Promise.all(e),this.fileDirectoriesPerFile}async getImage(e=0){await this.getImageCount(),await this.parseFileDirectoriesPerFile();let t=0,i=0;for(let r=0;r<this.imageFiles.length;r++){const s=this.imageFiles[r];for(let o=0;o<this.imageCounts[r];o++){if(e===t){const a=await s.requestIFD(i);return new Qo(a.fileDirectory,a.geoKeyDirectory,s.dataView,s.littleEndian,s.cache,s.source)}t++,i++}i=0}throw new RangeError("Invalid image index")}async getImageCount(){if(this.imageCount!==null)return this.imageCount;const e=[this.mainFile.getImageCount()].concat(this.overviewFiles.map(t=>t.getImageCount()));return this.imageCounts=await Promise.all(e),this.imageCount=this.imageCounts.reduce((t,i)=>t+i,0),this.imageCount}}async function Yh(n,e={},t){return Jt.fromSource(Jr(n,e),t)}async function Wh(n,e){return Jt.fromSource(Kh(n),e)}async function Xh(n,e=[],t={},i){const r=await Jt.fromSource(Jr(n,t),i),s=await Promise.all(e.map(o=>Jt.fromSource(Jr(o,t))));return new Hh(r,s)}function Qh(n){return((n.fileDirectory.NewSubfileType||0)&4)===4}function Jh(n,e){if(!n)return!1;if(n===!0)return!0;if(e.getSamplesPerPixel()!==3)return!1;const t=e.fileDirectory.PhotometricInterpretation,i=Ve;return t===i.CMYK||t===i.YCbCr||t===i.CIELab||t===i.ICCLab}const Ts="STATISTICS_MAXIMUM",xs="STATISTICS_MINIMUM",Or=256;let Fr;function ed(){return Fr||(Fr=new Th),Fr}function td(n){try{return n.getBoundingBox()}catch{const t=n.fileDirectory;return[0,0,t.ImageWidth,t.ImageLength]}}function id(n){try{return n.getOrigin().slice(0,2)}catch{return[0,n.fileDirectory.ImageLength]}}function rd(n,e){try{return n.getResolution(e)}catch{return[e.fileDirectory.ImageWidth/n.fileDirectory.ImageWidth,e.fileDirectory.ImageHeight/n.fileDirectory.ImageHeight]}}function nd(n){const e=n.geoKeys;if(!e)return null;if(e.ProjectedCSTypeGeoKey&&e.ProjectedCSTypeGeoKey!==32767){const t="EPSG:"+e.ProjectedCSTypeGeoKey;let i=Se(t);if(!i){const r=is(e.ProjLinearUnitsGeoKey);r&&(i=new qr({code:t,units:r}))}return i}if(e.GeographicTypeGeoKey&&e.GeographicTypeGeoKey!==32767){const t="EPSG:"+e.GeographicTypeGeoKey;let i=Se(t);if(!i){const r=is(e.GeogAngularUnitsGeoKey);r&&(i=new qr({code:t,units:r}))}return i}return null}function sd(n){return n.getImageCount().then(function(e){const t=new Array(e);for(let i=0;i<e;++i)t[i]=n.getImage(i);return Promise.all(t)})}function od(n,e){let t;return n.blob?t=Wh(n.blob):n.overviews?t=Xh(n.url,n.overviews,e):t=Yh(n.url,e),t.then(sd)}function gi(n,e,t,i,r){if(Array.isArray(n)){const s=n.length;if(!Array.isArray(e)||s!=e.length){const o=new Error(i);throw r(o),o}for(let o=0;o<s;++o)gi(n[o],e[o],t,i,r);return}if(e=e,Math.abs(n-e)>t*n)throw new Error(i)}function ad(n){return n instanceof Int8Array?-128:n instanceof Int16Array?-32768:n instanceof Int32Array?-2147483648:n instanceof Float32Array?12e-39:0}function ld(n){return n instanceof Int8Array?127:n instanceof Uint8Array||n instanceof Uint8ClampedArray?255:n instanceof Int16Array?32767:n instanceof Uint16Array?65535:n instanceof Int32Array?2147483647:n instanceof Uint32Array?4294967295:n instanceof Float32Array?34e37:255}class ta extends Oo{constructor(e){super({state:"loading",tileGrid:null,projection:null,opaque:e.opaque,transition:e.transition,interpolate:e.interpolate!==!1,wrapX:e.wrapX}),this.sourceInfo_=e.sources;const t=this.sourceInfo_.length;this.sourceOptions_=e.sourceOptions,this.sourceImagery_=new Array(t),this.sourceMasks_=new Array(t),this.resolutionFactors_=new Array(t),this.samplesPerPixel_,this.nodataValues_,this.metadata_,this.normalize_=e.normalize!==!1,this.addAlpha_=!1,this.error_=null,this.convertToRGB_=e.convertToRGB||!1,this.setKey(this.sourceInfo_.map(s=>s.url).join(","));const i=this,r=new Array(t);for(let s=0;s<t;++s)r[s]=od(this.sourceInfo_[s],this.sourceOptions_);Promise.all(r).then(function(s){i.configure_(s)}).catch(function(s){ts(s),i.error_=s,i.setState("error")})}getError(){return this.error_}determineProjection(e){const t=e[0];for(let i=t.length-1;i>=0;--i){const r=t[i],s=nd(r);if(s){this.projection=s;break}}}configure_(e){let t,i,r,s,o;const a=new Array(e.length),l=new Array(e.length),u=new Array(e.length);let c=0;const p=e.length;for(let E=0;E<p;++E){const x=[],L=[];e[E].forEach(D=>{Qh(D)?L.push(D):x.push(D)});const P=x.length;if(L.length>0&&L.length!==P)throw new Error(`Expected one mask per image found ${L.length} masks and ${P} images`);let b,O;const k=new Array(P),K=new Array(P),z=new Array(P);l[E]=new Array(P),u[E]=new Array(P);for(let D=0;D<P;++D){const V=x[D],Q=V.getGDALNoData();u[E][D]=V.getGDALMetadata(0),l[E][D]=Q;const W=this.sourceInfo_[E].bands;a[E]=W?W.length:V.getSamplesPerPixel();const pe=P-(D+1);b||(b=td(V)),O||(O=id(V));const ce=rd(V,x[0]);z[pe]=ce[0];const ue=[V.getTileWidth(),V.getTileHeight()];ue[0]!==ue[1]&&ue[1]<Or&&(ue[0]=Or,ue[1]=Or),k[pe]=ue;const Re=ce[0]/Math.abs(ce[1]);K[pe]=[ue[0],ue[1]/Re]}if(t?ht(t,b,t):t=b,!i)i=O;else{const D=`Origin mismatch for source ${E}, got [${O}] but expected [${i}]`;gi(i,O,0,D,this.viewRejector)}if(!o)o=z,this.resolutionFactors_[E]=1;else{o.length-c>z.length&&(c=o.length-z.length);const D=o[o.length-1]/z[z.length-1];this.resolutionFactors_[E]=D;const V=z.map(W=>W*=D),Q=`Resolution mismatch for source ${E}, got [${V}] but expected [${o}]`;gi(o.slice(c,o.length),V,.02,Q,this.viewRejector)}r?gi(r.slice(c,r.length),K,.01,`Tile size mismatch for source ${E}`,this.viewRejector):r=K,s?gi(s.slice(c,s.length),k,0,`Tile size mismatch for source ${E}`,this.viewRejector):s=k,this.sourceImagery_[E]=x.reverse(),this.sourceMasks_[E]=L.reverse()}for(let E=0,x=this.sourceImagery_.length;E<x;++E){const L=this.sourceImagery_[E];for(;L.length<o.length;)L.unshift(void 0)}this.getProjection()||this.determineProjection(e),this.samplesPerPixel_=a,this.nodataValues_=l,this.metadata_=u;e:for(let E=0;E<p;++E){if(this.sourceInfo_[E].nodata!==void 0){this.addAlpha_=!0;break}if(this.sourceMasks_[E].length){this.addAlpha_=!0;break}const x=l[E],L=this.sourceInfo_[E].bands;if(L){for(let P=0;P<L.length;++P)if(x[L[P]-1]!==null){this.addAlpha_=!0;break e}continue}for(let P=0;P<x.length;++P)if(x[P]!==null){this.addAlpha_=!0;break e}}let _=this.addAlpha_?1:0;for(let E=0;E<p;++E)_+=a[E];this.bandCount=_;const w=new cr({extent:t,minZoom:c,origin:i,resolutions:o,tileSizes:r});this.tileGrid=w,this.setTileSizes(s),this.setLoader(this.loadTile_.bind(this)),this.setState("ready");const v=1;o.length===2?o=[o[0],o[1],o[1]/2]:o.length===1&&(o=[o[0]*2,o[0],o[0]/2]),this.viewResolver({showFullExtent:!0,projection:this.projection,resolutions:o,center:Ll(Ot(t),this.projection),extent:Al(t,this.projection),zoom:v})}loadTile_(e,t,i){const r=this.getTileSize(e),s=this.sourceImagery_.length,o=new Array(s*2),a=this.nodataValues_,l=this.sourceInfo_,u=ed();for(let c=0;c<s;++c){const p=l[c],_=this.resolutionFactors_[c],w=[Math.round(t*(r[0]*_)),Math.round(i*(r[1]*_)),Math.round((t+1)*(r[0]*_)),Math.round((i+1)*(r[1]*_))],v=this.sourceImagery_[c][e];let E;p.bands&&(E=p.bands.map(function(O){return O-1}));let x;"nodata"in p&&p.nodata!==null?x=p.nodata:E?x=E.map(function(O){return a[c][O]}):x=a[c];const L={window:w,width:r[0],height:r[1],samples:E,fillValue:x,pool:u,interleave:!1};Jh(this.convertToRGB_,v)?o[c]=v.readRGB(L):o[c]=v.readRasters(L);const P=s+c,b=this.sourceMasks_[c][e];if(!b){o[P]=Promise.resolve(null);continue}o[P]=b.readRasters({window:w,width:r[0],height:r[1],samples:[0],pool:u,interleave:!1})}return Promise.all(o).then(this.composeTile_.bind(this,r)).catch(function(c){throw ts(c),c})}composeTile_(e,t){const i=this.metadata_,r=this.sourceInfo_,s=this.sourceImagery_.length,o=this.bandCount,a=this.samplesPerPixel_,l=this.nodataValues_,u=this.normalize_,c=this.addAlpha_,p=e[0]*e[1],_=p*o;let w;u?w=new Uint8Array(_):w=new Float32Array(_);let v=0;for(let E=0;E<p;++E){let x=c;for(let L=0;L<s;++L){const P=r[L];let b=P.min,O=P.max,k,K;if(u){const z=i[L][0];b===void 0&&(z&&xs in z?b=parseFloat(z[xs]):b=ad(t[L][0])),O===void 0&&(z&&Ts in z?O=parseFloat(z[Ts]):O=ld(t[L][0])),k=255/(O-b),K=-b*k}for(let z=0;z<a[L];++z){const D=t[L][z][E];let V;if(u?V=Kr(k*D+K,0,255):V=D,!c)w[v]=V;else{let Q=P.nodata;if(Q===void 0){let pe;P.bands?pe=P.bands[z]-1:pe=z,Q=l[L][pe]}const W=isNaN(Q);(!W&&D!==Q||W&&!isNaN(D))&&(x=!1,w[v]=V)}v++}if(!x){const z=s+L,D=t[z];D&&!D[0][E]&&(x=!0)}}c&&(x||(w[v]=255),v++)}return w}}ta.prototype.getView;const cd=ta;let ia=class extends Vc{constructor(e,t,i,r,s,o,a){super(t,i,r,s,o,a),this.zoomifyImage_=null,this.tileSize_=e}getImage(){if(this.zoomifyImage_)return this.zoomifyImage_;const e=super.getImage();if(this.state==Z.LOADED){const t=this.tileSize_;if(e.width==t[0]&&e.height==t[1])return this.zoomifyImage_=e,e;const i=ft(t[0],t[1]);return i.drawImage(e,0,0),this.zoomifyImage_=i.canvas,i.canvas}return e}};class ud extends Et{constructor(e){const t=e.size,i=e.tierSizeCalculation!==void 0?e.tierSizeCalculation:"default",r=e.tilePixelRatio||1,s=t[0],o=t[1],a=[],l=e.tileSize||Hr;let u=l*r;switch(i){case"default":for(;s>u||o>u;)a.push([Math.ceil(s/u),Math.ceil(o/u)]),u+=u;break;case"truncated":let K=s,z=o;for(;K>u||z>u;)a.push([Math.ceil(K/u),Math.ceil(z/u)]),K>>=1,z>>=1;break;default:De(!1,53);break}a.push([1,1]),a.reverse();const c=[r],p=[0];for(let K=1,z=a.length;K<z;K++)c.push(r<<K),p.push(a[K-1][0]*a[K-1][1]+p[K-1]);c.reverse();const _=new cr({tileSize:l,extent:e.extent||[0,-o,s,0],resolutions:c});let w=e.url;w&&!w.includes("{TileGroup}")&&!w.includes("{tileIndex}")&&(w+="{TileGroup}/{z}-{x}-{y}.jpg");const v=Ro(w);let E=l*r;function x(K){return function(z,D,V){if(!z)return;const Q=z[0],W=z[1],pe=z[2],ce=W+pe*a[Q][0],ue=(ce+p[Q])/E|0,Re={z:Q,x:W,y:pe,tileIndex:ce,TileGroup:"TileGroup"+ue};return K.replace(/\{(\w+?)\}/g,function(Pe,ye){return Re[ye]})}}const L=qi(v.map(x)),P=ia.bind(null,Qe(l*r));super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,tilePixelRatio:r,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:P,tileGrid:_,tileUrlFunction:L,transition:e.transition}),this.zDirection=e.zDirection;const b=_.getTileCoordForCoordAndResolution(Ot(_.getExtent()),c[c.length-1]),O=L(b,1,null),k=new Image;k.addEventListener("error",()=>{E=l,this.changed()}),k.src=O}}const hd=ud,hi={VERSION1:"version1",VERSION2:"version2",VERSION3:"version3"};function di(n){return n.toLocaleString("en",{maximumFractionDigits:10})}class dd extends Et{constructor(e){const t=e||{};let i=t.url||"";i=i+(i.lastIndexOf("/")===i.length-1||i===""?"":"/");const r=t.version||hi.VERSION2,s=t.sizes||[],o=t.size;De(o!=null&&Array.isArray(o)&&o.length==2&&!isNaN(o[0])&&o[0]>0&&!isNaN(o[1])&&o[1]>0,60);const a=o[0],l=o[1],u=t.tileSize,c=t.tilePixelRatio||1,p=t.format||"jpg",_=t.quality||(t.version==hi.VERSION1?"native":"default");let w=t.resolutions||[];const v=t.supports||[],E=t.extent||[0,-l,a,0],x=s!=null&&Array.isArray(s)&&s.length>0,L=u!==void 0&&(typeof u=="number"&&Number.isInteger(u)&&u>0||Array.isArray(u)&&u.length>0),P=v!=null&&Array.isArray(v)&&(v.includes("regionByPx")||v.includes("regionByPct"))&&(v.includes("sizeByWh")||v.includes("sizeByH")||v.includes("sizeByW")||v.includes("sizeByPct"));let b,O,k;if(w.sort(function(V,Q){return Q-V}),L||P)if(u!=null&&(typeof u=="number"&&Number.isInteger(u)&&u>0?(b=u,O=u):Array.isArray(u)&&u.length>0&&((u.length==1||u[1]==null&&Number.isInteger(u[0]))&&(b=u[0],O=u[0]),u.length==2&&(Number.isInteger(u[0])&&Number.isInteger(u[1])?(b=u[0],O=u[1]):u[0]==null&&Number.isInteger(u[1])&&(b=u[1],O=u[1])))),(b===void 0||O===void 0)&&(b=Hr,O=Hr),w.length==0){k=Math.max(Math.ceil(Math.log(a/b)/Math.LN2),Math.ceil(Math.log(l/O)/Math.LN2));for(let V=k;V>=0;V--)w.push(Math.pow(2,V))}else{const V=Math.max(...w);k=Math.round(Math.log(V)/Math.LN2)}else if(b=a,O=l,w=[],x){s.sort(function(Q,W){return Q[0]-W[0]}),k=-1;const V=[];for(let Q=0;Q<s.length;Q++){const W=a/s[Q][0];if(w.length>0&&w[w.length-1]==W){V.push(Q);continue}w.push(W),k++}if(V.length>0)for(let Q=0;Q<V.length;Q++)s.splice(V[Q]-Q,1)}else w.push(1),s.push([a,l]),k=0;const K=new cr({tileSize:[b,O],extent:E,origin:an(E),resolutions:w}),z=function(V,Q,W){let pe,ce;const ue=V[0];if(ue>k)return;const Re=V[1],Pe=V[2],ye=w[ue];if(!(Re===void 0||Pe===void 0||ye===void 0||Re<0||Math.ceil(a/ye/b)<=Re||Pe<0||Math.ceil(l/ye/O)<=Pe)){if(P||L){const _e=Re*b*ye,Le=Pe*O*ye;let at=b*ye,Je=O*ye,$=b,et=O;if(_e+at>a&&(at=a-_e),Le+Je>l&&(Je=l-Le),_e+b*ye>a&&($=Math.floor((a-_e+ye-1)/ye)),Le+O*ye>l&&(et=Math.floor((l-Le+ye-1)/ye)),_e==0&&at==a&&Le==0&&Je==l)pe="full";else if(!P||v.includes("regionByPx"))pe=_e+","+Le+","+at+","+Je;else if(v.includes("regionByPct")){const M=di(_e/a*100),ae=di(Le/l*100),ve=di(at/a*100),ni=di(Je/l*100);pe="pct:"+M+","+ae+","+ve+","+ni}r==hi.VERSION3&&(!P||v.includes("sizeByWh"))?ce=$+","+et:!P||v.includes("sizeByW")?ce=$+",":v.includes("sizeByH")?ce=","+et:v.includes("sizeByWh")?ce=$+","+et:v.includes("sizeByPct")&&(ce="pct:"+di(100/ye))}else if(pe="full",x){const _e=s[ue][0],Le=s[ue][1];r==hi.VERSION3?_e==a&&Le==l?ce="max":ce=_e+","+Le:_e==a?ce="full":ce=_e+","}else ce=r==hi.VERSION3?"max":"full";return i+pe+"/"+ce+"/0/"+_+"."+p}},D=ia.bind(null,Qe(u||256).map(function(V){return V*c}));super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:t.state,tileClass:D,tileGrid:K,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:z,transition:t.transition}),this.zDirection=t.zDirection}}const fd=dd;class gd extends ro{constructor(e,t,i,r,s,o,a){const l=e.getExtent(),u=t.getExtent(),c=u?ht(i,u):i,p=Ot(c),_=gn(e,t,p,r),w=Co,v=new Eo(e,t,c,l,_*w,r),E=v.calculateSourceExtent(),x=o(E,_,s),L=x?Ie.IDLE:Ie.EMPTY,P=x?x.getPixelRatio():1;super(i,r,P,L),this.targetProj_=t,this.maxSourceExtent_=l,this.triangulation_=v,this.targetResolution_=r,this.targetExtent_=i,this.sourceImage_=x,this.sourcePixelRatio_=P,this.interpolate_=a,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Ie.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const e=this.sourceImage_.getState();if(e==Ie.LOADED){const t=je(this.targetExtent_)/this.targetResolution_,i=Ge(this.targetExtent_)/this.targetResolution_;this.canvas_=To(t,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)}this.state=e,this.changed()}load(){if(this.state==Ie.IDLE){this.state=Ie.LOADING,this.changed();const e=this.sourceImage_.getState();e==Ie.LOADED||e==Ie.ERROR?this.reproject_():(this.sourceListenerKey_=Wt(this.sourceImage_,Ke.CHANGE,function(t){const i=this.sourceImage_.getState();(i==Ie.LOADED||i==Ie.ERROR)&&(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}}unlistenSource_(){$i(this.sourceListenerKey_),this.sourceListenerKey_=null}}const md=gd,Ui={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};class ra extends no{constructor(e,t){super(e),this.image=t}}class mt extends rr{constructor(e){super({attributions:e.attributions,projection:e.projection,state:e.state,interpolate:e.interpolate!==void 0?e.interpolate:!0}),this.on,this.once,this.un,this.resolutions_=e.resolutions!==void 0?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}getResolutions(){return this.resolutions_}setResolutions(e){this.resolutions_=e}findNearestResolution(e){const t=this.getResolutions();if(t){const i=Ol(t,e,0);e=t[i]}return e}getImage(e,t,i,r){const s=this.getProjection();if(!s||!r||Ut(s,r))return s&&(r=s),this.getImageInternal(e,t,i,r);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Ut(this.reprojectedImage_.getProjection(),r)&&this.reprojectedImage_.getResolution()==t&&yi(this.reprojectedImage_.getExtent(),e))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new md(s,r,e,t,i,(o,a,l)=>this.getImageInternal(o,a,l,s),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(e,t,i,r){return so()}handleImageChange(e){const t=e.target;let i;switch(t.getState()){case Ie.LOADING:this.loading=!0,i=Ui.IMAGELOADSTART;break;case Ie.LOADED:this.loading=!1,i=Ui.IMAGELOADEND;break;case Ie.ERROR:this.loading=!1,i=Ui.IMAGELOADERROR;break;default:return}this.hasListener(i)&&this.dispatchEvent(new ra(i,t))}}function Ii(n,e){n.getImage().src=e}const pd=Object.freeze(Object.defineProperty({__proto__:null,ImageSourceEvent:ra,ImageSourceEventType:Ui,default:mt,defaultImageLoadFunction:Ii},Symbol.toStringTag,{value:"Module"}));function gt(n,e){const t=[];Object.keys(e).forEach(function(r){e[r]!==null&&e[r]!==void 0&&t.push(r+"="+encodeURIComponent(e[r]))});const i=t.join("&");return n=n.replace(/[?&]$/,""),n+=n.includes("?")?"&":"?",n+i}class yd extends mt{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:Ii,this.params_=e.params||{},this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getParams(){return this.params_}getImageInternal(e,t,i,r){if(this.url_===void 0)return null;t=this.findNearestResolution(t),i=this.hidpi_?i:1;const s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&Ct(s.getExtent(),e))return s;const o={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};Object.assign(o,this.params_),e=e.slice();const a=(e[0]+e[2])/2,l=(e[1]+e[3])/2;if(this.ratio_!=1){const w=this.ratio_*je(e)/2,v=this.ratio_*Ge(e)/2;e[0]=a-w,e[1]=l-v,e[2]=a+w,e[3]=l+v}const u=t/i,c=Math.ceil(je(e)/u),p=Math.ceil(Ge(e)/u);e[0]=a-u*c/2,e[2]=a+u*c/2,e[1]=l-u*p/2,e[3]=l+u*p/2,this.imageSize_[0]=c,this.imageSize_[1]=p;const _=this.getRequestUrl_(e,this.imageSize_,i,r,o);return this.image_=new nr(e,t,i,_,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Ke.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(e,t,i,r,s){const o=r.getCode().split(/:(?=\d+$)/).pop();s.SIZE=t[0]+","+t[1],s.BBOX=e.join(","),s.BBOXSR=o,s.IMAGESR=o,s.DPI=Math.round(90*i);const a=this.url_,l=a.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return l==a&&De(!1,50),gt(l,s)}getUrl(){return this.url_}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.image_=null,this.changed()}}const _d=yd;class wd extends ro{constructor(e,t,i,r,s){const o=s!==void 0?Ie.IDLE:Ie.LOADED;super(e,t,i,o),this.loader_=s!==void 0?s:null,this.canvas_=r,this.error_=null}getError(){return this.error_}handleLoad_(e){e?(this.error_=e,this.state=Ie.ERROR):this.state=Ie.LOADED,this.changed()}load(){this.state==Ie.IDLE&&(this.state=Ie.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))}getImage(){return this.canvas_}}const na=wd;class vd extends mt{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions,state:e.state}),this.canvasFunction_=e.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getImageInternal(e,t,i,r){t=this.findNearestResolution(t);let s=this.canvas_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&Ct(s.getExtent(),e))return s;e=e.slice(),ln(e,this.ratio_);const o=je(e)/t,a=Ge(e)/t,l=[o*i,a*i],u=this.canvasFunction_.call(this,e,t,i,l,r);return u&&(s=new na(e,t,i,u)),this.canvas_=s,this.renderedRevision_=this.getRevision(),s}}const Sd=vd;class Cd extends mt{constructor(e){super({interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.displayDpi_=e.displayDpi!==void 0?e.displayDpi:96,this.params_=e.params||{},this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:Ii,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.metersPerUnit_=e.metersPerUnit!==void 0?e.metersPerUnit:1,this.ratio_=e.ratio!==void 0?e.ratio:1,this.useOverlay_=e.useOverlay!==void 0?e.useOverlay:!1,this.image_=null,this.renderedRevision_=0}getParams(){return this.params_}getImageInternal(e,t,i,r){t=this.findNearestResolution(t),i=this.hidpi_?i:1;let s=this.image_;if(s&&this.renderedRevision_==this.getRevision()&&s.getResolution()==t&&s.getPixelRatio()==i&&Ct(s.getExtent(),e))return s;this.ratio_!=1&&(e=e.slice(),ln(e,this.ratio_));const o=je(e)/t,a=Ge(e)/t,l=[o*i,a*i];if(this.url_!==void 0){const u=this.getUrl(this.url_,this.params_,e,l,r);s=new nr(e,t,i,u,this.crossOrigin_,this.imageLoadFunction_),s.addEventListener(Ke.CHANGE,this.handleImageChange.bind(this))}else s=null;return this.image_=s,this.renderedRevision_=this.getRevision(),s}getImageLoadFunction(){return this.imageLoadFunction_}updateParams(e){Object.assign(this.params_,e),this.changed()}getUrl(e,t,i,r,s){const o=Ed(i,r,this.metersPerUnit_,this.displayDpi_),a=Ot(i),l={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(r[0]),SETDISPLAYHEIGHT:Math.round(r[1]),SETVIEWSCALE:o,SETVIEWCENTERX:a[0],SETVIEWCENTERY:a[1]};return Object.assign(l,t),gt(e,l)}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}}function Ed(n,e,t,i){const r=je(n),s=Ge(n),o=e[0],a=e[1],l=.0254/i;return a*r>o*s?r*t/(o*l):s*t/(a*l)}const Td=Cd;class xd extends mt{constructor(e){const t=e.crossOrigin!==void 0?e.crossOrigin:null,i=e.imageLoadFunction!==void 0?e.imageLoadFunction:Ii;super({attributions:e.attributions,interpolate:e.interpolate,projection:Se(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image_=new nr(this.imageExtent_,void 0,1,this.url_,t,i),this.imageSize_=e.imageSize?e.imageSize:null,this.image_.addEventListener(Ke.CHANGE,this.handleImageChange.bind(this))}getImageExtent(){return this.imageExtent_}getImageInternal(e,t,i,r){return Xe(e,this.image_.getExtent())?this.image_:null}getUrl(){return this.url_}handleImageChange(e){if(this.image_.getState()==Ie.LOADED){const t=this.image_.getExtent(),i=this.image_.getImage();let r,s;this.imageSize_?(r=this.imageSize_[0],s=this.imageSize_[1]):(r=i.width,s=i.height);const o=je(t),a=Ge(t),l=o/r,u=a/s;let c=r,p=s;if(l>u?c=Math.round(o/u):p=Math.round(a/l),c!==r||p!==s){const _=ft(c,p);this.getInterpolate()||(_.imageSmoothingEnabled=!1);const w=_.canvas;_.drawImage(i,0,0,r,s,0,0,w.width,w.height),this.image_.setImage(w)}}super.handleImageChange(e)}}const Tn=xd,Rd=Object.freeze(Object.defineProperty({__proto__:null,default:Tn},Symbol.toStringTag,{value:"Module"})),St="1.3.0",_t=4,Rs=[101,101];class Pd extends mt{constructor(e){e=e||{},super({attributions:e.attributions,interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:Ii,this.params_=Object.assign({},e.params),this.v13_=!0,this.updateV13_(),this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=e.ratio!==void 0?e.ratio:1.5}getFeatureInfoUrl(e,t,i,r){if(this.url_===void 0)return;const s=Se(i),o=this.getProjection();o&&o!==s&&(t=gn(o,s,e,t),e=ut(e,s,o));const a=Er(e,t,0,Rs),l={SERVICE:"WMS",VERSION:St,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(l,this.params_,r);const u=rs((e[0]-a[0])/t,_t),c=rs((a[3]-e[1])/t,_t);return l[this.v13_?"I":"X"]=u,l[this.v13_?"J":"Y"]=c,this.getRequestUrl_(a,Rs,1,o||s,l)}getLegendUrl(e,t){if(this.url_===void 0)return;const i={SERVICE:"WMS",VERSION:St,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),gt(this.url_,i)}getParams(){return this.params_}getImageInternal(e,t,i,r){if(this.url_===void 0)return null;t=this.findNearestResolution(t),i!=1&&(!this.hidpi_||this.serverType_===void 0)&&(i=1);const s=t/i,o=Ot(e),a=Fi(je(e)/s,_t),l=Fi(Ge(e)/s,_t),u=Er(o,s,0,[a,l]),c=Fi(this.ratio_*je(e)/s,_t),p=Fi(this.ratio_*Ge(e)/s,_t),_=Er(o,s,0,[c,p]),w=this.image_;if(w&&this.renderedRevision_==this.getRevision()&&w.getResolution()==t&&w.getPixelRatio()==i&&Ct(w.getExtent(),u))return w;const v={SERVICE:"WMS",VERSION:St,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Object.assign(v,this.params_),this.imageSize_[0]=ns(je(_)/s,_t),this.imageSize_[1]=ns(Ge(_)/s,_t);const E=this.getRequestUrl_(_,this.imageSize_,i,r,v);return this.image_=new nr(_,t,i,E,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Ke.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(e,t,i,r,s){if(De(this.url_!==void 0,9),s[this.v13_?"CRS":"SRS"]=r.getCode(),"STYLES"in this.params_||(s.STYLES=""),i!=1)switch(this.serverType_){case"geoserver":const l=90*i+.5|0;"FORMAT_OPTIONS"in s?s.FORMAT_OPTIONS+=";dpi:"+l:s.FORMAT_OPTIONS="dpi:"+l;break;case"mapserver":s.MAP_RESOLUTION=90*i;break;case"carmentaserver":case"qgis":s.DPI=90*i;break;default:De(!1,8);break}s.WIDTH=t[0],s.HEIGHT=t[1];const o=r.getAxisOrientation();let a;return this.v13_&&o.substr(0,2)=="ne"?a=[e[1],e[0],e[3],e[2]]:a=e,s.BBOX=a.join(","),gt(this.url_,s)}getUrl(){return this.url_}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}setUrl(e){e!=this.url_&&(this.url_=e,this.image_=null,this.changed())}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.image_=null,this.changed()}updateV13_(){const e=this.params_.VERSION||St;this.v13_=oo(e,"1.3")>=0}}const Ji=Pd,Id=Object.freeze(Object.defineProperty({__proto__:null,default:Ji},Symbol.toStringTag,{value:"Module"}));class bd extends Fl{constructor(e){e=e||{},super(e)}}const Ld=bd;class Ad extends Ml{constructor(e){super(e),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(e){const t=e.layerStatesArray[e.layerIndex],i=e.pixelRatio,r=e.viewState,s=r.resolution,o=this.getLayer().getSource(),a=e.viewHints;let l=e.extent;if(t.extent!==void 0&&(l=ht(l,ss(t.extent,r.projection))),!a[vt.ANIMATING]&&!a[vt.INTERACTING]&&!Nl(l))if(o){const u=r.projection,c=o.getImage(l,s,i,u);c&&(this.loadImage(c)?this.image_=c:c.getState()===Ie.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(e){const t=this.frameState;if(!t)return null;const i=this.getLayer(),r=cn(t.pixelToCoordinateTransform,e.slice()),s=i.getExtent();if(s&&!Gl(s,r))return null;const o=this.image_.getExtent(),a=this.image_.getImage(),l=je(o),u=Math.floor(a.width*((r[0]-o[0])/l));if(u<0||u>=a.width)return null;const c=Ge(o),p=Math.floor(a.height*((o[3]-r[1])/c));return p<0||p>=a.height?null:this.getImageData(a,u,p)}renderFrame(e,t){const i=this.image_,r=i.getExtent(),s=i.getResolution(),o=i.getPixelRatio(),a=e.layerStatesArray[e.layerIndex],l=e.pixelRatio,u=e.viewState,c=u.center,p=u.resolution,_=l*s/(p*o),w=e.extent,v=u.resolution,E=u.rotation,x=Math.round(je(w)/v*l),L=Math.round(Ge(w)/v*l);Yr(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/l,1/l,E,-x/2,-L/2),Dl(this.inversePixelTransform,this.pixelTransform);const P=zl(this.pixelTransform);this.useContainer(t,P,this.getBackground(e));const b=this.context,O=b.canvas;O.width!=x||O.height!=L?(O.width=x,O.height=L):this.containerReused||b.clearRect(0,0,x,L);let k=!1,K=!0;if(a.extent){const W=ss(a.extent,u.projection);K=Xe(W,e.extent),k=K&&!Ct(W,e.extent),k&&this.clipUnrotated(b,e,W)}const z=i.getImage(),D=Yr(this.tempTransform,x/2,L/2,_,_,0,o*(r[0]-c[0])/s,o*(c[1]-r[3])/s);this.renderedResolution=s*l/o;const V=z.width*D[0],Q=z.height*D[3];if(this.getLayer().getSource().getInterpolate()||(b.imageSmoothingEnabled=!1),this.preRender(b,e),K&&V>=.5&&Q>=.5){const W=D[4],pe=D[5],ce=a.opacity;let ue;ce!==1&&(ue=b.globalAlpha,b.globalAlpha=ce),b.drawImage(z,0,0,+z.width,+z.height,W,pe,V,Q),ce!==1&&(b.globalAlpha=ue)}return this.postRender(b,e),k&&b.restore(),b.imageSmoothingEnabled=!0,P!==O.style.transform&&(O.style.transform=P),this.container}}const Od=Ad;class pi extends Ld{constructor(e){super(e)}createRenderer(){return new Od(this)}getData(e){return super.getData(e)}}const Fd=Object.freeze(Object.defineProperty({__proto__:null,default:pi},Symbol.toStringTag,{value:"Module"}));let sa=!0;try{new ImageData(10,10)}catch{sa=!1}let Mr;function Md(n,e,t){if(sa)return new ImageData(n,e,t);Mr||(Mr=document.createElement("canvas").getContext("2d"));const i=Mr.createImageData(e,t);return i.data.set(n),i}function oa(n){let e=!0;try{new ImageData(10,10)}catch{e=!1}function t(i,r,s){return e?new ImageData(i,r,s):{data:i,width:r,height:s}}return function(i){const r=i.buffers,s=i.meta,o=i.imageOps,a=i.width,l=i.height,u=r.length,c=r[0].byteLength;if(o){const v=new Array(u);for(let x=0;x<u;++x)v[x]=t(new Uint8ClampedArray(r[x]),a,l);return n(v,s).data.buffer}const p=new Uint8ClampedArray(c),_=new Array(u),w=new Array(u);for(let v=0;v<u;++v)_[v]=new Uint8ClampedArray(r[v]),w[v]=[0,0,0,0];for(let v=0;v<c;v+=4){for(let x=0;x<u;++x){const L=_[x];w[x][0]=L[v],w[x][1]=L[v+1],w[x][2]=L[v+2],w[x][3]=L[v+3]}const E=n(w,s);p[v]=E[0],p[v+1]=E[1],p[v+2]=E[2],p[v+3]=E[3]}return p.buffer}}function Nd(n,e){const i=Object.keys(n.lib||{}).map(function(s){return"const "+s+" = "+n.lib[s].toString()+";"}).concat(["const __minion__ = ("+oa.toString()+")(",n.operation.toString(),");",'self.addEventListener("message", function(event) {',"  const buffer = __minion__(event.data);","  self.postMessage({buffer: buffer, meta: event.data.meta}, [buffer]);","});"]),r=new Worker(typeof Blob>"u"?"data:text/javascript;base64,"+Buffer.from(i.join(`
`),"binary").toString("base64"):URL.createObjectURL(new Blob(i,{type:"text/javascript"})));return r.addEventListener("message",e),r}function Gd(n,e){const t=oa(n.operation);let i=!1;return{postMessage:function(r){setTimeout(function(){i||e({data:{buffer:t(r),meta:r.meta}})},0)},terminate:function(){i=!0}}}class Dd extends jl{constructor(e){super(),this._imageOps=!!e.imageOps;let t;e.threads===0?t=0:this._imageOps?t=1:t=e.threads||1;const i=new Array(t);if(t)for(let r=0;r<t;++r)i[r]=Nd(e,this._onWorkerMessage.bind(this,r));else i[0]=Gd(e,this._onWorkerMessage.bind(this,0));this._workers=i,this._queue=[],this._maxQueueLength=e.queue||1/0,this._running=0,this._dataLookup={},this._job=null}process(e,t,i){this._enqueue({inputs:e,meta:t,callback:i}),this._dispatch()}_enqueue(e){for(this._queue.push(e);this._queue.length>this._maxQueueLength;)this._queue.shift().callback(null,null)}_dispatch(){if(this._running||this._queue.length===0)return;const e=this._queue.shift();this._job=e;const t=e.inputs[0].width,i=e.inputs[0].height,r=e.inputs.map(function(l){return l.data.buffer}),s=this._workers.length;if(this._running=s,s===1){this._workers[0].postMessage({buffers:r,meta:e.meta,imageOps:this._imageOps,width:t,height:i},r);return}const o=e.inputs[0].data.length,a=4*Math.ceil(o/4/s);for(let l=0;l<s;++l){const u=l*a,c=[];for(let p=0,_=r.length;p<_;++p)c.push(r[p].slice(u,u+a));this._workers[l].postMessage({buffers:c,meta:e.meta,imageOps:this._imageOps,width:t,height:i},c)}}_onWorkerMessage(e,t){this.disposed||(this._dataLookup[e]=t.data,--this._running,this._running===0&&this._resolveJob())}_resolveJob(){const e=this._job,t=this._workers.length;let i,r;if(t===1)i=new Uint8ClampedArray(this._dataLookup[0].buffer),r=this._dataLookup[0].meta;else{const s=e.inputs[0].data.length;i=new Uint8ClampedArray(s),r=new Array(t);const o=4*Math.ceil(s/4/t);for(let a=0;a<t;++a){const l=this._dataLookup[a].buffer,u=a*o;i.set(new Uint8ClampedArray(l),u),r[a]=this._dataLookup[a].meta}}this._job=null,this._dataLookup={},e.callback(null,Md(i,e.inputs[0].width,e.inputs[0].height),r),this._dispatch()}disposeInternal(){for(let e=0;e<this._workers.length;++e)this._workers[e].terminate();this._workers.length=0}}const Ps={BEFOREOPERATIONS:"beforeoperations",AFTEROPERATIONS:"afteroperations"};class Is extends no{constructor(e,t,i){super(e),this.extent=t.extent,this.resolution=t.viewState.resolution/t.pixelRatio,this.data=i}}class aa extends mt{constructor(e){super({projection:null}),this.on,this.once,this.un,this.processor_=null,this.operationType_=e.operationType!==void 0?e.operationType:"pixel",this.threads_=e.threads!==void 0?e.threads:1,this.layers_=jd(e.sources);const t=this.changed.bind(this);for(let i=0,r=this.layers_.length;i<r;++i)this.layers_[i].addEventListener(Ke.CHANGE,t);this.useResolutions_=e.resolutions!==null,this.tileQueue_=new Vl(function(){return 1},this.changed.bind(this)),this.requestedFrameState_,this.renderedImageCanvas_=null,this.renderedRevision_,this.frameState_={animate:!1,coordinateToPixelTransform:_i(),declutterTree:null,extent:null,index:0,layerIndex:0,layerStatesArray:Vd(this.layers_),pixelRatio:1,pixelToCoordinateTransform:_i(),postRenderFunctions:[],size:[0,0],tileQueue:this.tileQueue_,time:Date.now(),usedTiles:{},viewState:{rotation:0},viewHints:[],wantedTiles:{},mapId:Oe(this),renderTargets:{}},this.setAttributions(function(i){const r=[];for(let s=0,o=e.sources.length;s<o;++s){const a=e.sources[s],l=a instanceof rr?a:a.getSource();if(!l)continue;const u=l.getAttributions();if(typeof u=="function"){const c=u(i);r.push.apply(r,c)}}return r.length!==0?r:null}),e.operation!==void 0&&this.setOperation(e.operation,e.lib)}setOperation(e,t){this.processor_&&this.processor_.dispose(),this.processor_=new Dd({operation:e,imageOps:this.operationType_==="image",queue:1,lib:t,threads:this.threads_}),this.changed()}updateFrameState_(e,t,i){const r=Object.assign({},this.frameState_);r.viewState=Object.assign({},r.viewState);const s=Ot(e);r.size[0]=Math.ceil(je(e)/t),r.size[1]=Math.ceil(Ge(e)/t),r.extent=[s[0]-r.size[0]*t/2,s[1]-r.size[1]*t/2,s[0]+r.size[0]*t/2,s[1]+r.size[1]*t/2],r.time=Date.now();const o=r.viewState;return o.center=s,o.projection=i,o.resolution=t,r}allSourcesReady_(){let e=!0,t;for(let i=0,r=this.layers_.length;i<r;++i)if(t=this.layers_[i].getSource(),!t||t.getState()!=="ready"){e=!1;break}return e}getImage(e,t,i,r){if(!this.allSourcesReady_())return null;t=this.findNearestResolution(t);const s=this.updateFrameState_(e,t,r);if(this.requestedFrameState_=s,this.renderedImageCanvas_){const o=this.renderedImageCanvas_.getResolution(),a=this.renderedImageCanvas_.getExtent();(t!==o||!yi(s.extent,a))&&(this.renderedImageCanvas_=null)}return(!this.renderedImageCanvas_||this.getRevision()!==this.renderedRevision_)&&this.processSources_(),s.tileQueue.loadMoreTiles(16,16),s.animate&&requestAnimationFrame(this.changed.bind(this)),this.renderedImageCanvas_}processSources_(){const e=this.requestedFrameState_,t=this.layers_.length,i=new Array(t);for(let s=0;s<t;++s){e.layerIndex=s;const o=zd(this.layers_[s],e);if(o)i[s]=o;else return}const r={};this.dispatchEvent(new Is(Ps.BEFOREOPERATIONS,e,r)),this.processor_.process(i,r,this.onWorkerComplete_.bind(this,e))}onWorkerComplete_(e,t,i,r){if(t||!i)return;const s=e.extent,o=e.viewState.resolution;if(o!==this.requestedFrameState_.viewState.resolution||!yi(s,this.requestedFrameState_.extent))return;let a;if(this.renderedImageCanvas_)a=this.renderedImageCanvas_.getImage().getContext("2d");else{const l=Math.round(je(s)/o),u=Math.round(Ge(s)/o);a=ft(l,u),this.renderedImageCanvas_=new na(s,o,1,a.canvas)}a.putImageData(i,0,0),this.changed(),this.renderedRevision_=this.getRevision(),this.dispatchEvent(new Is(Ps.AFTEROPERATIONS,e,r)),e.animate&&requestAnimationFrame(this.changed.bind(this))}getResolutions(e){if(!this.useResolutions_)return null;let t=super.getResolutions();if(!t)for(let i=0,r=this.layers_.length;i<r&&(t=this.layers_[i].getSource().getResolutions(e),!t);++i);return t}disposeInternal(){this.processor_&&this.processor_.dispose(),super.disposeInternal()}}aa.prototype.dispose;let It=null;function zd(n,e){const t=n.getRenderer();if(!t)throw new Error("Unsupported layer type: "+n);if(!t.prepareFrame(e))return null;const i=e.size[0],r=e.size[1];if(i===0||r===0)return null;const s=t.renderFrame(e,null);let o;if(s instanceof HTMLCanvasElement)o=s;else{if(s&&(o=s.firstElementChild),!(o instanceof HTMLCanvasElement))throw new Error("Unsupported rendered element: "+o);if(o.width===i&&o.height===r)return o.getContext("2d").getImageData(0,0,i,r)}if(!It)It=ft(i,r,void 0,{willReadFrequently:!0});else{const a=It.canvas;a.width!==i||a.height!==r?It=ft(i,r,void 0,{willReadFrequently:!0}):It.clearRect(0,0,i,r)}return It.drawImage(o,0,0,i,r),It.getImageData(0,0,i,r)}function Vd(n){return n.map(function(e){return e.getLayerState()})}function jd(n){const e=n.length,t=new Array(e);for(let i=0;i<e;++i)t[i]=kd(n[i]);return t}function kd(n){let e;return n instanceof rr?n instanceof lr?e=new Bt({source:n}):n instanceof mt&&(e=new pi({source:n})):e=n,e}const Bd=aa,Ud=['Map tiles by <a href="https://stamen.com/" target="_blank">Stamen Design</a>, under <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC BY 3.0</a>.',jc],$d={terrain:{extension:"png",opaque:!0},"terrain-background":{extension:"png",opaque:!0},"terrain-labels":{extension:"png",opaque:!1},"terrain-lines":{extension:"png",opaque:!1},"toner-background":{extension:"png",opaque:!0},toner:{extension:"png",opaque:!0},"toner-hybrid":{extension:"png",opaque:!1},"toner-labels":{extension:"png",opaque:!1},"toner-lines":{extension:"png",opaque:!1},"toner-lite":{extension:"png",opaque:!0},watercolor:{extension:"jpg",opaque:!0}},Kd={terrain:{minZoom:0,maxZoom:18},toner:{minZoom:0,maxZoom:20},watercolor:{minZoom:0,maxZoom:18}};class Zd extends xi{constructor(e){const t=e.layer.indexOf("-"),i=t==-1?e.layer:e.layer.slice(0,t),r=Kd[i],s=$d[e.layer],o=e.url!==void 0?e.url:"https://stamen-tiles-{a-d}.a.ssl.fastly.net/"+e.layer+"/{z}/{x}/{y}."+s.extension;super({attributions:Ud,cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:e.interpolate,maxZoom:e.maxZoom!=null?e.maxZoom:r.maxZoom,minZoom:e.minZoom!=null?e.minZoom:r.minZoom,opaque:s.opaque,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileLoadFunction:e.tileLoadFunction,transition:e.transition,url:o,wrapX:e.wrapX,zDirection:e.zDirection})}}const la=Zd;class qd extends Et{constructor(e){e=e||{},super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.params_=e.params||{},this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ao(),this.setKey(this.getKeyForParams_())}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s,o){const a=this.urls;if(!a)return;const l=s.getCode().split(/:(?=\d+$)/).pop();o.SIZE=t[0]+","+t[1],o.BBOX=i.join(","),o.BBOXSR=l,o.IMAGESR=l,o.DPI=Math.round(o.DPI?o.DPI*r:90*r);let u;if(a.length==1)u=a[0];else{const p=lo(Po(e),a.length);u=a[p]}const c=u.replace(/MapServer\/?$/,"MapServer/export").replace(/ImageServer\/?$/,"ImageServer/exportImage");return gt(c,o)}getTilePixelRatio(e){return this.hidpi_?e:1}updateParams(e){Object.assign(this.params_,e),this.setKey(this.getKeyForParams_())}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&!this.hidpi_&&(t=1);const s=r.getTileCoordExtent(e,this.tmpExtent_);let o=Qe(r.getTileSize(e[0]),this.tmpSize);t!=1&&(o=co(o,t,this.tmpSize));const a={F:"image",FORMAT:"PNG32",TRANSPARENT:!0};return Object.assign(a,this.params_),this.getRequestUrl_(e,o,s,t,i,a)}}const Hd=qd;class Yd extends xi{constructor(e){e=e||{},super({opaque:!1,projection:e.projection,tileGrid:e.tileGrid,wrapX:e.wrapX!==void 0?e.wrapX:!0,zDirection:e.zDirection,url:e.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(t,i)=>{const r=t.getTileCoord()[0],s=Qe(this.tileGrid.getTileSize(r)),o=ft(s[0],s[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,s[0]+.5,s[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,s[0]/2,s[1]/2,s[0]),o.fillText(i,s[0]/2,s[1]/2,s[0]),t.setImage(o.canvas)}})}}const ca=Yd;class Wd extends Et{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:Se("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)ur(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):De(!1,51)}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){const t=Se("EPSG:4326"),i=this.getProjection();let r;if(e.bounds!==void 0){const u=Yt(t,i);r=on(e.bounds,u)}const s=Ei(i),o=e.minzoom||0,a=e.maxzoom||22,l=Ti({extent:s,maxZoom:a,minZoom:o,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=Io(e.tiles,l),e.attribution&&!this.getAttributions()){const u=r!==void 0?r:s;this.setAttributions(function(c){return Xe(u,c.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}}const Xd=Wd;class ua extends Et{constructor(e){e=e||{};const t=Object.assign({},e.params),i="TRANSPARENT"in t?t.TRANSPARENT:!0;super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,opaque:!i,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction,url:e.url,urls:e.urls,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.params_=t,this.v13_=!0,this.serverType_=e.serverType,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.tmpExtent_=ao(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(e,t,i,r){const s=Se(i),o=this.getProjection();let a=this.getTileGrid();a||(a=this.getTileGridForProjection(s));const l=a.getZForResolution(t,this.zDirection),u=a.getTileCoordForCoordAndZ(e,l);if(a.getResolutions().length<=u[0])return;let c=a.getResolution(u[0]),p=a.getTileCoordExtent(u,this.tmpExtent_),_=Qe(a.getTileSize(u[0]),this.tmpSize);const w=this.gutter_;w!==0&&(_=os(_,w,this.tmpSize),p=Lt(p,c*w,p)),o&&o!==s&&(c=gn(o,s,e,c),p=kl(p,s,o),e=ut(e,s,o));const v={SERVICE:"WMS",VERSION:St,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(v,this.params_,r);const E=Math.floor((e[0]-p[0])/c),x=Math.floor((p[3]-e[1])/c);return v[this.v13_?"I":"X"]=E,v[this.v13_?"J":"Y"]=x,this.getRequestUrl_(u,_,p,1,o||s,v)}getLegendUrl(e,t){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:St,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(t===void 0||t.LAYER===void 0){const r=this.params_.LAYERS;if(!(!Array.isArray(r)||r.length===1))return;i.LAYER=r}if(e!==void 0){const r=this.getProjection()?this.getProjection().getMetersPerUnit():1,s=28e-5;i.SCALE=e*r/s}return Object.assign(i,t),gt(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(e,t,i,r,s,o){const a=this.urls;if(!a)return;if(o.WIDTH=t[0],o.HEIGHT=t[1],o[this.v13_?"CRS":"SRS"]=s.getCode(),"STYLES"in this.params_||(o.STYLES=""),r!=1)switch(this.serverType_){case"geoserver":const p=90*r+.5|0;"FORMAT_OPTIONS"in o?o.FORMAT_OPTIONS+=";dpi:"+p:o.FORMAT_OPTIONS="dpi:"+p;break;case"mapserver":o.MAP_RESOLUTION=90*r;break;case"carmentaserver":case"qgis":o.DPI=90*r;break;default:De(!1,52);break}const l=s.getAxisOrientation(),u=i;if(this.v13_&&l.substr(0,2)=="ne"){let p;p=i[0],u[0]=i[1],u[1]=p,p=i[2],u[2]=i[3],u[3]=p}o.BBOX=u.join(",");let c;if(a.length==1)c=a[0];else{const p=lo(Po(e),a.length);c=a[p]}return gt(c,o)}getTilePixelRatio(e){return!this.hidpi_||this.serverType_===void 0?1:e}getKeyForParams_(){let e=0;const t=[];for(const i in this.params_)t[e++]=i+"-"+this.params_[i];return t.join("/")}updateParams(e){Object.assign(this.params_,e),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const e=this.params_.VERSION||St;this.v13_=oo(e,"1.3")>=0}tileUrlFunction(e,t,i){let r=this.getTileGrid();if(r||(r=this.getTileGridForProjection(i)),r.getResolutions().length<=e[0])return;t!=1&&(!this.hidpi_||this.serverType_===void 0)&&(t=1);const s=r.getResolution(e[0]);let o=r.getTileCoordExtent(e,this.tmpExtent_),a=Qe(r.getTileSize(e[0]),this.tmpSize);const l=this.gutter_;l!==0&&(a=os(a,l,this.tmpSize),o=Lt(o,s*l,o)),t!=1&&(a=co(a,t,this.tmpSize));const u={SERVICE:"WMS",VERSION:St,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Object.assign(u,this.params_),this.getRequestUrl_(e,a,o,t,i,u)}}const Qd=Object.freeze(Object.defineProperty({__proto__:null,default:ua},Symbol.toStringTag,{value:"Module"}));class Jd extends ar{constructor(e,t,i,r,s,o){super(e,t),this.src_=i,this.extent_=r,this.preemptive_=s,this.grid_=null,this.keys_=null,this.data_=null,this.jsonp_=o}getImage(){return null}getData(e){if(!this.grid_||!this.keys_)return null;const t=(e[0]-this.extent_[0])/(this.extent_[2]-this.extent_[0]),i=(e[1]-this.extent_[1])/(this.extent_[3]-this.extent_[1]),r=this.grid_[Math.floor((1-i)*this.grid_.length)];if(typeof r!="string")return null;let s=r.charCodeAt(Math.floor(t*r.length));s>=93&&s--,s>=35&&s--,s-=32;let o=null;if(s in this.keys_){const a=this.keys_[s];this.data_&&a in this.data_?o=this.data_[a]:o=a}return o}forDataAtCoordinate(e,t,i){this.state==Z.EMPTY&&i===!0?(this.state=Z.IDLE,uo(this,Ke.CHANGE,function(r){t(this.getData(e))},this),this.loadInternal_()):i===!0?setTimeout(()=>{t(this.getData(e))},0):t(this.getData(e))}getKey(){return this.src_}handleError_(){this.state=Z.ERROR,this.changed()}handleLoad_(e){this.grid_=e.grid,this.keys_=e.keys,this.data_=e.data,this.state=Z.LOADED,this.changed()}loadInternal_(){if(this.state==Z.IDLE)if(this.state=Z.LOADING,this.jsonp_)ur(this.src_,this.handleLoad_.bind(this),this.handleError_.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",this.src_),e.send()}}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleError_();return}this.handleLoad_(i)}else this.handleError_()}onXHRError_(e){this.handleError_()}load(){this.preemptive_?this.loadInternal_():this.setState(Z.EMPTY)}}class ef extends lr{constructor(e){if(super({projection:Se("EPSG:3857"),state:"loading",zDirection:e.zDirection}),this.preemptive_=e.preemptive!==void 0?e.preemptive:!0,this.tileUrlFunction_=kc,this.template_=void 0,this.jsonp_=e.jsonp||!1,e.url)if(this.jsonp_)ur(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else e.tileJSON?this.handleTileJSONResponse(e.tileJSON):De(!1,51)}onXHRLoad_(e){const t=e.target;if(!t.status||t.status>=200&&t.status<300){let i;try{i=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(i)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTemplate(){return this.template_}forDataAtCoordinateAndResolution(e,t,i,r){if(this.tileGrid){const s=this.tileGrid.getZForResolution(t,this.zDirection),o=this.tileGrid.getTileCoordForCoordAndZ(e,s);this.getTile(o[0],o[1],o[2],1,this.getProjection()).forDataAtCoordinate(e,i,r)}else r===!0?setTimeout(function(){i(null)},0):i(null)}handleTileJSONError(){this.setState("error")}handleTileJSONResponse(e){const t=Se("EPSG:4326"),i=this.getProjection();let r;if(e.bounds!==void 0){const c=Yt(t,i);r=on(e.bounds,c)}const s=Ei(i),o=e.minzoom||0,a=e.maxzoom||22,l=Ti({extent:s,maxZoom:a,minZoom:o});this.tileGrid=l,this.template_=e.template;const u=e.grids;if(!u){this.setState("error");return}if(this.tileUrlFunction_=Io(u,l),e.attribution!==void 0){const c=r!==void 0?r:s;this.setAttributions(function(p){return Xe(c,p.extent)?[e.attribution]:null})}this.setState("ready")}getTile(e,t,i,r,s){const o=wi(e,t,i);if(this.tileCache.containsKey(o))return this.tileCache.get(o);const a=[e,t,i],l=this.getTileCoordForTileUrlFunction(a,s),u=this.tileUrlFunction_(l,r,s),c=new Jd(a,u!==void 0?Z.IDLE:Z.EMPTY,u!==void 0?u:"",this.tileGrid.getTileCoordExtent(a),this.preemptive_,this.jsonp_);return this.tileCache.set(o,c),c}useTile(e,t,i){const r=wi(e,t,i);this.tileCache.containsKey(r)&&this.tileCache.get(r)}}const tf=ef;let rf=class extends ar{constructor(e,t,i,r,s,o){super(e,t,o),this.extent=null,this.format_=r,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=s,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==Z.IDLE&&(this.setState(Z.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(e,t){this.setFeatures(e)}onError(){this.setState(Z.ERROR)}setFeatures(e){this.features_=e,this.setState(Z.LOADED)}setLoader(e){this.loader_=e}};const nf=rf,bs=[];class sf extends ar{constructor(e,t,i,r){super(e,t,{transition:0}),this.context_={},this.executorGroups={},this.declutterExecutorGroups={},this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=r.bind(void 0,this),this.wrappedTileCoord=i}getContext(e){const t=Oe(e);return t in this.context_||(this.context_[t]=ft(1,1,bs)),this.context_[t]}hasContext(e){return Oe(e)in this.context_}getImage(e){return this.hasContext(e)?this.getContext(e).canvas:null}getReplayState(e){const t=Oe(e);return t in this.replayState_||(this.replayState_[t]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[t]}load(){this.getSourceTiles()}release(){for(const e in this.context_){const t=this.context_[e];Zr(t),bs.push(t.canvas),delete this.context_[e]}super.release()}}const of=sf;let ha=class extends bo{constructor(e){const t=e.projection||"EPSG:3857",i=e.extent||Ei(t),r=e.tileGrid||Ti({extent:i,maxResolution:e.maxResolution,maxZoom:e.maxZoom!==void 0?e.maxZoom:22,minZoom:e.minZoom,tileSize:e.tileSize||512});super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,interpolate:!0,opaque:!1,projection:t,state:e.state,tileGrid:r,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:da,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX===void 0?!0:e.wrapX,transition:e.transition,zDirection:e.zDirection===void 0?1:e.zDirection}),this.format_=e.format?e.format:null,this.sourceTileCache=new xo(this.tileCache.highWaterMark),this.overlaps_=e.overlaps==null?!0:e.overlaps,this.tileClass=e.tileClass?e.tileClass:nf,this.tileGrids_={}}getFeaturesInExtent(e){const t=[],i=this.tileCache;if(i.getCount()===0)return t;const r=Bc(i.peekFirstKey())[0],s=this.tileGrid;return i.forEach(function(o){if(o.tileCoord[0]!==r||o.getState()!==Z.LOADED)return;const a=o.getSourceTiles();for(let l=0,u=a.length;l<u;++l){const c=a[l],p=c.tileCoord;if(Xe(e,s.getTileCoordExtent(p))){const _=c.getFeatures();if(_)for(let w=0,v=_.length;w<v;++w){const E=_[w],x=E.getGeometry();Xe(e,x.getExtent())&&t.push(E)}}}}),t}getOverlaps(){return this.overlaps_}clear(){this.tileCache.clear(),this.sourceTileCache.clear()}expireCache(e,t){const i=this.getTileCacheForProjection(e),r=Object.keys(t).reduce((s,o)=>{const a=Uc(o),l=i.peek(a);if(l){const u=l.sourceTiles;for(let c=0,p=u.length;c<p;++c)s[u[c].getKey()]=!0}return s},{});super.expireCache(e,t),this.sourceTileCache.expireCache(r)}getSourceTiles(e,t,i){if(i.getState()===Z.IDLE){i.setState(Z.LOADING);const r=i.wrappedTileCoord,s=this.getTileGridForProjection(t),o=s.getTileCoordExtent(r),a=r[0],l=s.getResolution(a);Lt(o,-l,o);const u=this.tileGrid,c=u.getExtent();c&&ht(o,c,o);const p=u.getZForResolution(l,this.zDirection);u.forEachTileCoord(o,p,_=>{const w=this.tileUrlFunction(_,e,t),v=this.sourceTileCache.containsKey(w)?this.sourceTileCache.get(w):new this.tileClass(_,w?Z.IDLE:Z.EMPTY,w,this.format_,this.tileLoadFunction);i.sourceTiles.push(v);const E=v.getState();if(E<Z.LOADED){const x=L=>{this.handleTileChange(L);const P=v.getState();if(P===Z.LOADED||P===Z.ERROR){const b=v.getKey();b in i.errorTileKeys?v.getState()===Z.LOADED&&delete i.errorTileKeys[b]:i.loadingSourceTiles--,P===Z.ERROR?i.errorTileKeys[b]=!0:v.removeEventListener(Ke.CHANGE,x),i.loadingSourceTiles===0&&i.setState($l(i.errorTileKeys)?Z.LOADED:Z.ERROR)}};v.addEventListener(Ke.CHANGE,x),i.loadingSourceTiles++}E===Z.IDLE&&(v.extent=u.getTileCoordExtent(_),v.projection=t,v.resolution=u.getResolution(_[0]),this.sourceTileCache.set(w,v),v.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(_=>_.getState()===Z.ERROR)?Z.ERROR:Z.LOADED)}return i.sourceTiles}getTile(e,t,i,r,s){const o=wi(e,t,i),a=this.getKey();let l;if(this.tileCache.containsKey(o)&&(l=this.tileCache.get(o),l.key===a))return l;const u=[e,t,i];let c=this.getTileCoordForTileUrlFunction(u,s);const p=this.getTileGrid().getExtent(),_=this.getTileGridForProjection(s);if(c&&p){const E=_.getTileCoordExtent(c);Lt(E,-_.getResolution(e),E),Xe(p,E)||(c=null)}let w=!0;if(c!==null){const E=this.tileGrid,x=_.getResolution(e),L=E.getZForResolution(x,1),P=_.getTileCoordExtent(c);Lt(P,-x,P),E.forEachTileCoord(P,L,b=>{w=w&&!this.tileUrlFunction(b,r,s)})}const v=new of(u,w?Z.EMPTY:Z.IDLE,c,this.getSourceTiles.bind(this,r,s));return v.key=a,l?(v.interimTile=l,v.refreshInterimChain(),this.tileCache.replace(o,v)):this.tileCache.set(o,v),v}getTileGridForProjection(e){const t=e.getCode();let i=this.tileGrids_[t];if(!i){const r=this.tileGrid,s=r.getResolutions().slice(),o=s.map(function(u,c){return r.getOrigin(c)}),a=s.map(function(u,c){return r.getTileSize(c)}),l=Bl+1;for(let u=s.length;u<l;++u)s.push(s[u-1]/2),o.push(o[u-1]),a.push(a[u-1]);i=new cr({extent:r.getExtent(),origins:o,resolutions:s,tileSizes:a}),this.tileGrids_[t]=i}return i}getTilePixelRatio(e){return e}getTilePixelSize(e,t,i){const r=this.getTileGridForProjection(i),s=Qe(r.getTileSize(e),this.tmpSize);return[Math.round(s[0]*t),Math.round(s[1]*t)]}updateCacheSize(e,t){super.updateCacheSize(e*2,t),this.sourceTileCache.highWaterMark=this.getTileCacheForProjection(t).highWaterMark}};function da(n,e){n.setLoader(function(t,i,r){Ul(e,n.getFormat(),t,i,r,n.onLoad.bind(n),n.onError.bind(n))})}const af=Object.freeze(Object.defineProperty({__proto__:null,default:ha,defaultLoadFunction:da},Symbol.toStringTag,{value:"Module"}));class lf extends Et{constructor(e){const t=e.requestEncoding!==void 0?e.requestEncoding:"KVP",i=e.tileGrid;let r=e.urls;r===void 0&&e.url!==void 0&&(r=Ro(e.url)),super({attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:e.projection,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileClass:e.tileClass,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,urls:r,wrapX:e.wrapX!==void 0?e.wrapX:!1,transition:e.transition,zDirection:e.zDirection}),this.version_=e.version!==void 0?e.version:"1.0.0",this.format_=e.format!==void 0?e.format:"image/jpeg",this.dimensions_=e.dimensions!==void 0?e.dimensions:{},this.layer_=e.layer,this.matrixSet_=e.matrixSet,this.style_=e.style,this.requestEncoding_=t,this.setKey(this.getKeyForDimensions_()),r&&r.length>0&&(this.tileUrlFunction=qi(r.map(this.createFromWMTSTemplate.bind(this))))}setUrls(e){this.urls=e;const t=e.join(`
`);this.setTileUrlFunction(qi(e.map(this.createFromWMTSTemplate.bind(this))),t)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const e=this.urls?this.urls.slice(0):[];for(const t in this.dimensions_)e.push(t+"-"+this.dimensions_[t]);return e.join("/")}updateDimensions(e){Object.assign(this.dimensions_,e),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(e){const t=this.requestEncoding_,i={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};t=="KVP"&&Object.assign(i,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),e=t=="KVP"?gt(e,i):e.replace(/\{(\w+?)\}/g,function(o,a){return a.toLowerCase()in i?i[a.toLowerCase()]:o});const r=this.tileGrid,s=this.dimensions_;return function(o,a,l){if(!o)return;const u={TileMatrix:r.getMatrixId(o[0]),TileCol:o[1],TileRow:o[2]};Object.assign(u,s);let c=e;return t=="KVP"?c=gt(c,u):c=c.replace(/\{(\w+?)\}/g,function(p,_){return u[_]}),c}}}const cf=lf;function uf(n,e){const t=new $c(32),i=n.getExtent();return function(r,s){t.expireCache(),i&&(r=ht(i,r));const o=n.getZForResolution(s),a=[];return n.forEachTileCoord(r,o,l=>{const u=l.toString();if(!t.containsKey(u)){const c=e(l);t.set(u,c)}a.push(t.get(u))}),a}}const hf=Object.freeze(Object.defineProperty({__proto__:null,BingMaps:du,CartoDB:gu,Cluster:su,DataTile:Oo,GeoTIFF:cd,IIIF:fd,Image:mt,ImageArcGISRest:_d,ImageCanvas:Sd,ImageMapGuide:Td,ImageStatic:Tn,ImageWMS:Ji,OSM:Bi,Raster:Bd,Source:rr,Stamen:la,Tile:lr,TileArcGISRest:Hd,TileDebug:ca,TileImage:Et,TileJSON:Xd,TileWMS:ua,UTFGrid:tf,UrlTile:bo,Vector:Ae,VectorTile:ha,WMTS:cf,XYZ:xi,Zoomify:hd,sourcesFromTileGrid:uf},Symbol.toStringTag,{value:"Module"})),Nr="projection",Ls="coordinateFormat";class df extends ho{constructor(e){e=e||{};const t=document.createElement("div");t.className=e.className!==void 0?e.className:"ol-mouse-position",super({element:t,render:e.render,target:e.target}),this.on,this.once,this.un,this.addChangeListener(Nr,this.handleProjectionChanged_),e.coordinateFormat&&this.setCoordinateFormat(e.coordinateFormat),e.projection&&this.setProjection(e.projection),this.renderOnMouseOut_=e.placeholder!==void 0,this.placeholder_=this.renderOnMouseOut_?e.placeholder:"&#160;",this.renderedHTML_=t.innerHTML,this.mapProjection_=null,this.transform_=null,this.wrapX_=e.wrapX!==!1}handleProjectionChanged_(){this.transform_=null}getCoordinateFormat(){return this.get(Ls)}getProjection(){return this.get(Nr)}handleMouseMove(e){const t=this.getMap();this.updateHTML_(t.getEventPixel(e))}handleMouseOut(e){this.updateHTML_(null)}setMap(e){if(super.setMap(e),e){const t=e.getViewport();this.listenerKeys.push(Wt(t,as.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(Wt(t,as.POINTEROUT,this.handleMouseOut,this)),this.updateHTML_(null)}}setCoordinateFormat(e){this.set(Ls,e)}setProjection(e){this.set(Nr,Se(e))}updateHTML_(e){let t=this.placeholder_;if(e&&this.mapProjection_){if(!this.transform_){const s=this.getProjection();s?this.transform_=Yt(this.mapProjection_,s):this.transform_=Kl}const r=this.getMap().getCoordinateFromPixelInternal(e);if(r){const s=go();if(s&&(this.transform_=Yt(this.mapProjection_,s)),this.transform_(r,r),this.wrapX_){const a=s||this.getProjection()||this.mapProjection_;fo(r,a)}const o=this.getCoordinateFormat();o?t=o(r):t=r.toString()}}(!this.renderedHTML_||t!==this.renderedHTML_)&&(this.element.innerHTML=t,this.renderedHTML_=t)}render(e){const t=e.frameState;t?this.mapProjection_!=t.viewState.projection&&(this.mapProjection_=t.viewState.projection,this.transform_=null):this.mapProjection_=null}}const ff=df,Ne={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class gf extends Zl{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+ql,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Ne.ELEMENT,this.handleElementChanged),this.addChangeListener(Ne.MAP,this.handleMapChanged),this.addChangeListener(Ne.OFFSET,this.handleOffsetChanged),this.addChangeListener(Ne.POSITION,this.handlePositionChanged),this.addChangeListener(Ne.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(Ne.ELEMENT)}getId(){return this.id}getMap(){return this.get(Ne.MAP)||null}getOffset(){return this.get(Ne.OFFSET)}getPosition(){return this.get(Ne.POSITION)}getPositioning(){return this.get(Ne.POSITIONING)}handleElementChanged(){Hl(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(Yl(this.element),$i(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=Wt(e,mo.POSTRENDER,this.render,this),this.updatePixelPosition();const t=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?t.insertBefore(this.element,t.childNodes[0]||null):t.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(Ne.ELEMENT,e)}setMap(e){this.set(Ne.MAP,e)}setOffset(e){this.set(Ne.OFFSET,e)}setPosition(e){this.set(Ne.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const t=this.getMap();if(!t||!t.getTargetElement()||!this.get(Ne.POSITION))return;const i=this.getRect(t.getTargetElement(),t.getSize()),r=this.getElement(),s=this.getRect(r,[Wl(r),Xl(r)]);e=e||{};const o=e.margin===void 0?20:e.margin;if(!Ct(i,s)){const a=s[0]-i[0],l=i[2]-s[2],u=s[1]-i[1],c=i[3]-s[3],p=[0,0];if(a<0?p[0]=a-o:l<0&&(p[0]=Math.abs(l)+o),u<0?p[1]=u-o:c<0&&(p[1]=Math.abs(c)+o),p[0]!==0||p[1]!==0){const _=t.getView().getCenterInternal(),w=t.getPixelFromCoordinateInternal(_);if(!w)return;const v=[w[0]+p[0],w[1]+p[1]],E=e.animation||{};t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(v),duration:E.duration,easing:E.easing})}}}getRect(e,t){const i=e.getBoundingClientRect(),r=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[r,s,r+t[0],s+t[1]]}setPositioning(e){this.set(Ne.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),t=this.getPosition();if(!e||!e.isRendered()||!t){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(t),r=e.getSize();this.updateRenderedPosition(i,r)}updateRenderedPosition(e,t){const i=this.element.style,r=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=Math.round(e[0]+r[0])+"px",a=Math.round(e[1]+r[1])+"px";let l="0%",u="0%";s=="bottom-right"||s=="center-right"||s=="top-right"?l="-100%":(s=="bottom-center"||s=="center-center"||s=="top-center")&&(l="-50%"),s=="bottom-left"||s=="bottom-center"||s=="bottom-right"?u="-100%":(s=="center-left"||s=="center-center"||s=="center-right")&&(u="-50%");const c=`translate(${l}, ${u}) translate(${o}, ${a})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,i.transform=c)}getOptions(){return this.options}}const er=gf,mf=Object.freeze(Object.defineProperty({__proto__:null,default:er},Symbol.toStringTag,{value:"Module"})),Gr=.75,Gi=.1;class pf extends ho{constructor(e){e=e||{},super({element:document.createElement("div"),render:e.render,target:e.target}),this.boundHandleRotationChanged_=this.handleRotationChanged_.bind(this),this.collapsed_=e.collapsed!==void 0?e.collapsed:!0,this.collapsible_=e.collapsible!==void 0?e.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.rotateWithView_=e.rotateWithView!==void 0?e.rotateWithView:!1,this.viewExtent_=void 0;const t=e.className!==void 0?e.className:"ol-overviewmap",i=e.tipLabel!==void 0?e.tipLabel:"Overview map",r=e.collapseLabel!==void 0?e.collapseLabel:"‹";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r):this.collapseLabel_=r;const s=e.label!==void 0?e.label:"›";typeof s=="string"?(this.label_=document.createElement("span"),this.label_.textContent=s):this.label_=s;const o=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,a=document.createElement("button");a.setAttribute("type","button"),a.title=i,a.appendChild(o),a.addEventListener(Ke.CLICK,this.handleClick_.bind(this),!1),this.ovmapDiv_=document.createElement("div"),this.ovmapDiv_.className="ol-overviewmap-map",this.view_=e.view;const l=new Wr({view:e.view,controls:new ls,interactions:new ls});this.ovmap_=l,e.layers&&e.layers.forEach(function(P){l.addLayer(P)});const u=document.createElement("div");u.className="ol-overviewmap-box",u.style.boxSizing="border-box",this.boxOverlay_=new er({position:[0,0],positioning:"center-center",element:u}),this.ovmap_.addOverlay(this.boxOverlay_);const c=t+" "+Ql+" "+Jl+(this.collapsed_&&this.collapsible_?" "+cs:"")+(this.collapsible_?"":" ol-uncollapsible"),p=this.element;p.className=c,p.appendChild(this.ovmapDiv_),p.appendChild(a);const _=this,w=this.boxOverlay_,v=this.boxOverlay_.getElement(),E=function(P){return{clientX:P.clientX,clientY:P.clientY}},x=function(P){const b=E(P),O=l.getEventCoordinateInternal(b);w.setPosition(O)},L=function(P){const b=l.getEventCoordinateInternal(P);_.getMap().getView().setCenterInternal(b),window.removeEventListener("mousemove",x),window.removeEventListener("mouseup",L)};v.addEventListener("mousedown",function(){window.addEventListener("mousemove",x),window.addEventListener("mouseup",L)})}setMap(e){const t=this.getMap();if(e!==t){if(t){const i=t.getView();i&&this.unbindView_(i),this.ovmap_.setTarget(null)}if(super.setMap(e),e){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(Wt(e,ec.PROPERTYCHANGE,this.handleMapPropertyChange_,this));const i=e.getView();i&&(this.bindView_(i),i.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}}handleMapPropertyChange_(e){if(e.key===Tr.VIEW){const t=e.oldValue;t&&this.unbindView_(t);const i=this.getMap().getView();this.bindView_(i)}else!this.ovmap_.isRendered()&&(e.key===Tr.TARGET||e.key===Tr.SIZE)&&this.ovmap_.updateSize()}bindView_(e){if(!this.view_){const t=new fi({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(us.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()}unbindView_(e){e.removeChangeListener(us.ROTATION,this.boundHandleRotationChanged_)}handleRotationChanged_(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())}validateExtent_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),s=e.getView().calculateExtentInternal(i);if(this.viewExtent_&&yi(s,this.viewExtent_))return;this.viewExtent_=s;const o=t.getSize(),l=t.getView().calculateExtentInternal(o),u=t.getPixelFromCoordinateInternal(an(s)),c=t.getPixelFromCoordinateInternal(tc(s)),p=Math.abs(u[0]-c[0]),_=Math.abs(u[1]-c[1]),w=o[0],v=o[1];p<w*Gi||_<v*Gi||p>w*Gr||_>v*Gr?this.resetExtent_():Ct(l,s)||this.recenter_()}resetExtent_(){const e=this.getMap(),t=this.ovmap_,i=e.getSize(),s=e.getView().calculateExtentInternal(i),o=t.getView(),a=Math.log(Gr/Gi)/Math.LN2,l=1/(Math.pow(2,a/2)*Gi);ln(s,l),o.fitInternal(ic(s))}recenter_(){const e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())}updateBox_(){const e=this.getMap(),t=this.ovmap_;if(!e.isRendered()||!t.isRendered())return;const i=e.getSize(),r=e.getView(),s=t.getView(),o=this.rotateWithView_?0:-r.getRotation(),a=this.boxOverlay_,l=this.boxOverlay_.getElement(),u=r.getCenterInternal(),c=r.getResolution(),p=s.getResolution(),_=i[0]*c/p,w=i[1]*c/p;if(a.setPosition(u),l){l.style.width=_+"px",l.style.height=w+"px";const v="rotate("+o+"rad)";l.style.transform=v}}updateBoxAfterOvmapIsRendered_(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=uo(this.ovmap_,mo.POSTRENDER,function(e){delete this.ovmapPostrenderKey_,this.updateBox_()},this))}handleClick_(e){e.preventDefault(),this.handleToggle_()}handleToggle_(){this.element.classList.toggle(cs),this.collapsed_?hs(this.collapseLabel_,this.label_):hs(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;const e=this.ovmap_;if(!this.collapsed_){if(e.isRendered()){this.viewExtent_=void 0,e.render();return}e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}}getCollapsible(){return this.collapsible_}setCollapsible(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())}setCollapsed(e){!this.collapsible_||this.collapsed_===e||this.handleToggle_()}getCollapsed(){return this.collapsed_}getRotateWithView(){return this.rotateWithView_}setRotateWithView(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,this.getMap().getView().getRotation()!==0&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))}getOverviewMap(){return this.ovmap_}render(e){this.validateExtent_(),this.updateBox_()}}const yf=pf,_f="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPtJREFUOE+l0jEuR0EQx/HP/wYIN6CiE5EQeioKLkBFuAKuQKi4AAUVPSER0VFxA4IjyMi+ZP+bt57ENC/z5rffnZnf9vwzepXzk5jCdKrf4wGPpb4NsI+tCvgA23mtBOxip2OqPYTuJ3LADG7/uJJZ3JWAY6xlgA9cpXwBQ1ntBOsl4AnjmegImyk/xEZWe8ZECfjEQCZaxkXKl3Ce1b4wWAIuEa02ER00y4pv3kGMtlgCwrqwMI+3lIwU/8PKsLTPhcivMdfhxA3mG03bQ4pbhyuQd/R1U3vKLxgtIK8YK8E1QOhOsZIOnGG1ravfAKHPXWidqgvQsU++AdIpJRH0u+lNAAAAAElFTkSuQmCC",tn="http://www.w3.org/2001/XMLSchema-instance";function re(n,e){return pa().createElementNS(n,e)}function Si(n,e){return fa(n,e,[]).join("")}function fa(n,e,t){if(n.nodeType==Node.CDATA_SECTION_NODE||n.nodeType==Node.TEXT_NODE)e?t.push(String(n.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(n.nodeValue);else{let i;for(i=n.firstChild;i;i=i.nextSibling)fa(i,e,t)}return t}function $t(n){return"documentElement"in n}function wf(n,e,t){return n.getAttributeNS(e,t)||""}function Kt(n){return new DOMParser().parseFromString(n,"application/xml")}function ga(n,e){return function(t,i){const r=n.call(e!==void 0?e:this,t,i);if(r!==void 0){const s=i[i.length-1];Xt(s,r)}}}function te(n,e){return function(t,i){const r=n.call(e!==void 0?e:this,t,i);r!==void 0&&i[i.length-1].push(r)}}function X(n,e){return function(t,i){const r=n.call(e!==void 0?e:this,t,i);r!==void 0&&(i[i.length-1]=r)}}function Ye(n,e,t){return function(i,r){const s=n.call(t!==void 0?t:this,i,r);if(s!==void 0){const o=r[r.length-1],a=e!==void 0?e:i.localName;o[a]=s}}}function A(n,e){return function(t,i,r){n.call(e!==void 0?e:this,t,i,r),r[r.length-1].node.appendChild(t)}}function Ue(n,e){return function(t,i,r){const o=i[i.length-1].node;let a=n;a===void 0&&(a=r);const l=e!==void 0?e:o.namespaceURI;return re(l,a)}}const ma=Ue();function At(n,e,t,i){let r;for(r=e.firstElementChild;r;r=r.nextElementSibling){const s=n[r.namespaceURI];if(s!==void 0){const o=s[r.localName];o!==void 0&&o.call(i,r,t)}}}function me(n,e,t,i,r){return i.push(n),At(e,t,i,r),i.pop()}function vf(n,e,t,i,r,s){const o=(r!==void 0?r:t).length;let a,l;for(let u=0;u<o;++u)a=t[u],a!==void 0&&(l=e.call(s!==void 0?s:this,a,i,r!==void 0?r[u]:void 0),l!==void 0&&n[l.namespaceURI][l.localName].call(s,l,a,i))}function Te(n,e,t,i,r,s,o){return r.push(n),vf(e,t,i,r,s,o),r.pop()}let Dr;function Sf(){return Dr===void 0&&typeof XMLSerializer<"u"&&(Dr=new XMLSerializer),Dr}let zr;function pa(){return zr===void 0&&typeof document<"u"&&(zr=document.implementation.createDocument("","",null)),zr}class Cf extends po{constructor(){super(),this.xmlSerializer_=Sf()}getType(){return"xml"}readFeature(e,t){if(e){if(typeof e=="string"){const i=Kt(e);return this.readFeatureFromDocument(i,t)}else if($t(e))return this.readFeatureFromDocument(e,t)}else return null;return this.readFeatureFromNode(e,t)}readFeatureFromDocument(e,t){const i=this.readFeaturesFromDocument(e,t);return i.length>0?i[0]:null}readFeatureFromNode(e,t){return null}readFeatures(e,t){if(e){if(typeof e=="string"){const i=Kt(e);return this.readFeaturesFromDocument(i,t)}else if($t(e))return this.readFeaturesFromDocument(e,t)}else return[];return this.readFeaturesFromNode(e,t)}readFeaturesFromDocument(e,t){const i=[];for(let r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&Xt(i,this.readFeaturesFromNode(r,t));return i}readFeaturesFromNode(e,t){return so()}readGeometry(e,t){if(e){if(typeof e=="string"){const i=Kt(e);return this.readGeometryFromDocument(i,t)}else if($t(e))return this.readGeometryFromDocument(e,t)}else return null;return this.readGeometryFromNode(e,t)}readGeometryFromDocument(e,t){return null}readGeometryFromNode(e,t){return null}readProjection(e){if(e){if(typeof e=="string"){const t=Kt(e);return this.readProjectionFromDocument(t)}else if($t(e))return this.readProjectionFromDocument(e)}else return null;return this.readProjectionFromNode(e)}readProjectionFromDocument(e){return this.dataProjection}readProjectionFromNode(e){return this.dataProjection}writeFeature(e,t){const i=this.writeFeatureNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeFeatureNode(e,t){return null}writeFeatures(e,t){const i=this.writeFeaturesNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeFeaturesNode(e,t){return null}writeGeometry(e,t){const i=this.writeGeometryNode(e,t);return this.xmlSerializer_.serializeToString(i)}writeGeometryNode(e,t){return null}}const ya=Cf,dt="http://www.opengis.net/gml",Ef=/^\s*$/;class xe extends ya{constructor(e){super(),e=e||{},this.featureType=e.featureType,this.featureNS=e.featureNS,this.srsName=e.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:te(this.readFeaturesInternal),featureMembers:X(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(e,t){const i=e.localName;let r=null;if(i=="FeatureCollection")r=me([],this.FEATURE_COLLECTION_PARSERS,e,t,this);else if(i=="featureMembers"||i=="featureMember"||i=="member"){const s=t[0];let o=s.featureType,a=s.featureNS;const l="p",u="p0";if(!o&&e.childNodes){o=[],a={};for(let _=0,w=e.childNodes.length;_<w;++_){const v=e.childNodes[_];if(v.nodeType===1){const E=v.nodeName.split(":").pop();if(!o.includes(E)){let x="",L=0;const P=v.namespaceURI;for(const b in a){if(a[b]===P){x=b;break}++L}x||(x=l+L,a[x]=P),o.push(x+":"+E)}}}i!="featureMember"&&(s.featureType=o,s.featureNS=a)}if(typeof a=="string"){const _=a;a={},a[u]=_}const c={},p=Array.isArray(o)?o:[o];for(const _ in a){const w={};for(let v=0,E=p.length;v<E;++v)(p[v].includes(":")?p[v].split(":")[0]:u)===_&&(w[p[v].split(":").pop()]=i=="featureMembers"?te(this.readFeatureElement,this):X(this.readFeatureElement,this));c[a[_]]=w}i=="featureMember"||i=="member"?r=me(void 0,c,e,t):r=me([],c,e,t)}return r===null&&(r=[]),r}readGeometryOrExtent(e,t){const i=t[0];return i.srsName=e.firstElementChild.getAttribute("srsName"),i.srsDimension=e.firstElementChild.getAttribute("srsDimension"),me(null,this.GEOMETRY_PARSERS,e,t,this)}readExtentElement(e,t){const i=t[0],r=this.readGeometryOrExtent(e,t);return r?un(r,i):void 0}readGeometryElement(e,t){const i=t[0],r=this.readGeometryOrExtent(e,t);return r?sr(r,!1,i):void 0}readFeatureElementInternal(e,t,i){let r;const s={};for(let l=e.firstElementChild;l;l=l.nextElementSibling){let u;const c=l.localName;l.childNodes.length===0||l.childNodes.length===1&&(l.firstChild.nodeType===3||l.firstChild.nodeType===4)?(u=Si(l,!1),Ef.test(u)&&(u=void 0)):(i&&(u=c==="boundedBy"?this.readExtentElement(l,t):this.readGeometryElement(l,t)),u?c!=="boundedBy"&&(r=c):u=this.readFeatureElementInternal(l,t,!1));const p=l.attributes.length;if(p>0){u={_content_:u};for(let _=0;_<p;_++){const w=l.attributes[_].name;u[w]=l.attributes[_].value}}s[c]?(s[c]instanceof Array||(s[c]=[s[c]]),s[c].push(u)):s[c]=u}if(!i)return s;const o=new nt(s);r&&o.setGeometryName(r);const a=e.getAttribute("fid")||wf(e,this.namespace,"id");return a&&o.setId(a),o}readFeatureElement(e,t){return this.readFeatureElementInternal(e,t,!0)}readPoint(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new He(i,"XYZ")}readMultiPoint(e,t){const i=me([],this.MULTIPOINT_PARSERS,e,t,this);if(i)return new yo(i)}readMultiLineString(e,t){const i=me([],this.MULTILINESTRING_PARSERS,e,t,this);if(i)return new hn(i)}readMultiPolygon(e,t){const i=me([],this.MULTIPOLYGON_PARSERS,e,t,this);if(i)return new dn(i)}pointMemberParser(e,t){At(this.POINTMEMBER_PARSERS,e,t,this)}lineStringMemberParser(e,t){At(this.LINESTRINGMEMBER_PARSERS,e,t,this)}polygonMemberParser(e,t){At(this.POLYGONMEMBER_PARSERS,e,t,this)}readLineString(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new fn(i,"XYZ")}readFlatLinearRing(e,t){const i=me(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this);if(i)return i}readLinearRing(e,t){const i=this.readFlatCoordinatesFromNode(e,t);if(i)return new rc(i,"XYZ")}readPolygon(e,t){const i=me([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this);if(i&&i[0]){const r=i[0],s=[r.length];let o,a;for(o=1,a=i.length;o<a;++o)Xt(r,i[o]),s.push(r.length);return new or(r,"XYZ",s)}}readFlatCoordinatesFromNode(e,t){return me(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}readGeometryFromNode(e,t){const i=this.readGeometryElement(e,[this.getReadOptions(e,t||{})]);return i||null}readFeaturesFromNode(e,t){const i={featureType:this.featureType,featureNS:this.featureNS};return i&&Object.assign(i,this.getReadOptions(e,t)),this.readFeaturesInternal(e,[i])||[]}readProjectionFromNode(e){return Se(this.srsName?this.srsName:e.firstElementChild.getAttribute("srsName"))}}xe.prototype.namespace=dt;xe.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}};xe.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}};xe.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}};xe.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:te(xe.prototype.pointMemberParser),pointMembers:te(xe.prototype.pointMemberParser)}};xe.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:te(xe.prototype.lineStringMemberParser),lineStringMembers:te(xe.prototype.lineStringMemberParser)}};xe.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:te(xe.prototype.polygonMemberParser),polygonMembers:te(xe.prototype.polygonMemberParser)}};xe.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:te(xe.prototype.readFlatCoordinatesFromNode)}};xe.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:te(xe.prototype.readLineString)}};xe.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:te(xe.prototype.readPolygon)}};xe.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:X(xe.prototype.readFlatLinearRing)}};const se=xe;function Vt(n){const e=Si(n,!1);return Zt(e)}function Zt(n){const e=/^\s*(\d+)\s*$/.exec(n);if(e)return parseInt(e[1],10)}function be(n,e){n.appendChild(pa().createTextNode(e))}const Tf=dt+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",xf={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class le extends se{constructor(e){e=e||{},super(e),this.FEATURE_COLLECTION_PARSERS[dt].featureMember=te(this.readFeaturesInternal),this.schemaLocation=e.schemaLocation?e.schemaLocation:Tf}readFlatCoordinates(e,t){const i=Si(e,!1).replace(/^\s*|\s*$/g,""),s=t[0].srsName;let o="enu";if(s){const u=Se(s);u&&(o=u.getAxisOrientation())}const a=i.trim().split(/\s+/),l=[];for(let u=0,c=a.length;u<c;u++){const p=a[u].split(/,+/),_=parseFloat(p[0]),w=parseFloat(p[1]),v=p.length===3?parseFloat(p[2]):0;o.substr(0,2)==="en"?l.push(_,w,v):l.push(w,_,v)}return l}readBox(e,t){const i=me([null],this.BOX_PARSERS_,e,t,this);return _o(i[1][0],i[1][1],i[1][3],i[1][4])}innerBoundaryIsParser(e,t){const i=me(void 0,this.RING_PARSERS,e,t,this);i&&t[t.length-1].push(i)}outerBoundaryIsParser(e,t){const i=me(void 0,this.RING_PARSERS,e,t,this);if(i){const r=t[t.length-1];r[0]=i}}GEOMETRY_NODE_FACTORY_(e,t,i){const r=t[t.length-1],s=r.multiSurface,o=r.surface,a=r.multiCurve;return Array.isArray(e)?i="Envelope":(i=e.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="MultiLineString"&&a===!0&&(i="MultiCurve")),re("http://www.opengis.net/gml",i)}writeFeatureElement(e,t,i){const r=t.getId();r&&e.setAttribute("fid",r);const s=i[i.length-1],o=s.featureNS,a=t.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],u=[];if(t.hasProperties()){const p=t.getProperties();for(const _ in p){const w=p[_];w!==null&&(l.push(_),u.push(w),_==a||typeof w.getSimplifiedGeometry=="function"?_ in s.serializers[o]||(s.serializers[o][_]=A(this.writeGeometryElement,this)):_ in s.serializers[o]||(s.serializers[o][_]=A(be)))}}const c=Object.assign({},s);c.node=e,Te(c,s.serializers,Ue(void 0,o),u,i,l)}writeCurveOrLineString(e,t,i){const s=i[i.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&s&&e.setAttribute("srsName",s),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const o=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(o),this.writeCoordinates_(o,t,i)}else if(e.nodeName==="Curve"){const o=re(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,i)}}writeLineStringOrCurveMember(e,t,i){const r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(e.appendChild(r),this.writeCurveOrLineString(r,t,i))}writeMultiCurveOrLineString(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName,a=r.curve;o&&e.setAttribute("srsName",o);const l=t.getLineStrings();Te({node:e,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeGeometryElement(e,t,i){const r=i[i.length-1],s=Object.assign({},r);s.node=e;let o;Array.isArray(t)?o=un(t,r):o=sr(t,!0,r),Te(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}createCoordinatesNode_(e){const t=re(e,"coordinates");return t.setAttribute("decimal","."),t.setAttribute("cs",","),t.setAttribute("ts"," "),t}writeCoordinates_(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName,a=t.getCoordinates(),l=a.length,u=new Array(l);for(let c=0;c<l;++c){const p=a[c];u[c]=this.getCoords_(p,o,s)}be(e,u.join(" "))}writeCurveSegments_(e,t,i){const r=re(e.namespaceURI,"LineStringSegment");e.appendChild(r),this.writeCurveOrLineString(r,t,i)}writeSurfaceOrPolygon(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName;if(e.nodeName!=="PolygonPatch"&&o&&e.setAttribute("srsName",o),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();Te({node:e,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(e.nodeName==="Surface"){const a=re(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,i)}}RING_NODE_FACTORY_(e,t,i){const r=t[t.length-1],s=r.node,o=r.exteriorWritten;return o===void 0&&(r.exteriorWritten=!0),re(s.namespaceURI,o!==void 0?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(e,t,i){const r=re(e.namespaceURI,"PolygonPatch");e.appendChild(r),this.writeSurfaceOrPolygon(r,t,i)}writeRing(e,t,i){const r=re(e.namespaceURI,"LinearRing");e.appendChild(r),this.writeLinearRing(r,t,i)}getCoords_(e,t,i){let r="enu";t&&(r=Se(t).getAxisOrientation());let s=r.substr(0,2)==="en"?e[0]+","+e[1]:e[1]+","+e[0];if(i){const o=e[2]||0;s+=","+o}return s}writePoint(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName;o&&e.setAttribute("srsName",o);const a=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(a);const l=t.getCoordinates(),u=this.getCoords_(l,o,s);be(a,u)}writeMultiPoint(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName;o&&e.setAttribute("srsName",o);const a=t.getPoints();Te({node:e,hasZ:s,srsName:o},this.POINTMEMBER_SERIALIZERS,Ue("pointMember"),a,i,void 0,this)}writePointMember(e,t,i){const r=re(e.namespaceURI,"Point");e.appendChild(r),this.writePoint(r,t,i)}writeLinearRing(e,t,i){const s=i[i.length-1].srsName;s&&e.setAttribute("srsName",s);const o=this.createCoordinatesNode_(e.namespaceURI);e.appendChild(o),this.writeCoordinates_(o,t,i)}writeMultiSurfaceOrPolygon(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName,a=r.surface;o&&e.setAttribute("srsName",o);const l=t.getPolygons();Te({node:e,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeSurfaceOrPolygonMember(e,t,i){const r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(e.appendChild(r),this.writeSurfaceOrPolygon(r,t,i))}writeEnvelope(e,t,i){const s=i[i.length-1].srsName;s&&e.setAttribute("srsName",s);const o=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];Te({node:e},this.ENVELOPE_SERIALIZERS,ma,a,i,o,this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,i){const r=t[t.length-1].node;return re("http://www.opengis.net/gml",xf[r.nodeName])}}le.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:X(le.prototype.readFlatCoordinates)}};le.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:le.prototype.innerBoundaryIsParser,outerBoundaryIs:le.prototype.outerBoundaryIsParser}};le.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:te(le.prototype.readFlatCoordinates)}};le.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:X(se.prototype.readPoint),MultiPoint:X(se.prototype.readMultiPoint),LineString:X(se.prototype.readLineString),MultiLineString:X(se.prototype.readMultiLineString),LinearRing:X(se.prototype.readLinearRing),Polygon:X(se.prototype.readPolygon),MultiPolygon:X(se.prototype.readMultiPolygon),Box:X(le.prototype.readBox)}};le.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:A(le.prototype.writeCurveOrLineString),MultiCurve:A(le.prototype.writeMultiCurveOrLineString),Point:A(le.prototype.writePoint),MultiPoint:A(le.prototype.writeMultiPoint),LineString:A(le.prototype.writeCurveOrLineString),MultiLineString:A(le.prototype.writeMultiCurveOrLineString),LinearRing:A(le.prototype.writeLinearRing),Polygon:A(le.prototype.writeSurfaceOrPolygon),MultiPolygon:A(le.prototype.writeMultiSurfaceOrPolygon),Surface:A(le.prototype.writeSurfaceOrPolygon),MultiSurface:A(le.prototype.writeMultiSurfaceOrPolygon),Envelope:A(le.prototype.writeEnvelope)}};le.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:A(le.prototype.writeLineStringOrCurveMember),curveMember:A(le.prototype.writeLineStringOrCurveMember)}};le.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:A(le.prototype.writeRing),innerBoundaryIs:A(le.prototype.writeRing)}};le.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:A(le.prototype.writePointMember)}};le.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:A(le.prototype.writeSurfaceOrPolygonMember),polygonMember:A(le.prototype.writeSurfaceOrPolygonMember)}};le.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:A(be),upperCorner:A(be)}};const bi=le,Rf=dt+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",Pf={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class q extends se{constructor(e){e=e||{},super(e),this.surface_=e.surface!==void 0?e.surface:!1,this.curve_=e.curve!==void 0?e.curve:!1,this.multiCurve_=e.multiCurve!==void 0?e.multiCurve:!0,this.multiSurface_=e.multiSurface!==void 0?e.multiSurface:!0,this.schemaLocation=e.schemaLocation?e.schemaLocation:Rf,this.hasZ=e.hasZ!==void 0?e.hasZ:!1}readMultiCurve(e,t){const i=me([],this.MULTICURVE_PARSERS,e,t,this);if(i)return new hn(i)}readFlatCurveRing(e,t){const i=me([],this.MULTICURVE_PARSERS,e,t,this),r=[];for(let s=0,o=i.length;s<o;++s)Xt(r,i[s].getFlatCoordinates());return r}readMultiSurface(e,t){const i=me([],this.MULTISURFACE_PARSERS,e,t,this);if(i)return new dn(i)}curveMemberParser(e,t){At(this.CURVEMEMBER_PARSERS,e,t,this)}surfaceMemberParser(e,t){At(this.SURFACEMEMBER_PARSERS,e,t,this)}readPatch(e,t){return me([null],this.PATCHES_PARSERS,e,t,this)}readSegment(e,t){return me([],this.SEGMENTS_PARSERS,e,t,this)}readPolygonPatch(e,t){return me([null],this.FLAT_LINEAR_RINGS_PARSERS,e,t,this)}readLineStringSegment(e,t){return me([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,e,t,this)}interiorParser(e,t){const i=me(void 0,this.RING_PARSERS,e,t,this);i&&t[t.length-1].push(i)}exteriorParser(e,t){const i=me(void 0,this.RING_PARSERS,e,t,this);if(i){const r=t[t.length-1];r[0]=i}}readSurface(e,t){const i=me([null],this.SURFACE_PARSERS,e,t,this);if(i&&i[0]){const r=i[0],s=[r.length];let o,a;for(o=1,a=i.length;o<a;++o)Xt(r,i[o]),s.push(r.length);return new or(r,"XYZ",s)}}readCurve(e,t){const i=me([null],this.CURVE_PARSERS,e,t,this);if(i)return new fn(i,"XYZ")}readEnvelope(e,t){const i=me([null],this.ENVELOPE_PARSERS,e,t,this);return _o(i[1][0],i[1][1],i[2][0],i[2][1])}readFlatPos(e,t){let i=Si(e,!1);const r=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,s=[];let o;for(;o=r.exec(i);)s.push(parseFloat(o[1])),i=i.substr(o[0].length);if(i!=="")return;const l=t[0].srsName;let u="enu";if(l&&(u=Se(l).getAxisOrientation()),u==="neu"){let p,_;for(p=0,_=s.length;p<_;p+=3){const w=s[p],v=s[p+1];s[p]=v,s[p+1]=w}}const c=s.length;if(c==2&&s.push(0),c!==0)return s}readFlatPosList(e,t){const i=Si(e,!1).replace(/^\s*|\s*$/g,""),r=t[0],s=r.srsName,o=r.srsDimension;let a="enu";s&&(a=Se(s).getAxisOrientation());const l=i.split(/\s+/);let u=2;e.getAttribute("srsDimension")?u=Zt(e.getAttribute("srsDimension")):e.getAttribute("dimension")?u=Zt(e.getAttribute("dimension")):e.parentNode.getAttribute("srsDimension")?u=Zt(e.parentNode.getAttribute("srsDimension")):o&&(u=Zt(o));let c,p,_;const w=[];for(let v=0,E=l.length;v<E;v+=u)c=parseFloat(l[v]),p=parseFloat(l[v+1]),_=u===3?parseFloat(l[v+2]):0,a.substr(0,2)==="en"?w.push(c,p,_):w.push(p,c,_);return w}writePos_(e,t,i){const r=i[i.length-1],s=r.hasZ,o=s?"3":"2";e.setAttribute("srsDimension",o);const a=r.srsName;let l="enu";a&&(l=Se(a).getAxisOrientation());const u=t.getCoordinates();let c;if(l.substr(0,2)==="en"?c=u[0]+" "+u[1]:c=u[1]+" "+u[0],s){const p=u[2]||0;c+=" "+p}be(e,c)}getCoords_(e,t,i){let r="enu";t&&(r=Se(t).getAxisOrientation());let s=r.substr(0,2)==="en"?e[0]+" "+e[1]:e[1]+" "+e[0];if(i){const o=e[2]||0;s+=" "+o}return s}writePosList_(e,t,i){const r=i[i.length-1],s=r.hasZ,o=s?"3":"2";e.setAttribute("srsDimension",o);const a=r.srsName,l=t.getCoordinates(),u=l.length,c=new Array(u);let p;for(let _=0;_<u;++_)p=l[_],c[_]=this.getCoords_(p,a,s);be(e,c.join(" "))}writePoint(e,t,i){const s=i[i.length-1].srsName;s&&e.setAttribute("srsName",s);const o=re(e.namespaceURI,"pos");e.appendChild(o),this.writePos_(o,t,i)}writeEnvelope(e,t,i){const s=i[i.length-1].srsName;s&&e.setAttribute("srsName",s);const o=["lowerCorner","upperCorner"],a=[t[0]+" "+t[1],t[2]+" "+t[3]];Te({node:e},this.ENVELOPE_SERIALIZERS,ma,a,i,o,this)}writeLinearRing(e,t,i){const s=i[i.length-1].srsName;s&&e.setAttribute("srsName",s);const o=re(e.namespaceURI,"posList");e.appendChild(o),this.writePosList_(o,t,i)}RING_NODE_FACTORY_(e,t,i){const r=t[t.length-1],s=r.node,o=r.exteriorWritten;return o===void 0&&(r.exteriorWritten=!0),re(s.namespaceURI,o!==void 0?"interior":"exterior")}writeSurfaceOrPolygon(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName;if(e.nodeName!=="PolygonPatch"&&o&&e.setAttribute("srsName",o),e.nodeName==="Polygon"||e.nodeName==="PolygonPatch"){const a=t.getLinearRings();Te({node:e,hasZ:s,srsName:o},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,a,i,void 0,this)}else if(e.nodeName==="Surface"){const a=re(e.namespaceURI,"patches");e.appendChild(a),this.writeSurfacePatches_(a,t,i)}}writeCurveOrLineString(e,t,i){const s=i[i.length-1].srsName;if(e.nodeName!=="LineStringSegment"&&s&&e.setAttribute("srsName",s),e.nodeName==="LineString"||e.nodeName==="LineStringSegment"){const o=re(e.namespaceURI,"posList");e.appendChild(o),this.writePosList_(o,t,i)}else if(e.nodeName==="Curve"){const o=re(e.namespaceURI,"segments");e.appendChild(o),this.writeCurveSegments_(o,t,i)}}writeMultiSurfaceOrPolygon(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName,a=r.surface;o&&e.setAttribute("srsName",o);const l=t.getPolygons();Te({node:e,hasZ:s,srsName:o,surface:a},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeMultiPoint(e,t,i){const r=i[i.length-1],s=r.srsName,o=r.hasZ;s&&e.setAttribute("srsName",s);const a=t.getPoints();Te({node:e,hasZ:o,srsName:s},this.POINTMEMBER_SERIALIZERS,Ue("pointMember"),a,i,void 0,this)}writeMultiCurveOrLineString(e,t,i){const r=i[i.length-1],s=r.hasZ,o=r.srsName,a=r.curve;o&&e.setAttribute("srsName",o);const l=t.getLineStrings();Te({node:e,hasZ:s,srsName:o,curve:a},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,l,i,void 0,this)}writeRing(e,t,i){const r=re(e.namespaceURI,"LinearRing");e.appendChild(r),this.writeLinearRing(r,t,i)}writeSurfaceOrPolygonMember(e,t,i){const r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(e.appendChild(r),this.writeSurfaceOrPolygon(r,t,i))}writePointMember(e,t,i){const r=re(e.namespaceURI,"Point");e.appendChild(r),this.writePoint(r,t,i)}writeLineStringOrCurveMember(e,t,i){const r=this.GEOMETRY_NODE_FACTORY_(t,i);r&&(e.appendChild(r),this.writeCurveOrLineString(r,t,i))}writeSurfacePatches_(e,t,i){const r=re(e.namespaceURI,"PolygonPatch");e.appendChild(r),this.writeSurfaceOrPolygon(r,t,i)}writeCurveSegments_(e,t,i){const r=re(e.namespaceURI,"LineStringSegment");e.appendChild(r),this.writeCurveOrLineString(r,t,i)}writeGeometryElement(e,t,i){const r=i[i.length-1],s=Object.assign({},r);s.node=e;let o;Array.isArray(t)?o=un(t,r):o=sr(t,!0,r),Te(s,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[o],i,void 0,this)}writeFeatureElement(e,t,i){const r=t.getId();r&&e.setAttribute("fid",r);const s=i[i.length-1],o=s.featureNS,a=t.getGeometryName();s.serializers||(s.serializers={},s.serializers[o]={});const l=[],u=[];if(t.hasProperties()){const p=t.getProperties();for(const _ in p){const w=p[_];w!==null&&(l.push(_),u.push(w),_==a||typeof w.getSimplifiedGeometry=="function"?_ in s.serializers[o]||(s.serializers[o][_]=A(this.writeGeometryElement,this)):_ in s.serializers[o]||(s.serializers[o][_]=A(be)))}}const c=Object.assign({},s);c.node=e,Te(c,s.serializers,Ue(void 0,o),u,i,l)}writeFeatureMembers_(e,t,i){const r=i[i.length-1],s=r.featureType,o=r.featureNS,a={};a[o]={},a[o][s]=A(this.writeFeatureElement,this);const l=Object.assign({},r);l.node=e,Te(l,a,Ue(s,o),t,i)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(e,t,i){const r=t[t.length-1].node;return re(this.namespace,Pf[r.nodeName])}GEOMETRY_NODE_FACTORY_(e,t,i){const r=t[t.length-1],s=r.multiSurface,o=r.surface,a=r.curve,l=r.multiCurve;return Array.isArray(e)?i="Envelope":(i=e.getType(),i==="MultiPolygon"&&s===!0?i="MultiSurface":i==="Polygon"&&o===!0?i="Surface":i==="LineString"&&a===!0?i="Curve":i==="MultiLineString"&&l===!0&&(i="MultiCurve")),re(this.namespace,i)}writeGeometryNode(e,t){t=this.adaptOptions(t);const i=re(this.namespace,"geom"),r={node:i,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return t&&Object.assign(r,t),this.writeGeometryElement(i,e,[r]),i}writeFeaturesNode(e,t){t=this.adaptOptions(t);const i=re(this.namespace,"featureMembers");i.setAttributeNS(tn,"xsi:schemaLocation",this.schemaLocation);const r={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return t&&Object.assign(r,t),this.writeFeatureMembers_(i,e,[r]),i}}q.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:X(q.prototype.readFlatPos),posList:X(q.prototype.readFlatPosList),coordinates:X(bi.prototype.readFlatCoordinates)}};q.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:q.prototype.interiorParser,exterior:q.prototype.exteriorParser}};q.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:X(se.prototype.readPoint),MultiPoint:X(se.prototype.readMultiPoint),LineString:X(se.prototype.readLineString),MultiLineString:X(se.prototype.readMultiLineString),LinearRing:X(se.prototype.readLinearRing),Polygon:X(se.prototype.readPolygon),MultiPolygon:X(se.prototype.readMultiPolygon),Surface:X(q.prototype.readSurface),MultiSurface:X(q.prototype.readMultiSurface),Curve:X(q.prototype.readCurve),MultiCurve:X(q.prototype.readMultiCurve),Envelope:X(q.prototype.readEnvelope)}};q.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:te(q.prototype.curveMemberParser),curveMembers:te(q.prototype.curveMemberParser)}};q.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:te(q.prototype.surfaceMemberParser),surfaceMembers:te(q.prototype.surfaceMemberParser)}};q.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:te(se.prototype.readLineString),Curve:te(q.prototype.readCurve)}};q.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:te(se.prototype.readPolygon),Surface:te(q.prototype.readSurface)}};q.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:X(q.prototype.readPatch)}};q.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:X(q.prototype.readSegment)}};q.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:te(q.prototype.readFlatPosList),upperCorner:te(q.prototype.readFlatPosList)}};q.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:X(q.prototype.readPolygonPatch)}};q.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:ga(q.prototype.readLineStringSegment)}};se.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:X(se.prototype.readFlatLinearRing),Ring:X(q.prototype.readFlatCurveRing)}};q.prototype.writeFeatures;q.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:A(q.prototype.writeRing),interior:A(q.prototype.writeRing)}};q.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:A(be),upperCorner:A(be)}};q.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:A(q.prototype.writeSurfaceOrPolygonMember),polygonMember:A(q.prototype.writeSurfaceOrPolygonMember)}};q.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:A(q.prototype.writePointMember)}};q.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:A(q.prototype.writeLineStringOrCurveMember),curveMember:A(q.prototype.writeLineStringOrCurveMember)}};q.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:A(q.prototype.writeCurveOrLineString),MultiCurve:A(q.prototype.writeMultiCurveOrLineString),Point:A(q.prototype.writePoint),MultiPoint:A(q.prototype.writeMultiPoint),LineString:A(q.prototype.writeCurveOrLineString),MultiLineString:A(q.prototype.writeMultiCurveOrLineString),LinearRing:A(q.prototype.writeLinearRing),Polygon:A(q.prototype.writeSurfaceOrPolygon),MultiPolygon:A(q.prototype.writeMultiSurfaceOrPolygon),Surface:A(q.prototype.writeSurfaceOrPolygon),MultiSurface:A(q.prototype.writeMultiSurfaceOrPolygon),Envelope:A(q.prototype.writeEnvelope)}};const oe=q;class fe extends oe{constructor(e){e=e||{},super(e),this.schemaLocation=e.schemaLocation?e.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}}fe.prototype.namespace="http://www.opengis.net/gml/3.2";fe.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:X(oe.prototype.readFlatPos),posList:X(oe.prototype.readFlatPosList),coordinates:X(bi.prototype.readFlatCoordinates)}};fe.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:oe.prototype.interiorParser,exterior:oe.prototype.exteriorParser}};fe.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:X(se.prototype.readPoint),MultiPoint:X(se.prototype.readMultiPoint),LineString:X(se.prototype.readLineString),MultiLineString:X(se.prototype.readMultiLineString),LinearRing:X(se.prototype.readLinearRing),Polygon:X(se.prototype.readPolygon),MultiPolygon:X(se.prototype.readMultiPolygon),Surface:X(fe.prototype.readSurface),MultiSurface:X(oe.prototype.readMultiSurface),Curve:X(fe.prototype.readCurve),MultiCurve:X(oe.prototype.readMultiCurve),Envelope:X(fe.prototype.readEnvelope)}};fe.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:te(oe.prototype.curveMemberParser),curveMembers:te(oe.prototype.curveMemberParser)}};fe.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:te(oe.prototype.surfaceMemberParser),surfaceMembers:te(oe.prototype.surfaceMemberParser)}};fe.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:te(se.prototype.readLineString),Curve:te(oe.prototype.readCurve)}};fe.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:te(se.prototype.readPolygon),Surface:te(oe.prototype.readSurface)}};fe.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:X(oe.prototype.readPatch)}};fe.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:X(oe.prototype.readSegment)}};fe.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:te(oe.prototype.readFlatPosList),upperCorner:te(oe.prototype.readFlatPosList)}};fe.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:X(oe.prototype.readPolygonPatch)}};fe.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:ga(oe.prototype.readLineStringSegment)}};fe.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:te(se.prototype.pointMemberParser),pointMembers:te(se.prototype.pointMemberParser)}};fe.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:te(se.prototype.lineStringMemberParser),lineStringMembers:te(se.prototype.lineStringMemberParser)}};fe.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:te(se.prototype.polygonMemberParser),polygonMembers:te(se.prototype.polygonMemberParser)}};fe.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:te(se.prototype.readFlatCoordinatesFromNode)}};fe.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:te(se.prototype.readLineString)}};fe.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:te(se.prototype.readPolygon)}};fe.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:X(se.prototype.readFlatLinearRing),Ring:X(fe.prototype.readFlatCurveRing)}};fe.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:A(oe.prototype.writeRing),interior:A(oe.prototype.writeRing)}};fe.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:A(be),upperCorner:A(be)}};fe.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:A(oe.prototype.writeSurfaceOrPolygonMember),polygonMember:A(oe.prototype.writeSurfaceOrPolygonMember)}};fe.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:A(oe.prototype.writePointMember)}};fe.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:A(oe.prototype.writeLineStringOrCurveMember),curveMember:A(oe.prototype.writeLineStringOrCurveMember)}};fe.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:A(oe.prototype.writeCurveOrLineString),MultiCurve:A(oe.prototype.writeMultiCurveOrLineString),Point:A(fe.prototype.writePoint),MultiPoint:A(oe.prototype.writeMultiPoint),LineString:A(oe.prototype.writeCurveOrLineString),MultiLineString:A(oe.prototype.writeMultiCurveOrLineString),LinearRing:A(oe.prototype.writeLinearRing),Polygon:A(oe.prototype.writeSurfaceOrPolygon),MultiPolygon:A(oe.prototype.writeMultiSurfaceOrPolygon),Surface:A(oe.prototype.writeSurfaceOrPolygon),MultiSurface:A(oe.prototype.writeMultiSurfaceOrPolygon),Envelope:A(oe.prototype.writeEnvelope)}};const xn=fe;class If{constructor(e){this.tagName_=e}getTagName(){return this.tagName_}}const _a=If;class bf extends _a{constructor(e,t){super(e),this.conditions=t,De(this.conditions.length>=2,57)}}const Lf=bf;class Af extends Lf{constructor(e){super("And",Array.prototype.slice.call(arguments))}}const Of=Af;class Ff extends _a{constructor(e,t,i){if(super("BBOX"),this.geometryName=e,this.extent=t,t.length!==4)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=i}}const Mf=Ff;function Nf(n){const e=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(Of,e))}function Gf(n,e,t){return new Mf(n,e,t)}const As={"http://www.opengis.net/gml":{boundedBy:Ye(se.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:te(se.prototype.readFeaturesInternal)}},Df={"http://www.opengis.net/wfs":{totalInserted:Ye(Vt),totalUpdated:Ye(Vt),totalDeleted:Ye(Vt)},"http://www.opengis.net/wfs/2.0":{totalInserted:Ye(Vt),totalUpdated:Ye(Vt),totalDeleted:Ye(Vt)}},zf={"http://www.opengis.net/wfs":{TransactionSummary:Ye(Fs,"transactionSummary"),InsertResults:Ye(Ns,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:Ye(Fs,"transactionSummary"),InsertResults:Ye(Ns,"insertIds")}},Vf={"http://www.opengis.net/wfs":{PropertyName:A(be)},"http://www.opengis.net/wfs/2.0":{PropertyName:A(be)}},wa={"http://www.opengis.net/wfs":{Insert:A(Gs),Update:A(zs),Delete:A(Ds),Property:A(Vs),Native:A(js)},"http://www.opengis.net/wfs/2.0":{Insert:A(Gs),Update:A(zs),Delete:A(Ds),Property:A(Vs),Native:A(js)}},va="feature",Rn="http://www.w3.org/2000/xmlns/",Pn={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},rn={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},In={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},Os={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},bn={"2.0.0":xn,"1.1.0":oe,"1.0.0":bi},jf="1.1.0";class kf extends ya{constructor(e){super(),e=e||{},this.version_=e.version?e.version:jf,this.featureType_=e.featureType,this.featureNS_=e.featureNS,this.gmlFormat_=e.gmlFormat?e.gmlFormat:new bn[this.version_],this.schemaLocation_=e.schemaLocation?e.schemaLocation:Os[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(e){this.featureType_=e}readFeaturesFromNode(e,t){const i={node:e};Object.assign(i,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(i,this.getReadOptions(e,t||{}));const r=[i];let s;this.version_==="2.0.0"?s=As:s=this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let o=me([],s,e,r,this.gmlFormat_);return o||(o=[]),o}readTransactionResponse(e){if(e){if(typeof e=="string"){const t=Kt(e);return this.readTransactionResponseFromDocument(t)}else if($t(e))return this.readTransactionResponseFromDocument(e)}else return;return this.readTransactionResponseFromNode(e)}readFeatureCollectionMetadata(e){if(e){if(typeof e=="string"){const t=Kt(e);return this.readFeatureCollectionMetadataFromDocument(t)}else if($t(e))return this.readFeatureCollectionMetadataFromDocument(e)}else return;return this.readFeatureCollectionMetadataFromNode(e)}readFeatureCollectionMetadataFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(t)}readFeatureCollectionMetadataFromNode(e){const t={},i=Zt(e.getAttribute("numberOfFeatures"));return t.numberOfFeatures=i,me(t,As,e,[],this.gmlFormat_)}readTransactionResponseFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(t)}readTransactionResponseFromNode(e){return me({},zf,e,[])}writeGetFeature(e){const t=re(rn[this.version_],"GetFeature");t.setAttribute("service","WFS"),t.setAttribute("version",this.version_),e.handle&&t.setAttribute("handle",e.handle),e.outputFormat&&t.setAttribute("outputFormat",e.outputFormat),e.maxFeatures!==void 0&&t.setAttribute("maxFeatures",String(e.maxFeatures)),e.resultType&&t.setAttribute("resultType",e.resultType),e.startIndex!==void 0&&t.setAttribute("startIndex",String(e.startIndex)),e.count!==void 0&&t.setAttribute("count",String(e.count)),e.viewParams!==void 0&&t.setAttribute("viewParams",e.viewParams),t.setAttributeNS(tn,"xsi:schemaLocation",this.schemaLocation_);const i={node:t};if(Object.assign(i,{version:this.version_,srsName:e.srsName,featureNS:e.featureNS?e.featureNS:this.featureNS_,featurePrefix:e.featurePrefix,propertyNames:e.propertyNames?e.propertyNames:[]}),De(Array.isArray(e.featureTypes),11),typeof e.featureTypes[0]=="string"){let r=e.filter;e.bbox&&(De(e.geometryName,12),r=this.combineBboxAndFilter(e.geometryName,e.bbox,e.srsName,r)),Object.assign(i,{geometryName:e.geometryName,filter:r}),Ws(t,e.featureTypes,[i])}else e.featureTypes.forEach(r=>{const s=this.combineBboxAndFilter(r.geometryName,r.bbox,e.srsName,e.filter);Object.assign(i,{geometryName:r.geometryName,filter:s}),Ws(t,[r.name],[i])});return t}combineBboxAndFilter(e,t,i,r){const s=Gf(e,t,i);return r?Nf(r,s):s}writeTransaction(e,t,i,r){const s=[],o=r.version?r.version:this.version_,a=re(rn[o],"Transaction");a.setAttribute("service","WFS"),a.setAttribute("version",o);let l;r&&(l=r.gmlOptions?r.gmlOptions:{},r.handle&&a.setAttribute("handle",r.handle)),a.setAttributeNS(tn,"xsi:schemaLocation",Os[o]);const u=Bf(a,l,o,r);return e&&Di("Insert",e,s,u),t&&Di("Update",t,s,u),i&&Di("Delete",i,s,u),r.nativeElements&&Di("Native",r.nativeElements,s,u),a}readProjectionFromDocument(e){for(let t=e.firstChild;t;t=t.nextSibling)if(t.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(t);return null}readProjectionFromNode(e){if(e.firstElementChild&&e.firstElementChild.firstElementChild){e=e.firstElementChild.firstElementChild;for(let t=e.firstElementChild;t;t=t.nextElementSibling)if(!(t.childNodes.length===0||t.childNodes.length===1&&t.firstChild.nodeType===3)){const i=[{}];return this.gmlFormat_.readGeometryElement(t,i),Se(i.pop().srsName)}}return null}}function Bf(n,e,t,i){const r=i.featurePrefix?i.featurePrefix:va;let s;return t==="1.0.0"?s=2:t==="1.1.0"?s=3:t==="2.0.0"&&(s=3.2),Object.assign({node:n},{version:t,featureNS:i.featureNS,featureType:i.featureType,featurePrefix:r,gmlVersion:s,hasZ:i.hasZ,srsName:i.srsName},e)}function Di(n,e,t,i){Te(i,wa,Ue(n),e,t)}function Fs(n,e){return me({},Df,n,e)}const Uf={"http://www.opengis.net/ogc":{FeatureId:te(function(n,e){return n.getAttribute("fid")})},"http://www.opengis.net/ogc/1.1":{FeatureId:te(function(n,e){return n.getAttribute("fid")})}};function Ms(n,e){At(Uf,n,e)}const $f={"http://www.opengis.net/wfs":{Feature:Ms},"http://www.opengis.net/wfs/2.0":{Feature:Ms}};function Ns(n,e){return me([],$f,n,e)}function Gs(n,e,t){const i=t[t.length-1],r=i.featureType,s=i.featureNS,o=i.gmlVersion,a=re(s,r);n.appendChild(a),o===2?bi.prototype.writeFeatureElement(a,e,t):o===3?oe.prototype.writeFeatureElement(a,e,t):xn.prototype.writeFeatureElement(a,e,t)}function Sa(n,e,t){const r=t[t.length-1].version,s=Pn[r],o=re(s,"Filter"),a=re(s,"FeatureId");o.appendChild(a),a.setAttribute("fid",e),n.appendChild(o)}function Ln(n,e){n=n||va;const t=n+":";return e.startsWith(t)?e:t+e}function Ds(n,e,t){const i=t[t.length-1];De(e.getId()!==void 0,26);const r=i.featureType,s=i.featurePrefix,o=i.featureNS,a=Ln(s,r);n.setAttribute("typeName",a),n.setAttributeNS(Rn,"xmlns:"+s,o);const l=e.getId();l!==void 0&&Sa(n,l,t)}function zs(n,e,t){const i=t[t.length-1];De(e.getId()!==void 0,27);const r=i.version,s=i.featureType,o=i.featurePrefix,a=i.featureNS,l=Ln(o,s),u=e.getGeometryName();n.setAttribute("typeName",l),n.setAttributeNS(Rn,"xmlns:"+o,a);const c=e.getId();if(c!==void 0){const p=e.getKeys(),_=[];for(let w=0,v=p.length;w<v;w++){const E=e.get(p[w]);if(E!==void 0){let x=p[w];E&&typeof E.getSimplifiedGeometry=="function"&&(x=u),_.push({name:x,value:E})}}Te({version:r,gmlVersion:i.gmlVersion,node:n,hasZ:i.hasZ,srsName:i.srsName},wa,Ue("Property"),_,t),Sa(n,c,t)}}function Vs(n,e,t){const i=t[t.length-1],r=i.version,s=rn[r],o=re(s,"Name"),a=i.gmlVersion;if(n.appendChild(o),be(o,e.name),e.value!==void 0&&e.value!==null){const l=re(s,"Value");n.appendChild(l),e.value&&typeof e.value.getSimplifiedGeometry=="function"?a===2?bi.prototype.writeGeometryElement(l,e.value,t):a===3?oe.prototype.writeGeometryElement(l,e.value,t):xn.prototype.writeGeometryElement(l,e.value,t):be(l,e.value)}}function js(n,e,t){e.vendorId&&n.setAttribute("vendorId",e.vendorId),e.safeToIgnore!==void 0&&n.setAttribute("safeToIgnore",String(e.safeToIgnore)),e.value!==void 0&&be(n,e.value)}const dr={"http://www.opengis.net/wfs":{Query:A(ks)},"http://www.opengis.net/wfs/2.0":{Query:A(ks)},"http://www.opengis.net/ogc":{During:A($s),And:A(zi),Or:A(zi),Not:A(Ks),BBOX:A(Bs),Contains:A(wt),Intersects:A(wt),Within:A(wt),DWithin:A(Us),PropertyIsEqualTo:A($e),PropertyIsNotEqualTo:A($e),PropertyIsLessThan:A($e),PropertyIsLessThanOrEqualTo:A($e),PropertyIsGreaterThan:A($e),PropertyIsGreaterThanOrEqualTo:A($e),PropertyIsNull:A(Zs),PropertyIsBetween:A(qs),PropertyIsLike:A(Hs)},"http://www.opengis.net/fes/2.0":{During:A($s),And:A(zi),Or:A(zi),Not:A(Ks),BBOX:A(Bs),Contains:A(wt),Disjoint:A(wt),Intersects:A(wt),ResourceId:A(Zf),Within:A(wt),DWithin:A(Us),PropertyIsEqualTo:A($e),PropertyIsNotEqualTo:A($e),PropertyIsLessThan:A($e),PropertyIsLessThanOrEqualTo:A($e),PropertyIsGreaterThan:A($e),PropertyIsGreaterThanOrEqualTo:A($e),PropertyIsNull:A(Zs),PropertyIsBetween:A(qs),PropertyIsLike:A(Hs)}};function ks(n,e,t){const i=t[t.length-1],r=i.version,s=i.featurePrefix,o=i.featureNS,a=i.propertyNames,l=i.srsName;let u;s?u=Ln(s,e):u=e;let c;r==="2.0.0"?c="typeNames":c="typeName",n.setAttribute(c,u),l&&n.setAttribute("srsName",l),o&&n.setAttributeNS(Rn,"xmlns:"+s,o);const p=Object.assign({},i);p.node=n,Te(p,Vf,Ue("PropertyName"),a,t);const _=i.filter;if(_){const w=re(fr(r),"Filter");n.appendChild(w),Kf(w,_,t)}}function Kf(n,e,t){const i=t[t.length-1],r={node:n};Object.assign(r,{context:i}),Te(r,dr,Ue(e.getTagName()),[e],t)}function Bs(n,e,t){const i=t[t.length-1],s=i.context.version;i.srsName=e.srsName;const o=bn[s];ri(s,n,e.geometryName),o.prototype.writeGeometryElement(n,e.extent,t)}function Zf(n,e,t){n.setAttribute("rid",e.rid)}function wt(n,e,t){const i=t[t.length-1],s=i.context.version;i.srsName=e.srsName;const o=bn[s];ri(s,n,e.geometryName),o.prototype.writeGeometryElement(n,e.geometry,t)}function Us(n,e,t){const s=t[t.length-1].context.version;wt(n,e,t);const o=re(fr(s),"Distance");be(o,e.distance.toString()),s==="2.0.0"?o.setAttribute("uom",e.unit):o.setAttribute("units",e.unit),n.appendChild(o)}function $s(n,e,t){const s=t[t.length-1].context.version;tr(In[s],"ValueReference",n,e.propertyName);const o=re(dt,"TimePeriod");n.appendChild(o);const a=re(dt,"begin");o.appendChild(a),Ys(a,e.begin);const l=re(dt,"end");o.appendChild(l),Ys(l,e.end)}function zi(n,e,t){const r=t[t.length-1].context,s={node:n};Object.assign(s,{context:r});const o=e.conditions;for(let a=0,l=o.length;a<l;++a){const u=o[a];Te(s,dr,Ue(u.getTagName()),[u],t)}}function Ks(n,e,t){const r=t[t.length-1].context,s={node:n};Object.assign(s,{context:r});const o=e.condition;Te(s,dr,Ue(o.getTagName()),[o],t)}function $e(n,e,t){const s=t[t.length-1].context.version;e.matchCase!==void 0&&n.setAttribute("matchCase",e.matchCase.toString()),ri(s,n,e.propertyName),ir(s,n,""+e.expression)}function Zs(n,e,t){const s=t[t.length-1].context.version;ri(s,n,e.propertyName)}function qs(n,e,t){const s=t[t.length-1].context.version,o=fr(s);ri(s,n,e.propertyName);const a=re(o,"LowerBoundary");n.appendChild(a),ir(s,a,""+e.lowerBoundary);const l=re(o,"UpperBoundary");n.appendChild(l),ir(s,l,""+e.upperBoundary)}function Hs(n,e,t){const s=t[t.length-1].context.version;n.setAttribute("wildCard",e.wildCard),n.setAttribute("singleChar",e.singleChar),n.setAttribute("escapeChar",e.escapeChar),e.matchCase!==void 0&&n.setAttribute("matchCase",e.matchCase.toString()),ri(s,n,e.propertyName),ir(s,n,""+e.pattern)}function tr(n,e,t,i){const r=re(n,e);be(r,i),t.appendChild(r)}function ir(n,e,t){tr(fr(n),"Literal",e,t)}function ri(n,e,t){n==="2.0.0"?tr(In[n],"ValueReference",e,t):tr(Pn[n],"PropertyName",e,t)}function Ys(n,e){const t=re(dt,"TimeInstant");n.appendChild(t);const i=re(dt,"timePosition");t.appendChild(i),be(i,e)}function Ws(n,e,t){const i=t[t.length-1],r=Object.assign({},i);r.node=n,Te(r,dr,Ue("Query"),e,t)}function fr(n){let e;return n==="2.0.0"?e=In[n]:e=Pn[n],e}const qf=kf;var nn={},Hf={get exports(){return nn},set exports(n){nn=n}};const Yf=de(nc),Wf=de(sc),Xf=de(oc),Qf=de(Kc),Jf=de(Fd),eg=de(Rd),tg=de(Id),ig=de(Zc),rg=de(Qd),ng=de(af),sg=de(pd),og=de(hf);var An={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */An.read=function(n,e,t,i,r){var s,o,a=r*8-i-1,l=(1<<a)-1,u=l>>1,c=-7,p=t?r-1:0,_=t?-1:1,w=n[e+p];for(p+=_,s=w&(1<<-c)-1,w>>=-c,c+=a;c>0;s=s*256+n[e+p],p+=_,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=o*256+n[e+p],p+=_,c-=8);if(s===0)s=1-u;else{if(s===l)return o?NaN:(w?-1:1)*(1/0);o=o+Math.pow(2,i),s=s-u}return(w?-1:1)*o*Math.pow(2,s-i)};An.write=function(n,e,t,i,r,s){var o,a,l,u=s*8-r-1,c=(1<<u)-1,p=c>>1,_=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=i?0:s-1,v=i?1:-1,E=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+p>=1?e+=_/l:e+=_*Math.pow(2,1-p),e*l>=2&&(o++,l/=2),o+p>=c?(a=0,o=c):o+p>=1?(a=(e*l-1)*Math.pow(2,r),o=o+p):(a=e*Math.pow(2,p-1)*Math.pow(2,r),o=0));r>=8;n[t+w]=a&255,w+=v,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;n[t+w]=o&255,w+=v,o/=256,u-=8);n[t+w-v]|=E*128};var ag=ge,Vi=An;function ge(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}ge.Varint=0;ge.Fixed64=1;ge.Bytes=2;ge.Fixed32=5;var sn=(1<<16)*(1<<16),Xs=1/sn,lg=12,Ca=typeof TextDecoder>"u"?null:new TextDecoder("utf8");ge.prototype={destroy:function(){this.buf=null},readFields:function(n,e,t){for(t=t||this.length;this.pos<t;){var i=this.readVarint(),r=i>>3,s=this.pos;this.type=i&7,n(r,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=ji(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=Js(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=ji(this.buf,this.pos)+ji(this.buf,this.pos+4)*sn;return this.pos+=8,n},readSFixed64:function(){var n=ji(this.buf,this.pos)+Js(this.buf,this.pos+4)*sn;return this.pos+=8,n},readFloat:function(){var n=Vi.read(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=Vi.read(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e=this.buf,t,i;return i=e[this.pos++],t=i&127,i<128||(i=e[this.pos++],t|=(i&127)<<7,i<128)||(i=e[this.pos++],t|=(i&127)<<14,i<128)||(i=e[this.pos++],t|=(i&127)<<21,i<128)?t:(i=e[this.pos],t|=(i&15)<<28,cg(t,n,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2===1?(n+1)/-2:n/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=lg&&Ca?Eg(this.buf,e,n):Cg(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==ge.Bytes)return n.push(this.readVarint(e));var t=ct(this);for(n=n||[];this.pos<t;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==ge.Bytes)return n.push(this.readSVarint());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==ge.Bytes)return n.push(this.readBoolean());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==ge.Bytes)return n.push(this.readFloat());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==ge.Bytes)return n.push(this.readDouble());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==ge.Bytes)return n.push(this.readFixed32());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==ge.Bytes)return n.push(this.readSFixed32());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==ge.Bytes)return n.push(this.readFixed64());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==ge.Bytes)return n.push(this.readSFixed64());var e=ct(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=n&7;if(e===ge.Varint)for(;this.buf[this.pos++]>127;);else if(e===ge.Bytes)this.pos=this.readVarint()+this.pos;else if(e===ge.Fixed32)this.pos+=4;else if(e===ge.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var t=new Uint8Array(e);t.set(this.buf),this.buf=t,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),kt(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),kt(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),kt(this.buf,n&-1,this.pos),kt(this.buf,Math.floor(n*Xs),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),kt(this.buf,n&-1,this.pos),kt(this.buf,Math.floor(n*Xs),this.pos+4),this.pos+=8},writeVarint:function(n){if(n=+n||0,n>268435455||n<0){ug(n,this);return}this.realloc(4),this.buf[this.pos++]=n&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=n>>>7&127)))},writeSVarint:function(n){this.writeVarint(n<0?-n*2-1:n*2)},writeBoolean:function(n){this.writeVarint(Boolean(n))},writeString:function(n){n=String(n),this.realloc(n.length*4),this.pos++;var e=this.pos;this.pos=Tg(this.buf,n,this.pos);var t=this.pos-e;t>=128&&Qs(e,t,this),this.pos=e-1,this.writeVarint(t),this.pos+=t},writeFloat:function(n){this.realloc(4),Vi.write(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),Vi.write(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var t=0;t<e;t++)this.buf[this.pos++]=n[t]},writeRawMessage:function(n,e){this.pos++;var t=this.pos;n(e,this);var i=this.pos-t;i>=128&&Qs(t,i,this),this.pos=t-1,this.writeVarint(i),this.pos+=i},writeMessage:function(n,e,t){this.writeTag(n,ge.Bytes),this.writeRawMessage(e,t)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,fg,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,gg,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,yg,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,mg,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,pg,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,_g,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,wg,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,vg,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,Sg,e)},writeBytesField:function(n,e){this.writeTag(n,ge.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,ge.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,ge.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,ge.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,ge.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,ge.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,ge.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,ge.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,ge.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,ge.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,Boolean(e))}};function cg(n,e,t){var i=t.buf,r,s;if(s=i[t.pos++],r=(s&112)>>4,s<128||(s=i[t.pos++],r|=(s&127)<<3,s<128)||(s=i[t.pos++],r|=(s&127)<<10,s<128)||(s=i[t.pos++],r|=(s&127)<<17,s<128)||(s=i[t.pos++],r|=(s&127)<<24,s<128)||(s=i[t.pos++],r|=(s&1)<<31,s<128))return jt(n,r,e);throw new Error("Expected varint not more than 10 bytes")}function ct(n){return n.type===ge.Bytes?n.readVarint()+n.pos:n.pos+1}function jt(n,e,t){return t?e*4294967296+(n>>>0):(e>>>0)*4294967296+(n>>>0)}function ug(n,e){var t,i;if(n>=0?(t=n%4294967296|0,i=n/4294967296|0):(t=~(-n%4294967296),i=~(-n/4294967296),t^4294967295?t=t+1|0:(t=0,i=i+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),hg(t,i,e),dg(i,e)}function hg(n,e,t){t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos++]=n&127|128,n>>>=7,t.buf[t.pos]=n&127}function dg(n,e){var t=(n&7)<<4;e.buf[e.pos++]|=t|((n>>>=3)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127|((n>>>=7)?128:0),n&&(e.buf[e.pos++]=n&127)))))}function Qs(n,e,t){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));t.realloc(i);for(var r=t.pos-1;r>=n;r--)t.buf[r+i]=t.buf[r]}function fg(n,e){for(var t=0;t<n.length;t++)e.writeVarint(n[t])}function gg(n,e){for(var t=0;t<n.length;t++)e.writeSVarint(n[t])}function mg(n,e){for(var t=0;t<n.length;t++)e.writeFloat(n[t])}function pg(n,e){for(var t=0;t<n.length;t++)e.writeDouble(n[t])}function yg(n,e){for(var t=0;t<n.length;t++)e.writeBoolean(n[t])}function _g(n,e){for(var t=0;t<n.length;t++)e.writeFixed32(n[t])}function wg(n,e){for(var t=0;t<n.length;t++)e.writeSFixed32(n[t])}function vg(n,e){for(var t=0;t<n.length;t++)e.writeFixed64(n[t])}function Sg(n,e){for(var t=0;t<n.length;t++)e.writeSFixed64(n[t])}function ji(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+n[e+3]*16777216}function kt(n,e,t){n[t]=e,n[t+1]=e>>>8,n[t+2]=e>>>16,n[t+3]=e>>>24}function Js(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}function Cg(n,e,t){for(var i="",r=e;r<t;){var s=n[r],o=null,a=s>239?4:s>223?3:s>191?2:1;if(r+a>t)break;var l,u,c;a===1?s<128&&(o=s):a===2?(l=n[r+1],(l&192)===128&&(o=(s&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=n[r+1],u=n[r+2],(l&192)===128&&(u&192)===128&&(o=(s&15)<<12|(l&63)<<6|u&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=n[r+1],u=n[r+2],c=n[r+3],(l&192)===128&&(u&192)===128&&(c&192)===128&&(o=(s&15)<<18|(l&63)<<12|(u&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),r+=a}return i}function Eg(n,e,t){return Ca.decode(n.subarray(e,t))}function Tg(n,e,t){for(var i=0,r,s;i<e.length;i++){if(r=e.charCodeAt(i),r>55295&&r<57344)if(s)if(r<56320){n[t++]=239,n[t++]=191,n[t++]=189,s=r;continue}else r=s-55296<<10|r-56320|65536,s=null;else{r>56319||i+1===e.length?(n[t++]=239,n[t++]=191,n[t++]=189):s=r;continue}else s&&(n[t++]=239,n[t++]=191,n[t++]=189,s=null);r<128?n[t++]=r:(r<2048?n[t++]=r>>6|192:(r<65536?n[t++]=r>>12|224:(n[t++]=r>>18|240,n[t++]=r>>12&63|128),n[t++]=r>>6&63|128),n[t++]=r&63|128)}return t}const eo=_i();class Ci{constructor(e,t,i,r,s){this.styleFunction,this.extent_,this.id_=s,this.type_=e,this.flatCoordinates_=t,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i,this.properties_=r}get(e){return this.properties_[e]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?ac(this.flatCoordinates_):lc(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const e=Ot(this.getExtent());this.flatInteriorPoints_=cc(this.flatCoordinates_,0,this.ends_,2,e,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const e=uc(this.flatCoordinates_,0,this.ends_,2);this.flatInteriorPoints_=hc(this.flatCoordinates_,0,this.ends_,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ds(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const e=this.flatCoordinates_;let t=0;const i=this.ends_;for(let r=0,s=i.length;r<s;++r){const o=i[r],a=ds(e,t,o,2,.5);Xt(this.flatMidpoints_,a),t=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(e){return this}simplifyTransformed(e,t){return this}getProperties(){return this.properties_}getStride(){return 2}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(e){e=Se(e);const t=e.getExtent(),i=e.getWorldExtent();if(t&&i){const r=Ge(i)/Ge(t);Yr(eo,i[0],i[3],r,-r,0,0,0),dc(this.flatCoordinates_,0,this.flatCoordinates_.length,2,eo,this.flatCoordinates_)}}getEnds(){return this.ends_}}Ci.prototype.getEndss=Ci.prototype.getEnds;Ci.prototype.getFlatCoordinates=Ci.prototype.getOrientedFlatCoordinates;const to=Ci;class xg extends po{constructor(e){super(),e=e||{},this.dataProjection=new qr({code:"",units:"tile-pixels"}),this.featureClass_=e.featureClass?e.featureClass:to,this.geometryName_=e.geometryName,this.layerName_=e.layerName?e.layerName:"layer",this.layers_=e.layers?e.layers:null,this.idProperty_=e.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(e,t,i,r){e.pos=t.geometry;const s=e.readVarint()+e.pos;let o=1,a=0,l=0,u=0,c=0,p=0;for(;e.pos<s;){if(!a){const _=e.readVarint();o=_&7,a=_>>3}a--,o===1||o===2?(l+=e.readSVarint(),u+=e.readSVarint(),o===1&&c>p&&(r.push(c),p=c),i.push(l,u),c+=2):o===7?c>p&&(i.push(i[p],i[p+1]),c+=2):De(!1,59)}c>p&&(r.push(c),p=c)}createFeature_(e,t,i){const r=t.type;if(r===0)return null;let s;const o=t.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=t.id,o[this.layerName_]=t.layer.name;const l=[],u=[];this.readRawGeometry_(e,t,l,u);const c=Lg(r,u.length);if(this.featureClass_===to)s=new this.featureClass_(c,l,u,o,a),s.transform(i.dataProjection);else{let p;if(c=="Polygon"){const v=fc(l,u);p=v.length>1?new dn(l,"XY",v):new or(l,"XY",u)}else p=c==="Point"?new He(l,"XY"):c==="LineString"?new fn(l,"XY"):c==="MultiPoint"?new yo(l,"XY"):c==="MultiLineString"?new hn(l,"XY",u):null;const _=this.featureClass_;s=new _,this.geometryName_&&s.setGeometryName(this.geometryName_);const w=sr(p,!1,i);s.setGeometry(w),a!==void 0&&s.setId(a),s.setProperties(o,!0)}return s}getType(){return"arraybuffer"}readFeatures(e,t){const i=this.layers_;t=this.adaptOptions(t);const r=Se(t.dataProjection);r.setWorldExtent(t.extent),t.dataProjection=r;const s=new ag(e),o=s.readFields(Rg,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const u=o[l],c=u?[0,0,u.extent,u.extent]:null;r.setExtent(c);for(let p=0,_=u.length;p<_;++p){const w=bg(s,u,p),v=this.createFeature_(s,w,t);v!==null&&a.push(v)}}return a}readProjection(e){return this.dataProjection}setLayers(e){this.layers_=e}}function Rg(n,e,t){if(n===3){const i={keys:[],values:[],features:[]},r=t.readVarint()+t.pos;t.readFields(Pg,i,r),i.length=i.features.length,i.length&&(e[i.name]=i)}}function Pg(n,e,t){if(n===15)e.version=t.readVarint();else if(n===1)e.name=t.readString();else if(n===5)e.extent=t.readVarint();else if(n===2)e.features.push(t.pos);else if(n===3)e.keys.push(t.readString());else if(n===4){let i=null;const r=t.readVarint()+t.pos;for(;t.pos<r;)n=t.readVarint()>>3,i=n===1?t.readString():n===2?t.readFloat():n===3?t.readDouble():n===4?t.readVarint64():n===5?t.readVarint():n===6?t.readSVarint():n===7?t.readBoolean():null;e.values.push(i)}}function Ig(n,e,t){if(n==1)e.id=t.readVarint();else if(n==2){const i=t.readVarint()+t.pos;for(;t.pos<i;){const r=e.layer.keys[t.readVarint()],s=e.layer.values[t.readVarint()];e.properties[r]=s}}else n==3?e.type=t.readVarint():n==4&&(e.geometry=t.pos)}function bg(n,e,t){n.pos=e.features[t];const i=n.readVarint()+n.pos,r={layer:e,type:0,properties:{}};return n.readFields(Ig,r,i),r}function Lg(n,e){let t;return n===1?t=e===1?"Point":"MultiPoint":n===2?t=e===1?"LineString":"MultiLineString":n===3&&(t="Polygon"),t}const Ag=Object.freeze(Object.defineProperty({__proto__:null,default:xg},Symbol.toStringTag,{value:"Module"})),Og=de(Ag),Fg=de(gc),Mg=de(mc);function Ng(n,e){const t=n.canvas;e=e||{};const i=e.pixelRatio||pc,r=e.size;r&&(t.width=r[0]*i,t.height=r[1]*i,t.style.width=r[0]+"px",t.style.height=r[1]+"px");const s=[0,0,t.width,t.height],o=ki(_i(),i,i);return new wo(n,i,s,o,0)}function Gg(n){if(!(n.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const e=n.inversePixelTransform[0],t=n.inversePixelTransform[1],i=Math.sqrt(e*e+t*t),r=n.frameState,s=vo(n.inversePixelTransform.slice(),r.coordinateToPixelTransform),o=So(r.viewState.resolution,i);let a;const l=go();return l&&(a=Yt(l,r.viewState.projection)),new wo(n.context,i,r.extent,s,r.viewState.rotation,o,a)}function Dg(n,e){return cn(n.inversePixelTransform,e.slice(0))}const zg=Object.freeze(Object.defineProperty({__proto__:null,getRenderPixel:Dg,getVectorContext:Gg,toContext:Ng},Symbol.toStringTag,{value:"Module"})),Vg=de(zg),jg=de(yc),kg=de(qc),Bg=de(Hc),Ug=de(Yc),$g={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Kg={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class Zg extends Wc{constructor(e){super(e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.tmpTransform_=_i()}prepareTile(e,t,i){let r;const s=e.getState();return(s===Z.LOADED||s===Z.ERROR)&&(this.updateExecutorGroup_(e,t,i),this.tileImageNeedsRender_(e)&&(r=!0)),r}getTile(e,t,i,r){const s=r.pixelRatio,o=r.viewState,a=o.resolution,l=o.projection,u=this.getLayer(),c=u.getSource().getTile(e,t,i,s,l),p=r.viewHints,_=!(p[vt.ANIMATING]||p[vt.INTERACTING]);return(_||!c.wantedResolution)&&(c.wantedResolution=a),this.prepareTile(c,s,l)&&(_||Date.now()-r.time<8)&&u.getRenderMode()!=="vector"&&this.renderTileImage_(c,r),super.getTile(e,t,i,r)}isDrawableTile(e){const t=this.getLayer();return super.isDrawableTile(e)&&(t.getRenderMode()==="vector"?Oe(t)in e.executorGroups:e.hasContext(t))}getTileImage(e){return e.getImage(this.getLayer())}prepareFrame(e){const t=this.getLayer().getRevision();return this.renderedLayerRevision_!==t&&(this.renderedLayerRevision_=t,this.renderedTiles.length=0),super.prepareFrame(e)}updateExecutorGroup_(e,t,i){const r=this.getLayer(),s=r.getRevision(),o=r.getRenderOrder()||null,a=e.wantedResolution,l=e.getReplayState(r);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==s&&l.renderedRenderOrder==o)return;const u=r.getSource(),c=r.getDeclutter(),p=u.getTileGrid(),w=u.getTileGridForProjection(i).getTileCoordExtent(e.wrappedTileCoord),v=u.getSourceTiles(t,i,e),E=Oe(r);delete e.hitDetectionImageData[E],e.executorGroups[E]=[],c&&(e.declutterExecutorGroups[E]=[]),l.dirty=!1;for(let x=0,L=v.length;x<L;++x){const P=v[x];if(P.getState()!=Z.LOADED)continue;const b=P.tileCoord,O=p.getTileCoordExtent(b),k=ht(w,O),K=Lt(k,r.getRenderBuffer()*a,this.tmpExtent),z=yi(O,k)?null:K,D=new fs(0,K,a,t),V=c?new fs(0,k,a,t):void 0,Q=So(a,t),W=function(Pe){let ye;const _e=Pe.getStyleFunction()||r.getStyleFunction();if(_e&&(ye=_e(Pe,a)),ye){const Le=this.renderFeature(Pe,Q,ye,D,V);l.dirty=l.dirty||Le}},pe=P.getFeatures();o&&o!==l.renderedRenderOrder&&pe.sort(o);for(let Pe=0,ye=pe.length;Pe<ye;++Pe){const _e=pe[Pe];(!z||Xe(z,_e.getGeometry().getExtent()))&&W.call(this,_e)}const ce=D.finish(),ue=r.getRenderMode()!=="vector"&&c&&v.length===1?null:k,Re=new gs(ue,a,t,u.getOverlaps(),ce,r.getRenderBuffer());if(e.executorGroups[E].push(Re),V){const Pe=new gs(null,a,t,u.getOverlaps(),V.finish(),r.getRenderBuffer());e.declutterExecutorGroups[E].push(Pe)}}l.renderedRevision=s,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(e,t,i,r,s){const o=t.viewState.resolution,a=t.viewState.rotation;i=i??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(t.viewState.projection),p=_c([e]);Lt(p,o*i,p);const _={},w=function(x,L,P){let b=x.getId();b===void 0&&(b=Oe(x));const O=_[b];if(O){if(O!==!0&&P<O.distanceSq){if(P===0)return _[b]=!0,s.splice(s.lastIndexOf(O),1),r(x,l,L);O.geometry=L,O.distanceSq=P}}else{if(P===0)return _[b]=!0,r(x,l,L);s.push(_[b]={feature:x,layer:l,geometry:L,distanceSq:P,callback:r})}},v=this.renderedTiles;let E;for(let x=0,L=v.length;!E&&x<L;++x){const P=v[x],b=c.getTileCoordExtent(P.wrappedTileCoord);if(!Xe(b,p))continue;const O=Oe(l),k=[P.executorGroups[O]],K=P.declutterExecutorGroups[O];K&&k.push(K),k.some(z=>{const D=z===K?t.declutterTree.all().map(V=>V.value):null;for(let V=0,Q=z.length;V<Q;++V)if(E=z[V].forEachFeatureAtCoordinate(e,o,a,i,w,D),E)return!0})}return E}getFeatures(e){return new Promise((t,i)=>{const r=this.getLayer(),s=Oe(r),o=r.getSource(),a=this.renderedProjection,l=a.getExtent(),u=this.renderedResolution,c=o.getTileGridForProjection(a),p=cn(this.renderedPixelToCoordinateTransform_,e.slice()),_=c.getTileCoordForCoordAndResolution(p,u);let w;for(let b=0,O=this.renderedTiles.length;b<O;++b)if(_.toString()===this.renderedTiles[b].tileCoord.toString()){if(w=this.renderedTiles[b],w.getState()===Z.LOADED){const k=c.getTileCoordExtent(w.tileCoord);o.getWrapX()&&a.canWrapX()&&!Ct(l,k)&&fo(p,a);break}w=void 0}if(!w||w.loadingSourceTiles>0){t([]);return}const v=c.getTileCoordExtent(w.wrappedTileCoord),E=an(v),x=[(p[0]-E[0])/u,(E[1]-p[1])/u],L=w.getSourceTiles().reduce(function(b,O){return b.concat(O.getFeatures())},[]);let P=w.hitDetectionImageData[s];if(!P){const b=Qe(c.getTileSize(c.getZForResolution(u,o.zDirection))),O=this.renderedRotation_,k=[this.getRenderTransform(c.getTileCoordCenter(w.wrappedTileCoord),u,0,xr,b[0]*xr,b[1]*xr,0)];P=wc(b,k,L,r.getStyleFunction(),c.getTileCoordExtent(w.wrappedTileCoord),w.getReplayState(r).renderedResolution,O),w.hitDetectionImageData[s]=P}t(vc(x,L,P))})}handleFontsChanged(){const e=this.getLayer();e.getVisible()&&this.renderedLayerRevision_!==void 0&&e.changed()}handleStyleImageChange_(e){this.renderIfReadyAndVisible()}renderDeclutter(e){const t=this.context,i=t.globalAlpha;t.globalAlpha=this.getLayer().getOpacity();const r=e.viewHints,s=!(r[vt.ANIMATING]||r[vt.INTERACTING]),o=this.renderedTiles;for(let a=0,l=o.length;a<l;++a){const u=o[a],c=u.declutterExecutorGroups[Oe(this.getLayer())];if(c)for(let p=c.length-1;p>=0;--p)c[p].execute(this.context,1,this.getTileRenderTransform(u,e),e.viewState.rotation,s,void 0,e.declutterTree)}t.globalAlpha=i}getTileRenderTransform(e,t){const i=t.pixelRatio,r=t.viewState,s=r.center,o=r.resolution,a=r.rotation,l=t.size,u=Math.round(l[0]*i),c=Math.round(l[1]*i),_=this.getLayer().getSource().getTileGridForProjection(t.viewState.projection),w=e.tileCoord,v=_.getTileCoordExtent(e.wrappedTileCoord),E=_.getTileCoordExtent(w,this.tmpExtent)[0]-v[0];return vo(ki(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(s,o,a,i,u,c,E))}postRender(e,t){const i=t.viewHints,r=!(i[vt.ANIMATING]||i[vt.INTERACTING]);this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice(),this.renderedRotation_=t.viewState.rotation;const s=this.getLayer(),o=s.getRenderMode(),a=e.globalAlpha;e.globalAlpha=s.getOpacity();const l=Kg[o],u=t.viewState,c=u.rotation,p=s.getSource(),w=p.getTileGridForProjection(u.projection).getZForResolution(u.resolution,p.zDirection),v=this.renderedTiles,E=[],x=[];let L=!0;for(let P=v.length-1;P>=0;--P){const b=v[P];L=L&&!b.getReplayState(s).dirty;const O=b.executorGroups[Oe(s)].filter(V=>V.hasExecutors(l));if(O.length===0)continue;const k=this.getTileRenderTransform(b,t),K=b.tileCoord[0];let z=!1;const D=O[0].getClipCoords(k);if(D){for(let V=0,Q=E.length;V<Q;++V)if(w!==K&&K<x[V]){const W=E[V];Xe([D[0],D[3],D[4],D[7]],[W[0],W[3],W[4],W[7]])&&(z||(e.save(),z=!0),e.beginPath(),e.moveTo(D[0],D[1]),e.lineTo(D[2],D[3]),e.lineTo(D[4],D[5]),e.lineTo(D[6],D[7]),e.moveTo(W[6],W[7]),e.lineTo(W[4],W[5]),e.lineTo(W[2],W[3]),e.lineTo(W[0],W[1]),e.clip())}E.push(D),x.push(K)}for(let V=0,Q=O.length;V<Q;++V)O[V].execute(e,1,k,c,r,l);z&&e.restore()}e.globalAlpha=a,this.ready=L,super.postRender(e,t)}renderFeature(e,t,i,r,s){if(!i)return!1;let o=!1;if(Array.isArray(i))for(let a=0,l=i.length;a<l;++a)o=ms(r,e,i[a],t,this.boundHandleStyleImageChange_,void 0,s)||o;else o=ms(r,e,i,t,this.boundHandleStyleImageChange_,void 0,s);return o}tileImageNeedsRender_(e){const t=this.getLayer();if(t.getRenderMode()==="vector")return!1;const i=e.getReplayState(t),r=t.getRevision(),s=e.wantedResolution;return i.renderedTileResolution!==s||i.renderedTileRevision!==r}renderTileImage_(e,t){const i=this.getLayer(),r=e.getReplayState(i),s=i.getRevision(),o=e.executorGroups[Oe(i)];r.renderedTileRevision=s;const a=e.wrappedTileCoord,l=a[0],u=i.getSource();let c=t.pixelRatio;const _=t.viewState.projection,w=u.getTileGridForProjection(_),v=w.getResolution(e.tileCoord[0]),E=t.pixelRatio/e.wantedResolution*v,x=w.getResolution(l),L=e.getContext(i);c=Math.round(Math.max(c,E/c));const P=u.getTilePixelSize(l,c,_);L.canvas.width=P[0],L.canvas.height=P[1];const b=c/E;if(b!==1){const z=ps(this.tmpTransform_);ki(z,b,b),L.setTransform.apply(L,z)}const O=w.getTileCoordExtent(a,this.tmpExtent),k=E/x,K=ps(this.tmpTransform_);ki(K,k,-k),Sc(K,-O[0],-O[3]);for(let z=0,D=o.length;z<D;++z)o[z].execute(L,b,K,0,!0,$g[i.getRenderMode()]);r.renderedTileResolution=e.wantedResolution}}const qg=Zg;class Hg extends Cc{constructor(e){e=e||{};const t=Object.assign({},e);delete t.preload,delete t.useInterimTilesOnError,super(t),this.on,this.once,this.un;const i=e.renderMode||"hybrid";De(i=="hybrid"||i=="vector",28),this.renderMode_=i,this.setPreload(e.preload?e.preload:0),this.setUseInterimTilesOnError(e.useInterimTilesOnError!==void 0?e.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new qg(this)}getFeatures(e){return super.getFeatures(e)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Mi.PRELOAD)}getUseInterimTilesOnError(){return this.get(Mi.USE_INTERIM_TILES_ON_ERROR)}setPreload(e){this.set(Mi.PRELOAD,e)}setUseInterimTilesOnError(e){this.set(Mi.USE_INTERIM_TILES_ON_ERROR,e)}}const Yg=Object.freeze(Object.defineProperty({__proto__:null,default:Hg},Symbol.toStringTag,{value:"Module"})),Wg=de(Yg),io=de(Ec),Xg=de(Tc),Qg=de(xc),Jg=de(Rc),em=de(Pc),tm=de(ou),im=de(Ic),rm=de(bc),nm=de(Lc),sm=de(Ac),om=de(Oc),am=de(mf);(function(n,e){(function(t,i){n.exports=i(Yf,Wf,Xf,Qf,Jf,eg,tg,ig,rg,ng,sg,og,Og,Fg,Mg,Vg,jg,kg,Bg,Ug,Wg,io,Xg,Qg,Jg,em,tm,im,rm,nm,sm,io,om,am)})(self,(t,i,r,s,o,a,l,u,c,p,_,w,v,E,x,L,P,b,O,k,K,z,D,V,Q,W,pe,ce,ue,Re,Pe,ye,_e,Le)=>(()=>{var at={911:M=>{M.exports=D},312:M=>{M.exports=Le},177:M=>{M.exports=r},320:M=>{M.exports=z},235:M=>{M.exports=ye},401:M=>{M.exports=v},229:M=>{M.exports=ue},206:M=>{M.exports=t},253:M=>{M.exports=Pe},988:M=>{M.exports=_e},604:M=>{M.exports=V},330:M=>{M.exports=o},582:M=>{M.exports=W},164:M=>{M.exports=s},425:M=>{M.exports=ce},996:M=>{M.exports=K},24:M=>{M.exports=i},817:M=>{M.exports=L},432:M=>{M.exports=w},63:M=>{M.exports=pe},673:M=>{M.exports=_},606:M=>{M.exports=a},469:M=>{M.exports=l},623:M=>{M.exports=u},886:M=>{M.exports=c},830:M=>{M.exports=Q},622:M=>{M.exports=p},750:M=>{M.exports=b},962:M=>{M.exports=Re},51:M=>{M.exports=x},193:M=>{M.exports=E},628:M=>{M.exports=O},423:M=>{M.exports=k},280:M=>{M.exports=P}},Je={};function $(M){var ae=Je[M];if(ae!==void 0)return ae.exports;var ve=Je[M]={exports:{}};return at[M](ve,ve.exports,$),ve.exports}$.n=M=>{var ae=M&&M.__esModule?()=>M.default:()=>M;return $.d(ae,{a:ae}),ae},$.d=(M,ae)=>{for(var ve in ae)$.o(ae,ve)&&!$.o(M,ve)&&Object.defineProperty(M,ve,{enumerable:!0,get:ae[ve]})},$.o=(M,ae)=>Object.prototype.hasOwnProperty.call(M,ae),$.r=M=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(M,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(M,"__esModule",{value:!0})};var et={};return(()=>{$.r(et),$.d(et,{default:()=>Cl}),$(206);var M=$(24),ae={};function ve(C,y,d){return C.on(y,d)}ae.obj=function(C){return C},ae.supportsImageRenderingPixelatedResult_=void 0,ae.imageRenderingValueResult_=void 0,ae.supportsImageRenderingPixelated=function(){if(ae.supportsImageRenderingPixelatedResult_===void 0){var C=document.createElement("canvas");C.setAttribute("style","image-rendering: -moz-crisp-edges; image-rendering: pixelated;");var y=C.style.imageRendering;ae.supportsImageRenderingPixelatedResult_=!!y,ae.supportsImageRenderingPixelatedResult_&&(ae.imageRenderingValueResult_=y)}return ae.supportsImageRenderingPixelatedResult_},ae.imageRenderingValue=function(){return ae.supportsImageRenderingPixelated(),ae.imageRenderingValueResult_||""},ae.getSourceProjection=function(C){return C.get("olcs.projection")||C.getProjection()};var ni=0;function Ce(C){return C.olcs_uid||(C.olcs_uid=++ni)}function pt(C){var y=Cesium.GroundPolylinePrimitive;return y&&y.isSupported(C)}const Ze=ae;var gr,Ea=$(177),Ta=$(164),xa=$.n(Ta),Ra=$(330),Pa=$.n(Ra),Ia=$(606),ba=$.n(Ia),La=$(469),Aa=$.n(La),Oa=$(623),Fa=$.n(Oa),Ma=$(886),Na=$.n(Ma),Ga=$(622),Da=$.n(Ga),za=$(673),Va=$(432),ja=(gr=new Va.Tile({projection:"EPSG:3857",wrapX:!0}).getTileCoordForTileUrlFunction([6,-31,22]))&&gr[1]===33&&gr[2]===22,On=function(){function C(d,m,h){var f=this;this.source_=m,this.projection_=null,this.fallbackProj_=h||null,this.ready_=!1,this.tilingScheme_=null,this.rectangle_=null,this.map_=d,this.shouldRequestNextLevel=!1;var g=this.source_.get("olcs.proxy");g&&(typeof g=="function"?this.proxy_={getURL:g}:typeof g=="string"&&(this.proxy_=new Cesium.DefaultProxy(g))),this.errorEvent_=new Cesium.Event,this.emptyCanvas_=document.createElement("canvas"),this.emptyCanvas_.width=1,this.emptyCanvas_.height=1,this.source_.on("change",function(S){f.handleSourceChanged_()}),this.handleSourceChanged_()}var y=C.prototype;return y.handleSourceChanged_=function(d){if(!this.ready_&&this.source_.getState()=="ready"){this.projection_=Ze.getSourceProjection(this.source_)||this.fallbackProj_;var m={numberOfLevelZeroTilesX:1,numberOfLevelZeroTilesY:1};if(this.source_.tileGrid!==null&&this.source_.tileGrid.forEachTileCoord(this.projection_.getExtent(),0,function(h){h[0];var f=h[1],g=h[2];m.numberOfLevelZeroTilesX=f+1,m.numberOfLevelZeroTilesY=g+1}),this.projection_.getCode()==="EPSG:4326")this.shouldRequestNextLevel=m.numberOfLevelZeroTilesX===1&&m.numberOfLevelZeroTilesY===1,this.tilingScheme_=new Cesium.GeographicTilingScheme(m);else{if(this.projection_.getCode()!=="EPSG:3857")return;this.shouldRequestNextLevel=!1,this.tilingScheme_=new Cesium.WebMercatorTilingScheme(m)}this.rectangle_=this.tilingScheme_.rectangle,this.ready_=!0}},y.getTileCredits=function(d,m,h){var f=this.source_.getAttributions();if(!f)return[];var g=this.map_.getView().calculateExtent(this.map_.getSize()),S=this.map_.getView().getCenter();return Dn(f,this.shouldRequestNextLevel?h+1:h,S,g)},y.requestImage=function(d,m,h){var f=this.source_.getTileUrlFunction();if(f&&this.projection_){var g=this.shouldRequestNextLevel?h+1:h,S=m;ja||(S=-m-1);var T=f.call(this.source_,[g,d,S],1,this.projection_);return this.proxy_&&(T=this.proxy_.getURL(T)),T?Cesium.ImageryProvider.loadImage(this,T):this.emptyCanvas_}return this.emptyCanvas_},C}();Object.defineProperties(On.prototype,{ready:{get:function(){return this.ready_}},rectangle:{get:function(){return this.rectangle_}},tileWidth:{get:function(){var C=this.source_.getTileGrid();return C?Array.isArray(C.getTileSize(0))?C.getTileSize(0)[0]:C.getTileSize(0):256}},tileHeight:{get:function(){var C=this.source_.getTileGrid();return C?Array.isArray(C.getTileSize(0))?C.getTileSize(0)[1]:C.getTileSize(0):256}},maximumLevel:{get:function(){var C=this.source_.getTileGrid();return C?C.getMaxZoom():18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this.tilingScheme_}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this.errorEvent_}},proxy:{get:function(){return this.proxy_}},hasAlphaChannel:{get:function(){return!0}},pickFeatures:{get:function(){}}});const Fn=On;var ka=$(401),Ba=$.n(ka),Ua=$(193),$a=$.n(Ua),Ka=$(51),Za=$.n(Ka),qa=$(817),Mn=$(280),Ha=$(750),Nn=$.n(Ha),Ya=$(628),Wa=$(423),mr=new(Ba()),Xa=[new($a())({stroke:new(Za())({color:"blue",width:2})})],Qa=function(){function C(d){this.urls=d.urls,this.ready=!0,this.readyPromise=Promise.resolve(!0),this.tileWidth=256,this.tileHeight=256,this.maximumLevel=d.maximumLevel||20,this.minimumLevel=d.minimumLevel||0,this.tilingScheme=new Cesium.WebMercatorTilingScheme,this.rectangle=d.rectangle||this.tilingScheme.rectangle,this.errorEvent=new Cesium.Event,this.credit=d.credit,this.hasAlphaChannel=!0,this.styleFunction_=d.styleFunction||function(){return Xa},this.projection_=(0,M.get)("EPSG:3857"),this.emptyCanvas_=document.createElement("canvas"),this.emptyCanvas_.width=1,this.emptyCanvas_.height=1,this.tileRectangle_=new Cesium.Rectangle;var m=d.cacheSize!==void 0?d.cacheSize:50;this.tileCache=new(Nn())(m),this.featureCache=d.featureCache||new(Nn())(m);var h=(0,Ya.getForProjection)(this.projection_);this.tileFunction_=(0,Wa.createFromTemplates)(this.urls,h)}var y=C.prototype;return y.getTileCredits=function(){return[]},y.pickFeatures=function(){},y.getTileFeatures=function(d,m,h){var f,g=this,S=this.getCacheKey_(d,m,h);if(this.featureCache.containsKey(S)&&(f=this.featureCache.get(S)),!f){var T=this.getUrl_(d,m,h);if(f=fetch(T).then(function(R){return R.ok?R:Promise.reject(R)}).then(function(R){return R.arrayBuffer()}).then(function(R){return g.readFeaturesFromBuffer(R)}),this.featureCache.set(S,f),this.featureCache.getCount()>2*this.featureCache.highWaterMark)for(;this.featureCache.canExpireCache();)this.featureCache.pop()}return f},y.readFeaturesFromBuffer=function(d){var m,h=this;Mn.VERSION<="6.4.4"&&(m={extent:[0,0,4096,4096],dataProjection:mr.dataProjection,featureProjection:mr.dataProjection});var f=mr.readFeatures(d,m),g=this.tileWidth/4096;return f.forEach(function(S){for(var T=S.getFlatCoordinates(),R=!1,I=0;I<T.length;++I)T[I]*=g,R&&(T[I]=h.tileWidth-T[I]),Mn.VERSION<="6.4.4"&&(R=!R)}),f},y.getUrl_=function(d,m,h){return this.tileFunction_([d,m,h])},y.getCacheKey_=function(d,m,h){return d+"_"+m+"_"+h},y.requestImage=function(d,m,h,f){var g=this;if(h<this.minimumLevel)return this.emptyCanvas_;try{var S,T=this.getCacheKey_(h,d,m);if(this.tileCache.containsKey(T)&&(S=this.tileCache.get(T)),!S&&(S=this.getTileFeatures(h,d,m).then(function(R){g.tilingScheme.tileXYToNativeRectangle(d,m,h,g.tileRectangle_);var I=(g.tileRectangle_.east-g.tileRectangle_.west)/g.tileWidth;return g.rasterizeFeatures(R,g.styleFunction_,I)}),this.tileCache.set(T,S),this.tileCache.getCount()>2*this.tileCache.highWaterMark))for(;this.tileCache.canExpireCache();)this.tileCache.pop();return S}catch(R){this.raiseEvent("could not render pbf to tile",R)}},y.rasterizeFeatures=function(d,m,h){var f=document.createElement("canvas"),g=(0,qa.toContext)(f.getContext("2d"),{size:[this.tileWidth,this.tileHeight]});return d.forEach(function(S){var T=m(S,h);T&&T.forEach(function(R){g.setStyle(R),g.drawGeometry(S)})}),f},C}(),Ja=$(996),Gn=$.n(Ja),el=$(320),J={};function Dn(C,y,d,m){if(!C)return[];var h=C({viewState:{zoom:y,center:d},extent:m});return Array.isArray(h)||(h=[h]),h.map(function(f){return new Cesium.Credit(f,!0)})}J.computePixelSizeAtCoordinate=function(C,y){var d=C.camera,m=C.canvas,h=d.frustum,f=Cesium.Cartesian3.magnitude(Cesium.Cartesian3.subtract(d.position,y,new Cesium.Cartesian3));return h.getPixelDimensions(m.clientWidth,m.clientHeight,f,C.pixelRatio,new Cesium.Cartesian2)},J.computeBoundingBoxAtTarget=function(C,y,d){var m=J.computePixelSizeAtCoordinate(C,y),h=Cesium.Transforms.eastNorthUpToFixedFrame(y),f=Cesium.Matrix4.multiplyByPoint(h,new Cesium.Cartesian3(-m.x*d,-m.y*d,0),new Cesium.Cartesian3),g=Cesium.Matrix4.multiplyByPoint(h,new Cesium.Cartesian3(m.x*d,m.y*d,0),new Cesium.Cartesian3);return Cesium.Ellipsoid.WGS84.cartesianArrayToCartographicArray([f,g])},J.applyHeightOffsetToGeometry=function(C,y){C.applyTransform(function(d,m,h){if(h!==void 0&&h>=3)for(var f=0;f<m.length;f+=h)m[f+2]=m[f+2]+y;return m})},J.createMatrixAtCoordinates=function(C,y,d,m){y===void 0&&(y=0),d===void 0&&(d=Cesium.Cartesian3.ZERO),m===void 0&&(m=new Cesium.Cartesian3(1,1,1));var h=J.ol4326CoordinateToCesiumCartesian(C),f=Cesium.Transforms.eastNorthUpToFixedFrame(h),g=Cesium.Quaternion.fromAxisAngle(Cesium.Cartesian3.UNIT_Z,-y),S=Cesium.Matrix4.fromTranslationQuaternionRotationScale(d,g,m);return Cesium.Matrix4.multiply(f,S,new Cesium.Matrix4)},J.rotateAroundAxis=function(C,y,d,m,h){var f=Cesium.Math.clamp,g=Cesium.defaultValue,S=h||{},T=g(S.duration,500),R=g(S.easing,Ea.linear),I=S.callback,F=0,N=new Cesium.Matrix4,j=Date.now();window.requestAnimationFrame(function B(){var U=Date.now(),G=R(f((U-j)/T,0,1));C.transform.clone(N);var ee=(G-F)*y;F=G,C.lookAtTransform(m),C.rotate(d,ee),C.lookAtTransform(N),G<1?window.requestAnimationFrame(B):I&&I()})},J.setHeadingUsingBottomCenter=function(C,y,d,m){var h=C.camera,f=J.computeAngleToZenith(C,d),g=h.right,S=Cesium.Quaternion.fromAxisAngle(g,f),T=Cesium.Matrix3.fromQuaternion(S),R=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(h.position,d,R);var I=new Cesium.Cartesian3;Cesium.Matrix3.multiplyByVector(T,R,I),Cesium.Cartesian3.add(I,d,I);var F=Cesium.Matrix4.fromTranslation(I);(0,J.rotateAroundAxis)(h,y,I,F,m)},J.pickOnTerrainOrEllipsoid=function(C,y){var d=C.camera.getPickRay(y);return C.globe.pick(d,C)||C.camera.pickEllipsoid(y)},J.pickBottomPoint=function(C){var y=C.canvas,d=new Cesium.Cartesian2(y.clientWidth/2,y.clientHeight);return J.pickOnTerrainOrEllipsoid(C,d)},J.pickCenterPoint=function(C){var y=C.canvas,d=new Cesium.Cartesian2(y.clientWidth/2,y.clientHeight/2);return J.pickOnTerrainOrEllipsoid(C,d)},J.computeSignedTiltAngleOnGlobe=function(C){var y=C.camera,d=new Cesium.Ray(y.position,y.direction),m=C.globe.pick(d,C);if(!m){var h=Cesium.Ellipsoid.WGS84,f=Cesium.IntersectionTests.rayEllipsoid(d,h);f&&(m=Cesium.Ray.getPoint(d,f.start))}if(m){var g=new Cesium.Cartesian3;Cesium.Ellipsoid.WGS84.geocentricSurfaceNormal(m,g);var S=(0,J.signedAngleBetween)(y.direction,g,y.right)-Math.PI;return Cesium.Math.convertLongitudeRange(S)}},J.bottomFovRay=function(C){var y=C.camera,d=y.frustum.fovy/2,m=y.direction,h=Cesium.Quaternion.fromAxisAngle(y.right,d),f=Cesium.Matrix3.fromQuaternion(h),g=new Cesium.Cartesian3;return Cesium.Matrix3.multiplyByVector(f,m,g),new Cesium.Ray(y.position,g)},J.signedAngleBetween=function(C,y,d){var m=new Cesium.Cartesian3,h=new Cesium.Cartesian3,f=new Cesium.Cartesian3;Cesium.Cartesian3.normalize(C,m),Cesium.Cartesian3.normalize(y,h),Cesium.Cartesian3.cross(m,h,f);var g=Cesium.Cartesian3.dot(m,h),S=Cesium.Cartesian3.magnitude(f),T=Cesium.Cartesian3.dot(d,f),R=Math.atan2(S,g);return T>=0?R:-R},J.computeAngleToZenith=function(C,y){var d=C.camera,m=d.frustum.fovy/2,h=J.bottomFovRay(C),f=Cesium.Cartesian3.clone(h.direction);Cesium.Cartesian3.negate(f,f);var g=new Cesium.Cartesian3;Cesium.Ellipsoid.WGS84.geocentricSurfaceNormal(y,g);var S=new Cesium.Cartesian3;return Cesium.Cartesian3.negate(d.right,S),J.signedAngleBetween(g,f,S)+m},J.extentToRectangle=function(C,y){if(C&&y){var d=(0,M.transformExtent)(C,y,"EPSG:4326");return Cesium.Rectangle.fromDegrees(d[0],d[1],d[2],d[3])}return null},J.sourceToImageryProvider=function(C,y,d,m){var h=y.get("olcs_skip");if(h)return null;var f=null;if(y instanceof Aa()&&y.getUrl()&&y.getImageLoadFunction()===za.defaultImageLoadFunction){var g={"olcs.proxy":y.get("olcs.proxy"),"olcs.extent":y.get("olcs.extent"),"olcs.projection":y.get("olcs.projection"),"olcs.imagesource":y};(y=new(Na())({url:y.getUrl(),attributions:y.getAttributions(),projection:y.getProjection(),params:y.getParams()})).setProperties(g)}if(y instanceof Fa()){var S=Ze.getSourceProjection(y);if(S||(S=d),!J.isCesiumProjection(S))return null;f=new Fn(C,y,d)}else{if(!(y instanceof ba())){if(y instanceof Da()){var T=Ze.getSourceProjection(y);if(T||(T=d),h===!1){var R,I=T.getCode().split(":")[1],F=y.urls.map(function(he){return he.replace(I,"3857")}),N=m.getExtent(),j=J.extentToRectangle(N,T),B=y.get("olcs_minimumLevel"),U=y.getAttributions(),G=m.getStyleFunction();return N&&U&&(R=Dn(U,0,(0,el.getCenter)(N),N)[0]),f=new Qa({credit:R,rectangle:j,minimumLevel:B,styleFunction:G,urls:F})}return null}return null}var ee=Ze.getSourceProjection(y);if(ee||(ee=d),!J.isCesiumProjection(ee))return null;f=new Cesium.SingleTileImageryProvider({url:y.getUrl(),rectangle:new Cesium.Rectangle.fromDegrees(y.getImageExtent()[0],y.getImageExtent()[1],y.getImageExtent()[2],y.getImageExtent()[3])})}return f},J.tileLayerToImageryLayer=function(C,y,d){if(!(y instanceof xa()||y instanceof Pa()||y instanceof Gn()))return null;var m=y.getSource();if(!m)return null;var h=m.get("olcs_provider");if(h||(h=this.sourceToImageryProvider(C,m,d,y)),!h)return null;var f={},g=y.get("olcs.extent")||y.getExtent();return g&&(f.rectangle=J.extentToRectangle(g,d)),new Cesium.ImageryLayer(h,f)},J.updateCesiumLayerProperties=function(C,y){var d=1,m=!0;[C.layer].concat(C.parents).forEach(function(h){var f=h.getOpacity();f!==void 0&&(d*=f);var g=h.getVisible();g!==void 0&&(m&=g)}),y.alpha=d,y.show=m},J.ol4326CoordinateToCesiumCartesian=function(C){var y=C;return y.length>2?Cesium.Cartesian3.fromDegrees(y[0],y[1],y[2]):Cesium.Cartesian3.fromDegrees(y[0],y[1])},J.ol4326CoordinateArrayToCsCartesians=function(C){for(var y=J.ol4326CoordinateToCesiumCartesian,d=[],m=0;m<C.length;++m)d.push(y(C[m]));return d},J.olGeometryCloneTo4326=function(C,y){var d=(0,M.get)("EPSG:4326"),m=(0,M.get)(y);if(m.getCode()!==d.getCode()){var h=C.getProperties();(C=C.clone()).transform(m,d),C.setProperties(h)}return C},J.convertColorToCesium=function(C){if(C=C||"black",Array.isArray(C))return new Cesium.Color(Cesium.Color.byteToFloat(C[0]),Cesium.Color.byteToFloat(C[1]),Cesium.Color.byteToFloat(C[2]),C[3]);if(typeof C=="string")return Cesium.Color.fromCssColorString(C);if(C instanceof CanvasPattern||C instanceof CanvasGradient){var y=document.createElement("canvas"),d=y.getContext("2d");return y.width=y.height=256,d.fillStyle=C,d.fillRect(0,0,y.width,y.height),new Cesium.ImageMaterialProperty({image:y})}},J.convertUrlToCesium=function(C){var y="",d=/\{(\d|[a-z])-(\d|[a-z])\}/,m=d.exec(C);if(m){C=C.replace(d,"{s}");var h,f=m[1].charCodeAt(0),g=m[2].charCodeAt(0);for(h=f;h<=g;++h)y+=String.fromCharCode(h)}return{url:C,subdomains:y}},J.resetToNorthZenith=function(C,y){return new Promise(function(d,m){var h=y.camera,f=J.pickBottomPoint(y);if(f){var g=C.getView().getRotation();if(g!==void 0){var S=J.computeAngleToZenith(y,f);J.setHeadingUsingBottomCenter(y,g,f);var T=Cesium.Matrix4.fromTranslation(f),R=h.right,I={callback:function(){var F=C.getView();J.normalizeView(F),d()}};J.rotateAroundAxis(h,-S,R,T,I)}else m("The view is not initialized")}else m("Could not get bottom pivot")})},J.rotateAroundBottomCenter=function(C,y){return new Promise(function(d,m){var h=C.camera,f=J.pickBottomPoint(C);if(f){var g={callback:d},S=Cesium.Matrix4.fromTranslation(f),T=h.right;(0,J.rotateAroundAxis)(h,-y,T,S,g)}else m("could not get bottom pivot")})},J.normalizeView=function(C,y){y===void 0&&(y=0);var d=C.getResolution();C.setRotation(y),C.constrainResolution?C.setResolution(C.constrainResolution(d)):C.setResolution(C.getConstrainedResolution(d))},J.isCesiumProjection=function(C){var y=C.getCode()==="EPSG:3857",d=C.getCode()==="EPSG:4326";return y||d};const we=J;function zn(C,y){var d=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(d)return(d=d.call(C)).next.bind(d);if(Array.isArray(C)||(d=function(h,f){if(h){if(typeof h=="string")return Vn(h,f);var g=Object.prototype.toString.call(h).slice(8,-1);if(g==="Object"&&h.constructor&&(g=h.constructor.name),g==="Map"||g==="Set")return Array.from(h);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Vn(h,f)}}(C))||y&&C&&typeof C.length=="number"){d&&(C=d);var m=0;return function(){return m>=C.length?{done:!0}:{done:!1,value:C[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vn(C,y){(y==null||y>C.length)&&(y=C.length);for(var d=0,m=new Array(y);d<y;d++)m[d]=C[d];return m}const tl=function(){function C(d){this.ol3d=d,this.scene_=d.getCesiumScene(),this.canvas_=this.scene_.canvas,this._boundNotifyRepaintRequired=this.notifyRepaintRequired.bind(this),this.repaintEventNames_=["mousemove","mousedown","mouseup","touchstart","touchend","touchmove","pointerdown","pointerup","pointermove","wheel"],this.enable()}var y=C.prototype;return y.enable=function(){this.scene_.requestRenderMode=!0,this.scene_.maximumRenderTimeChange=1e3;for(var d,m=zn(this.repaintEventNames_);!(d=m()).done;){var h=d.value;this.canvas_.addEventListener(h,this._boundNotifyRepaintRequired,!1)}window.addEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().on("change",this._boundNotifyRepaintRequired)},y.disable=function(){for(var d,m=zn(this.repaintEventNames_);!(d=m()).done;){var h=d.value;this.canvas_.removeEventListener(h,this._boundNotifyRepaintRequired,!1)}window.removeEventListener("resize",this._boundNotifyRepaintRequired,!1),this.ol3d.getOlMap().getLayerGroup().un("change",this._boundNotifyRepaintRequired),this.scene_.requestRenderMode=!1},y.restartRenderLoop=function(){this.notifyRepaintRequired()},y.notifyRepaintRequired=function(){this.scene_.requestRender()},C}();var lt=$(911),il=$.n(lt);function Li(C){return 180*C/Math.PI}function Ft(C){return C*Math.PI/180}const rl=function(){function C(d,m){var h=this;this.scene_=d,this.cam_=d.camera,this.map_=m,this.view_=null,this.viewListenKey_=null,this.toLonLat_=C.identityProjection,this.fromLonLat_=C.identityProjection,this.tilt_=0,this.distance_=0,this.lastCameraViewMatrix_=null,this.viewUpdateInProgress_=!1,this.map_.on("change:view",function(f){h.setView_(h.map_.getView())}),this.setView_(this.map_.getView())}C.identityProjection=function(d,m,h){var f=h||d.length;if(m)for(var g=0;g<f;++g)m[g]=d[g];return d};var y=C.prototype;return y.setView_=function(d){var m=this;if(this.view_&&((0,lt.unByKey)(this.viewListenKey_),this.viewListenKey_=null),this.view_=d,d){var h=(0,M.getTransform)(d.getProjection(),"EPSG:4326"),f=(0,M.getTransform)("EPSG:4326",d.getProjection());this.toLonLat_=h,this.fromLonLat_=f,this.viewListenKey_=d.on("propertychange",function(g){return m.handleViewEvent_(g)}),this.readFromView()}else this.toLonLat_=C.identityProjection,this.fromLonLat_=C.identityProjection},y.handleViewEvent_=function(d){this.viewUpdateInProgress_||this.readFromView()},y.setHeading=function(d){this.view_&&this.view_.setRotation(d)},y.getHeading=function(){if(this.view_)return this.view_.getRotation()||0},y.setTilt=function(d){this.tilt_=d,this.updateCamera_()},y.getTilt=function(){return this.tilt_},y.setDistance=function(d){this.distance_=d,this.updateCamera_(),this.updateView()},y.getDistance=function(){return this.distance_},y.setCenter=function(d){this.view_&&this.view_.setCenter(d)},y.getCenter=function(){if(this.view_)return this.view_.getCenter()},y.setPosition=function(d){if(this.toLonLat_){var m=this.toLonLat_(d),h=new Cesium.Cartographic(Ft(m[0]),Ft(m[1]),this.getAltitude());this.cam_.setView({destination:Cesium.Ellipsoid.WGS84.cartographicToCartesian(h)}),this.updateView()}},y.getPosition=function(){if(this.fromLonLat_){var d=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);return this.fromLonLat_([Li(d.longitude),Li(d.latitude)])}},y.setAltitude=function(d){var m=Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position);m.height=d,this.cam_.position=Cesium.Ellipsoid.WGS84.cartographicToCartesian(m),this.updateView()},y.getAltitude=function(){return Cesium.Ellipsoid.WGS84.cartesianToCartographic(this.cam_.position).height},y.updateCamera_=function(){if(this.view_&&this.toLonLat_){var d=this.view_.getCenter();if(d){var m=this.toLonLat_(d),h=new Cesium.Cartographic(Ft(m[0]),Ft(m[1]));if(this.scene_.globe){var f=this.scene_.globe.getHeight(h);h.height=f||0}var g=Cesium.Ellipsoid.WGS84.cartographicToCartesian(h),S={pitch:this.tilt_-Cesium.Math.PI_OVER_TWO,heading:-this.view_.getRotation(),roll:void 0};this.cam_.setView({destination:g,orientation:S}),this.cam_.moveBackward(this.distance_),this.checkCameraChange(!0)}}},y.readFromView=function(){if(this.view_&&this.toLonLat_){var d=this.view_.getCenter();if(d!=null){var m=this.toLonLat_(d),h=this.view_.getResolution();this.distance_=this.calcDistanceForResolution(h||0,Ft(m[1])),this.updateCamera_()}}},y.updateView=function(){if(this.view_&&this.fromLonLat_){this.viewUpdateInProgress_=!0;var d=Cesium.Ellipsoid.WGS84,m=this.scene_,h=we.pickCenterPoint(m),f=h;if(!f){var g=m.globe,S=this.cam_.positionCartographic.clone(),T=g.getHeight(S);S.height=T||0,f=Cesium.Ellipsoid.WGS84.cartographicToCartesian(S)}this.distance_=Cesium.Cartesian3.distance(f,this.cam_.position);var R=d.cartesianToCartographic(f);if(this.view_.setCenter(this.fromLonLat_([Li(R.longitude),Li(R.latitude)])),this.view_.setResolution(this.calcResolutionForDistance(this.distance_,R?R.latitude:0)),h){var I=this.cam_.position,F=new Cesium.Cartesian3;d.geocentricSurfaceNormal(h,F);var N=new Cesium.Cartesian3;Cesium.Cartesian3.subtract(I,h,N),Cesium.Cartesian3.normalize(N,N);var j=this.cam_.up,B=this.cam_.right,U=new Cesium.Cartesian3(-h.y,h.x,0),G=Cesium.Cartesian3.angleBetween(B,U),ee=Cesium.Cartesian3.cross(h,j,new Cesium.Cartesian3).z;this.view_.setRotation(ee<0?G:-G);var he=Math.acos(Cesium.Cartesian3.dot(F,N));this.tilt_=isNaN(he)?0:he}else this.view_.setRotation(this.cam_.heading),this.tilt_=-this.cam_.pitch+Math.PI/2;this.viewUpdateInProgress_=!1}},y.checkCameraChange=function(d){var m=this.lastCameraViewMatrix_,h=this.cam_.viewMatrix;m&&Cesium.Matrix4.equalsEpsilon(m,h,1e-5)||(this.lastCameraViewMatrix_=h.clone(),d!==!0&&this.updateView())},y.calcDistanceForResolution=function(d,m){return function(h,f,g,S){var T=g.canvas,R=g.camera.frustum.fovy,I=S.getMetersPerUnit();return h*T.clientHeight*I*Math.cos(Math.abs(f))/2/Math.tan(R/2)}(d,m,this.scene_,this.view_.getProjection())},y.calcResolutionForDistance=function(d,m){return function(h,f,g,S){var T=g.canvas,R=g.camera.frustum.fovy,I=S.getMetersPerUnit();return 2*h*Math.tan(R/2)/I/Math.cos(Math.abs(f))/T.clientHeight}(d,m,this.scene_,this.view_.getProjection())},C}();var nl=$(604),pr=$.n(nl);const yr=function(){function C(d,m){this.map=d,this.view=d.getView(),this.scene=m,this.olLayers=d.getLayerGroup().getLayers(),this.mapLayerGroup=d.getLayerGroup(),this.layerMap={},this.olLayerListenKeys={},this.olGroupListenKeys_={}}var y=C.prototype;return y.synchronize=function(){this.destroyAll(),this.addLayers_(this.mapLayerGroup)},y.orderLayers=function(){},y.addLayers_=function(d){for(var m=this,h=[{layer:d,parents:[]}],f=function(){var g=h.splice(0,1)[0],S=g.layer,T=Ce(S).toString();m.olLayerListenKeys[T]=[];var R=null;if(S instanceof pr())m.listenForGroupChanges_(S),S!==m.mapLayerGroup&&(R=m.createSingleLayerCounterparts(g)),R||S.getLayers().forEach(function(N){if(N){var j={layer:N,parents:S===m.mapLayerGroup?[]:[g.layer].concat(g.parents)};h.push(j)}});else if(!(R=m.createSingleLayerCounterparts(g))){var I=T,F=g;m.olLayerListenKeys[T].push(ve(F.layer,"change",function N(j){var B=m.createSingleLayerCounterparts(F);B&&(F.layer.un("change",N),m.addCesiumObjects_(B,I,F.layer),m.orderLayers())}))}R&&m.addCesiumObjects_(R,T,S)};h.length>0;)f();this.orderLayers()},y.addCesiumObjects_=function(d,m,h){var f=this;this.layerMap[m]=d,this.olLayerListenKeys[m].push(ve(h,"change:zIndex",function(){return f.orderLayers()})),d.forEach(function(g){f.addCesiumObject(g)})},y.removeAndDestroySingleLayer_=function(d){var m=this,h=Ce(d).toString(),f=this.layerMap[h];return f&&(f.forEach(function(g){m.removeSingleCesiumObject(g,!1),m.destroyCesiumObject(g)}),this.olLayerListenKeys[h].forEach(lt.unByKey),delete this.olLayerListenKeys[h]),delete this.layerMap[h],!!f},y.unlistenSingleGroup_=function(d){if(d!==this.mapLayerGroup){var m=Ce(d).toString();this.olGroupListenKeys_[m].forEach(function(h){(0,lt.unByKey)(h)}),delete this.olGroupListenKeys_[m],delete this.layerMap[m]}},y.removeLayer_=function(d){var m=this;d&&function(){for(var h=[d];h.length>0;){var f=h.splice(0,1)[0],g=m.removeAndDestroySingleLayer_(f);f instanceof pr()&&(m.unlistenSingleGroup_(f),g||f.getLayers().forEach(function(S){h.push(S)}))}}()},y.listenForGroupChanges_=function(d){var m=Ce(d).toString(),h=[];this.olGroupListenKeys_[m]=h;var f=[],g=function(){var S=this,T=d.getLayers();T&&(f=[T.on("add",function(R){S.addLayers_(R.element)}),T.on("remove",function(R){S.removeLayer_(R.element)})],h.push.apply(h,f))}.bind(this);g(),h.push(d.on("change:layers",function(S){f.forEach(function(T){var R=h.indexOf(T);R>=0&&h.splice(R,1),(0,lt.unByKey)(T)}),g()}))},y.destroyAll=function(){var d;for(d in this.removeAllCesiumObjects(!0),this.olGroupListenKeys_)this.olGroupListenKeys_[d].forEach(lt.unByKey);for(d in this.olLayerListenKeys)this.olLayerListenKeys[d].forEach(lt.unByKey);this.olGroupListenKeys_={},this.olLayerListenKeys={},this.layerMap={}},y.addCesiumObject=function(d){},y.destroyCesiumObject=function(d){},y.removeSingleCesiumObject=function(d,m){},y.removeAllCesiumObjects=function(d){},y.createSingleLayerCounterparts=function(d){},C}();function _r(C,y){return _r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,m){return d.__proto__=m,d},_r(C,y)}const jn=function(C){var y,d;function m(f,g){var S;return(S=C.call(this,f,g)||this).cesiumLayers_=g.imageryLayers,S.ourLayers_=new Cesium.ImageryLayerCollection,S}d=C,(y=m).prototype=Object.create(d.prototype),y.prototype.constructor=y,_r(y,d);var h=m.prototype;return h.addCesiumObject=function(f){this.cesiumLayers_.add(f),this.ourLayers_.add(f)},h.destroyCesiumObject=function(f){f.destroy()},h.removeSingleCesiumObject=function(f,g){this.cesiumLayers_.remove(f,g),this.ourLayers_.remove(f,!1)},h.removeAllCesiumObjects=function(f){for(var g=0;g<this.ourLayers_.length;++g)this.cesiumLayers_.remove(this.ourLayers_.get(g),f);this.ourLayers_.removeAll(!1)},h.convertLayerToCesiumImageries=function(f,g){var S=we.tileLayerToImageryLayer(this.map,f,g);return S?[S]:null},h.createSingleLayerCounterparts=function(f){var g=this,S=f.layer,T=Ce(S).toString(),R=this.view.getProjection(),I=this.convertLayerToCesiumImageries(S,R);if(I){var F,N=[];if([f.layer].concat(f.parents).forEach(function(U){N.push(U.on(["change:opacity","change:visible"],function(){for(var G=0;G<I.length;++G)we.updateCesiumLayerProperties(f,I[G])}))}),S.getStyleFunction){var j=S.getStyleFunction();N.push(S.on("change",function(){var U=S.getStyleFunction();if(j!==U){j=U;for(var G=0;G<I.length;++G){var ee=I[G];ee._imageryCache&&ee.imageryProvider.cache_&&(ee._imageryCache={},ee.imageryProvider.cache_={},ee.imageryProvider.styleFunction_=U)}g.scene.requestRender()}}))}for(var B=0;B<I.length;++B)we.updateCesiumLayerProperties(f,I[B]);N.push(S.on("change:extent",function(U){for(var G=0;G<I.length;++G)g.cesiumLayers_.remove(I[G],!0),g.ourLayers_.remove(I[G],!1);delete g.layerMap[Ce(S)],g.synchronize()})),N.push(S.on("change",function(U){for(var G=0;G<I.length;++G){var ee=g.cesiumLayers_.indexOf(I[G]);ee>=0&&(g.cesiumLayers_.remove(I[G],!1),g.cesiumLayers_.add(I[G],ee))}})),(F=this.olLayerListenKeys[T]).push.apply(F,N)}return Array.isArray(I)?I:null},h.orderLayers=function(){for(var f=this,g=[],S={},T=[this.mapLayerGroup];T.length>0;){var R=T.splice(0,1)[0];if(g.push(R),S[Ce(R)]=R.getZIndex()||0,R instanceof pr()){var I=R.getLayers();I&&T.unshift.apply(T,I.getArray())}}(function(F,N){for(var j=F.length,B=Array(F.length),U=0;U<j;U++)B[U]={index:U,value:F[U]};B.sort(function(ee,he){return N(ee.value,he.value)||ee.index-he.index});for(var G=0;G<F.length;G++)F[G]=B[G].value})(g,function(F,N){return S[Ce(F)]-S[Ce(N)]}),g.forEach(function(F){var N=Ce(F).toString(),j=f.layerMap[N];j&&j.forEach(function(B){f.raiseToTop(B)})})},h.raiseToTop=function(f){this.cesiumLayers_.raiseToTop(f)},m}(yr);$(830),$(582);var sl=$(63),kn=$.n(sl),ol=$(425),al=$.n(ol),ll=$(229),Bn=$.n(ll),cl=$(962),Un=$.n(cl),ul=$(253),$n=$(235),hl=$(988),dl=$.n(hl);const Kn=function(){function C(d,m){var h=new Cesium.BillboardCollection({scene:m}),f=new Cesium.PrimitiveCollection;this.olListenKeys=[],this.rootCollection_=new Cesium.PrimitiveCollection,this.context={projection:d,billboards:h,featureToCesiumMap:{},primitives:f},this.rootCollection_.add(h),this.rootCollection_.add(f)}var y=C.prototype;return y.destroy=function(){this.olListenKeys.forEach(lt.unByKey),this.olListenKeys.length=0},y.getRootPrimitive=function(){return this.rootCollection_},C}();function Zn(C,y){var d=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(d)return(d=d.call(C)).next.bind(d);if(Array.isArray(C)||(d=function(h,f){if(h){if(typeof h=="string")return qn(h,f);var g=Object.prototype.toString.call(h).slice(8,-1);if(g==="Object"&&h.constructor&&(g=h.constructor.name),g==="Map"||g==="Set")return Array.from(h);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return qn(h,f)}}(C))||y&&C&&typeof C.length=="number"){d&&(C=d);var m=0;return function(){return m>=C.length?{done:!0}:{done:!1,value:C[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qn(C,y){(y==null||y>C.length)&&(y=C.length);for(var d=0,m=new Array(y);d<y;d++)m[d]=C[d];return m}var fl=function(){function C(d){this.scene=d,this.boundOnRemoveOrClearFeatureListener_=this.onRemoveOrClearFeature_.bind(this),this.defaultBillboardEyeOffset_=new Cesium.Cartesian3(0,0,10)}var y=C.prototype;return y.onRemoveOrClearFeature_=function(d){var m=d.target,h=Ze.obj(m).olcs_cancellers;if(h){var f=d.feature;if(f){var g=Ce(f),S=h[g];S&&(S(),delete h[g])}else{for(var T in h)h.hasOwnProperty(T)&&h[T]();Ze.obj(m).olcs_cancellers={}}}},y.setReferenceForPicking=function(d,m,h){h.olLayer=d,h.olFeature=m},y.createColoredPrimitive=function(d,m,h,f,g,S){var T={flat:!0,renderState:{depthTest:{enabled:!0}}};S!==void 0&&(T.renderState||(T.renderState={}),T.renderState.lineWidth=S);var R,I=function(j,B){var U=new Cesium.GeometryInstance({geometry:j});return!B||B instanceof Cesium.ImageMaterialProperty||(U.attributes={color:Cesium.ColorGeometryInstanceAttribute.fromColor(B)}),U}(f,g);if(this.getHeightReference(d,m,h)===Cesium.HeightReference.CLAMP_TO_GROUND){var F=I.geometry.constructor;if(F&&!F.createShadowVolume)return null;R=new Cesium.GroundPrimitive({geometryInstances:I})}else R=new Cesium.Primitive({geometryInstances:I});if(g instanceof Cesium.ImageMaterialProperty){var N=g.image.getValue().toDataURL();R.appearance=new Cesium.MaterialAppearance({flat:!0,renderState:{depthTest:{enabled:!0}},material:new Cesium.Material({fabric:{type:"Image",uniforms:{image:N}}})})}else R.appearance=new Cesium.PerInstanceColorAppearance(T);return this.setReferenceForPicking(d,m,R),R},y.extractColorFromOlStyle=function(d,m){var h=d.getFill()?d.getFill().getColor():null,f=d.getStroke()?d.getStroke().getColor():null,g="black";return f&&m?g=f:h&&(g=h),we.convertColorToCesium(g)},y.extractLineWidthFromOlStyle=function(d){var m=d.getStroke()?d.getStroke().getWidth():void 0;return m!==void 0?m:1},y.wrapFillAndOutlineGeometries=function(d,m,h,f,g,S){var T=this.extractColorFromOlStyle(S,!1),R=this.extractColorFromOlStyle(S,!0),I=new Cesium.PrimitiveCollection;if(S.getFill()){var F=this.createColoredPrimitive(d,m,h,f,T);I.add(F)}if(S.getStroke()&&g){var N=this.extractLineWidthFromOlStyle(S),j=this.createColoredPrimitive(d,m,h,g,R,N);j&&I.add(j)}return I},y.addTextStyle=function(d,m,h,f,g){var S;if(g instanceof Cesium.PrimitiveCollection?S=g:(S=new Cesium.PrimitiveCollection).add(g),!f.getText())return S;var T=f.getText(),R=this.olGeometry4326TextPartToCesium(d,m,h,T);return R&&S.add(R),S},y.csAddBillboard=function(d,m,h,f,g,S){m.eyeOffset||(m.eyeOffset=this.defaultBillboardEyeOffset_);var T=d.add(m);return this.setReferenceForPicking(h,f,T),T},y.olCircleGeometryToCesium=function(d,m,h,f,g){var S=this,T=(h=we.olGeometryCloneTo4326(h,f)).getCenter(),R=T.length==3?T[2]:0,I=T.slice();I[0]+=h.getRadius(),T=we.ol4326CoordinateToCesiumCartesian(T),I=we.ol4326CoordinateToCesiumCartesian(I);var F,N,j=Cesium.Cartesian3.distance(T,I),B=new Cesium.CircleGeometry({center:T,radius:j,height:R});if(this.getHeightReference(d,m,h)===Cesium.HeightReference.CLAMP_TO_GROUND){var U=this.extractLineWidthFromOlStyle(g);if(U){var G=(0,ul.circular)(h.getCenter(),j),ee=we.ol4326CoordinateArrayToCsCartesians(G.getLinearRing(0).getCoordinates());if(pt(this.scene))(F=new Cesium.GroundPolylinePrimitive({geometryInstances:new Cesium.GeometryInstance({geometry:new Cesium.GroundPolylineGeometry({positions:ee,width:U})}),appearance:new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(m,g,!0)}),classificationType:Cesium.ClassificationType.TERRAIN})).readyPromise.then(function(){S.setReferenceForPicking(d,m,F._primitive)});else{var he=this.extractColorFromOlStyle(g,!0);F=this.createStackedGroundCorridors(d,m,U,he,ee)}}}else N=new Cesium.CircleOutlineGeometry({center:T,radius:j,extrudedHeight:R,height:R});var ke=this.wrapFillAndOutlineGeometries(d,m,h,B,N,g);return F&&ke.add(F),this.addTextStyle(d,m,h,g,ke)},y.createStackedGroundCorridors=function(d,m,h,f,g){Array.isArray(g[0])||(g=[g]),h=Math.max(3,h);for(var S=[],T=0,R=0,I=[1e3,4e3,16e3,64e3,254e3,1e6,1e7];R<I.length;R++){for(var F,N=I[R],j={width:h*=2.14,vertexFormat:Cesium.VertexFormat.POSITION_ONLY},B=Zn(g);!(F=B()).done;){var U=F.value;j.positions=U,S.push(new Cesium.GeometryInstance({geometry:new Cesium.CorridorGeometry(j),attributes:{color:Cesium.ColorGeometryInstanceAttribute.fromColor(f),distanceDisplayCondition:new Cesium.DistanceDisplayConditionGeometryInstanceAttribute(T,N-1)}}))}T=N}return new Cesium.GroundPrimitive({geometryInstances:S})},y.olLineStringGeometryToCesium=function(d,m,h,f,g){var S=this;h=we.olGeometryCloneTo4326(h,f);var T,R=we.ol4326CoordinateArrayToCsCartesians(h.getCoordinates()),I=this.extractLineWidthFromOlStyle(g),F=this.getHeightReference(d,m,h);if(F!==Cesium.HeightReference.CLAMP_TO_GROUND||pt(this.scene)){var N=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(m,g,!0)}),j={positions:R,width:I},B={appearance:N};if(F===Cesium.HeightReference.CLAMP_TO_GROUND){var U=new Cesium.GroundPolylineGeometry(j);B.geometryInstances=new Cesium.GeometryInstance({geometry:U}),(T=new Cesium.GroundPolylinePrimitive(B)).readyPromise.then(function(){S.setReferenceForPicking(d,m,T._primitive)})}else{j.vertexFormat=N.vertexFormat;var G=new Cesium.PolylineGeometry(j);B.geometryInstances=new Cesium.GeometryInstance({geometry:G}),T=new Cesium.Primitive(B)}}else{var ee=this.extractColorFromOlStyle(g,!0);T=this.createStackedGroundCorridors(d,m,I,ee,R)}return this.setReferenceForPicking(d,m,T),this.addTextStyle(d,m,h,g,T)},y.olPolygonGeometryToCesium=function(d,m,h,f,g){var S=this;h=we.olGeometryCloneTo4326(h,f);var T,R,I,F=this.getHeightReference(d,m,h);if(h.getCoordinates()[0].length==5&&m.getGeometry().get("olcs.polygon_kind")==="rectangle"){var N=h.getCoordinates()[0],j=(0,$n.boundingExtent)(N),B=Cesium.Rectangle.fromDegrees(j[0],j[1],j[2],j[3]),U=0;if(N[0].length==3)for(var G=0;G<N.length;G++)U=Math.max(U,N[G][2]);T=new Cesium.RectangleGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:B,height:U}),R=new Cesium.RectangleOutlineGeometry({ellipsoid:Cesium.Ellipsoid.WGS84,rectangle:B,height:U})}else{for(var ee=h.getLinearRings(),he={},ke=he,qe=0;qe<ee.length;++qe){var Mt=ee[qe].getCoordinates(),Nt=we.ol4326CoordinateArrayToCsCartesians(Mt);qe==0?he.positions=Nt:(he.holes||(he.holes=[]),he.holes.push({positions:Nt}))}if(T=new Cesium.PolygonGeometry({polygonHierarchy:ke,perPositionHeight:!0}),F===Cesium.HeightReference.CLAMP_TO_GROUND){var Rt=this.extractLineWidthFromOlStyle(g);if(Rt>0){var si=[he.positions];if(he.holes)for(var Cr=0;Cr<he.holes.length;++Cr)si.push(he.holes[Cr].positions);if(pt(this.scene)){for(var Xn,El=new Cesium.PolylineMaterialAppearance({material:this.olStyleToCesium(m,g,!0)}),Qn=[],Tl=Zn(si);!(Xn=Tl()).done;){var xl=Xn.value,Rl=new Cesium.GroundPolylineGeometry({positions:xl,width:Rt});Qn.push(new Cesium.GeometryInstance({geometry:Rl}))}var Pl={appearance:El,geometryInstances:Qn};(I=new Cesium.GroundPolylinePrimitive(Pl)).readyPromise.then(function(){S.setReferenceForPicking(d,m,I._primitive)})}else{var Il=this.extractColorFromOlStyle(g,!0);I=this.createStackedGroundCorridors(d,m,Rt,Il,si)}}}else R=new Cesium.PolygonOutlineGeometry({polygonHierarchy:he,perPositionHeight:!0})}var Jn=this.wrapFillAndOutlineGeometries(d,m,h,T,R,g);return I&&Jn.add(I),this.addTextStyle(d,m,h,g,Jn)},y.getHeightReference=function(d,m,h){var f=h.get("altitudeMode");f===void 0&&(f=m.get("altitudeMode")),f===void 0&&(f=d.get("altitudeMode"));var g=Cesium.HeightReference.NONE;return f==="clampToGround"?g=Cesium.HeightReference.CLAMP_TO_GROUND:f==="relativeToGround"&&(g=Cesium.HeightReference.RELATIVE_TO_GROUND),g},y.createBillboardFromImage=function(d,m,h,f,g,S,T,R){S instanceof Un()&&S.load();var I=S.getImage(1),F=function(){if(I&&(I instanceof HTMLCanvasElement||I instanceof Image||I instanceof HTMLImageElement)){var G,ee=h.getCoordinates(),he=we.ol4326CoordinateToCesiumCartesian(ee),ke=S.getOpacity();ke!==void 0&&(G=new Cesium.Color(1,1,1,ke));var qe=S.getScale(),Mt=this.getHeightReference(d,m,h),Nt={image:I,color:G,scale:qe,heightReference:Mt,position:he};if(Object.assign(Nt,m.get("cesiumOptions")),S instanceof Un()){var Rt=S.getAnchor();Rt&&(Nt.pixelOffset=new Cesium.Cartesian2((I.width/2-Rt[0])*qe,(I.height/2-Rt[1])*qe))}var si=this.csAddBillboard(T,Nt,d,m,h,g);R&&R(si)}}.bind(this);if(I instanceof Image&&!function(G){return G.src!=""&&G.naturalHeight!=0&&G.naturalWidth!=0&&G.complete}(I)){var N=!1,j=d.getSource();j.on(["removefeature","clear"],this.boundOnRemoveOrClearFeatureListener_);var B=Ze.obj(j).olcs_cancellers;B||(B=Ze.obj(j).olcs_cancellers={});var U=Ce(m);B[U]&&B[U](),B[U]=function(){N=!0},I.addEventListener("load",function G(){I.removeEventListener("load",G),T.isDestroyed()||N||F()})}else F()},y.olPointGeometryToCesium=function(d,m,h,f,g,S,T){h=we.olGeometryCloneTo4326(h,f);var R=null,I=g.getImage();if(I){var F=h.get("olcs_model")||m.get("olcs_model");if(F){var N=F(),j=Object.assign({},{scene:this.scene},N.cesiumOptions),B=Cesium.Model.fromGltf(j);(R=new Cesium.PrimitiveCollection).add(B),N.debugModelMatrix&&R.add(new Cesium.DebugModelMatrixPrimitive({modelMatrix:N.debugModelMatrix}))}else this.createBillboardFromImage(d,m,h,f,g,I,S,T)}return g.getText()?this.addTextStyle(d,m,h,g,R||new Cesium.Primitive):R},y.olMultiGeometryToCesium=function(d,m,h,f,g,S,T){var R,I=this,F=function(j,B){var U=new Cesium.PrimitiveCollection;return j.forEach(function(G){U.add(B(d,m,G,f,g))}),U};switch(h.getType()){case"MultiPoint":if(R=h.getPoints(),g.getText()){var N=new Cesium.PrimitiveCollection;return R.forEach(function(j){var B=I.olPointGeometryToCesium(d,m,j,f,g,S,T);B&&N.add(B)}),N}return R.forEach(function(j){I.olPointGeometryToCesium(d,m,j,f,g,S,T)}),null;case"MultiLineString":return F(R=h.getLineStrings(),this.olLineStringGeometryToCesium.bind(this));case"MultiPolygon":return F(R=h.getPolygons(),this.olPolygonGeometryToCesium.bind(this))}},y.olGeometry4326TextPartToCesium=function(d,m,h,f){var g=f.getText();if(!g)return null;var S=new Cesium.LabelCollection({scene:this.scene}),T=(0,$n.getCenter)(h.getExtent());if(h instanceof dl()){var R=h.getFirstCoordinate();T[2]=R.length==3?R[2]:0}var I={};I.position=we.ol4326CoordinateToCesiumCartesian(T),I.text=g,I.heightReference=this.getHeightReference(d,m,h);var F=f.getOffsetX(),N=f.getOffsetY();if(F!=0&&N!=0){var j=new Cesium.Cartesian2(F,N);I.pixelOffset=j}I.font=f.getFont()||"10px sans-serif";var B,U=void 0;switch(f.getFill()&&(I.fillColor=this.extractColorFromOlStyle(f,!1),U=Cesium.LabelStyle.FILL),f.getStroke()&&(I.outlineWidth=this.extractLineWidthFromOlStyle(f),I.outlineColor=this.extractColorFromOlStyle(f,!0),U=Cesium.LabelStyle.OUTLINE),f.getFill()&&f.getStroke()&&(U=Cesium.LabelStyle.FILL_AND_OUTLINE),I.style=U,f.getTextAlign()){case"left":B=Cesium.HorizontalOrigin.LEFT;break;case"right":B=Cesium.HorizontalOrigin.RIGHT;break;default:B=Cesium.HorizontalOrigin.CENTER}if(I.horizontalOrigin=B,f.getTextBaseline()){var G;switch(f.getTextBaseline()){case"top":case"alphabetic":G=Cesium.VerticalOrigin.TOP;break;case"middle":G=Cesium.VerticalOrigin.CENTER;break;case"bottom":case"hanging":G=Cesium.VerticalOrigin.BOTTOM}I.verticalOrigin=G}var ee=S.add(I);return this.setReferenceForPicking(d,m,ee),S},y.olStyleToCesium=function(d,m,h){var f=m.getFill(),g=m.getStroke();if(h&&!g||!h&&!f)return null;var S=h?g.getColor():f.getColor();return S=we.convertColorToCesium(S),h&&g.getLineDash()?Cesium.Material.fromType("Stripe",{horizontal:!1,repeat:500,evenColor:S,oddColor:new Cesium.Color(0,0,0,0)}):Cesium.Material.fromType("Color",{color:S})},y.computePlainStyle=function(d,m,h,f){var g=m.getStyleFunction(),S=null;return g&&(S=g(m,f)),!S&&h&&(S=h(m,f)),S?Array.isArray(S)?S:[S]:null},y.getGeometryFromFeature=function(d,m,h){if(h)return h;var f=d.get("olcs.3d_geometry");if(f&&f instanceof Bn())return f;if(m){var g=m.getGeometryFunction()(d);if(g instanceof Bn())return g}return d.getGeometry()},y.olFeatureToCesium=function(d,m,h,f,g){var S=this,T=this.getGeometryFromFeature(m,h,g);if(!T)return null;var R=f.projection,I=function(U){var G=f.featureToCesiumMap[Ce(m)];G instanceof Array?G.push(U):f.featureToCesiumMap[Ce(m)]=[U]};switch(T.getType()){case"GeometryCollection":var F=new Cesium.PrimitiveCollection;return T.getGeometries().forEach(function(U){if(U){var G=S.olFeatureToCesium(d,m,h,f,U);G&&F.add(G)}}),F;case"Point":var N=f.billboards,j=this.olPointGeometryToCesium(d,m,T,R,h,N,I);return j||null;case"Circle":return this.olCircleGeometryToCesium(d,m,T,R,h);case"LineString":return this.olLineStringGeometryToCesium(d,m,T,R,h);case"Polygon":return this.olPolygonGeometryToCesium(d,m,T,R,h);case"MultiPoint":case"MultiLineString":case"MultiPolygon":var B=this.olMultiGeometryToCesium(d,m,T,R,h,f.billboards,I);return B||null;case"LinearRing":throw new Error("LinearRing should only be part of polygon.");default:throw new Error("Ol geom type not handled : "+T.getType())}},y.olVectorLayerToCesium=function(d,m,h){var f=m.getProjection(),g=m.getResolution();if(g===void 0||!f)throw new Error("View not ready");var S=d.getSource();S instanceof kn()&&(S=S.getSource());for(var T=S.getFeatures(),R=new Kn(f,this.scene),I=R.context,F=0;F<T.length;++F){var N=T[F];if(N){var j=d.getStyleFunction(),B=this.computePlainStyle(d,N,j,g);if(B&&B.length){for(var U=null,G=0;G<B.length;G++){var ee=this.olFeatureToCesium(d,N,B[G],I);if(ee)if(U){if(ee)for(var he=0,ke=void 0;ke=ee.get(he);)U.add(ke),he++}else U=ee}U&&(h[Ce(N)]=U,R.getRootPrimitive().add(U))}}}return R},y.convert=function(d,m,h,f){var g=m.getProjection(),S=m.getResolution();if(S==null||!g)return null;var T=d.getStyleFunction(),R=this.computePlainStyle(d,h,T,S);if(!R||!R.length)return null;f.projection=g;for(var I=null,F=0;F<R.length;F++){var N=this.olFeatureToCesium(d,h,R[F],f);if(I){if(N)for(var j=0,B=void 0;B=N.get(j);)I.add(B),j++}else I=N}return I},C}();const gl=fl;function wr(C,y){return wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,m){return d.__proto__=m,d},wr(C,y)}const Hn=function(C){var y,d;function m(f,g,S){var T;return(T=C.call(this,f,g)||this).converter=S||new gl(g),T.csAllPrimitives_=new Cesium.PrimitiveCollection,g.primitives.add(T.csAllPrimitives_),T.csAllPrimitives_.destroyPrimitives=!1,T}d=C,(y=m).prototype=Object.create(d.prototype),y.prototype.constructor=y,wr(y,d);var h=m.prototype;return h.addCesiumObject=function(f){f.getRootPrimitive().counterpart=f,this.csAllPrimitives_.add(f.getRootPrimitive())},h.destroyCesiumObject=function(f){f.getRootPrimitive().destroy()},h.removeSingleCesiumObject=function(f,g){f.destroy(),this.csAllPrimitives_.destroyPrimitives=g,this.csAllPrimitives_.remove(f.getRootPrimitive()),this.csAllPrimitives_.destroyPrimitives=!1},h.removeAllCesiumObjects=function(f){if(this.csAllPrimitives_.destroyPrimitives=f,f)for(var g=0;g<this.csAllPrimitives_.length;++g)this.csAllPrimitives_.get(g).counterpart.destroy();this.csAllPrimitives_.removeAll(),this.csAllPrimitives_.destroyPrimitives=!1},h.updateLayerVisibility=function(f,g){var S=!0;[f.layer].concat(f.parents).forEach(function(T){var R=T.getVisible();R!==void 0?S&=R:S=!1}),g.show=S},h.createSingleLayerCounterparts=function(f){var g=this,S=f.layer;if(!(S instanceof al())||S instanceof Gn())return null;var T=S.getSource();if(T instanceof kn()&&(T=T.getSource()),!T)return null;var R=this.view,I={},F=this.converter.olVectorLayerToCesium(S,R,I),N=F.getRootPrimitive(),j=F.olListenKeys;[f.layer].concat(f.parents).forEach(function(G){j.push(ve(G,"change:visible",function(){g.updateLayerVisibility(f,N)}))}),this.updateLayerVisibility(f,N);var B=function(G){var ee=F.context,he=this.converter.convert(S,R,G,ee);he&&(I[Ce(G)]=he,N.add(he))}.bind(this),U=function(G){var ee=Ce(G),he=F.context,ke=he.featureToCesiumMap[ee];ke&&(delete he.featureToCesiumMap[ee],ke.forEach(function(Mt){Mt instanceof Cesium.Billboard&&he.billboards.remove(Mt)}));var qe=I[ee];delete I[ee],qe&&N.remove(qe)}.bind(this);return j.push(ve(T,"addfeature",function(G){B(G.feature)})),j.push(ve(T,"removefeature",function(G){U(G.feature)})),j.push(ve(T,"changefeature",function(G){var ee=G.feature;U(ee),B(ee)})),F?[F]:null},m}(yr);var ml=$(312);function pl(C,y){var d=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(d)return(d=d.call(C)).next.bind(d);if(Array.isArray(C)||(d=function(h,f){if(h){if(typeof h=="string")return Yn(h,f);var g=Object.prototype.toString.call(h).slice(8,-1);if(g==="Object"&&h.constructor&&(g=h.constructor.name),g==="Map"||g==="Set")return Array.from(h);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return Yn(h,f)}}(C))||y&&C&&typeof C.length=="number"){d&&(C=d);var m=0;return function(){return m>=C.length?{done:!0}:{done:!1,value:C[m++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yn(C,y){(y==null||y>C.length)&&(y=C.length);for(var d=0,m=new Array(y);d<y;d++)m[d]=C[d];return m}function vr(C,y){return vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,m){return d.__proto__=m,d},vr(C,y)}const yl=function(C){var y,d;function m(f){var g,S=f.parent;(g=C.call(this,S.getOptions())||this).scenePostRenderListenerRemover_=null,g.scene_=f.scene,g.synchronizer_=f.synchronizer,g.parent_=S,g.positionWGS84_=void 0,g.observer_=new MutationObserver(g.handleElementChanged.bind(function(R){if(R===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R}(g))),g.attributeObserver_=[],g.listenerKeys_=[];var T=function(R){return g.setPropertyFromEvent_(R)};return g.listenerKeys_.push(g.parent_.on("change:position",T)),g.listenerKeys_.push(g.parent_.on("change:element",T)),g.listenerKeys_.push(g.parent_.on("change:offset",T)),g.listenerKeys_.push(g.parent_.on("change:position",T)),g.listenerKeys_.push(g.parent_.on("change:positioning",T)),g.setProperties(g.parent_.getProperties()),g.handleMapChanged(),g.handleElementChanged(),g}d=C,(y=m).prototype=Object.create(d.prototype),y.prototype.constructor=y,vr(y,d);var h=m.prototype;return h.observeTarget_=function(f){if(this.observer_){this.observer_.disconnect(),this.observer_.observe(f,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),this.attributeObserver_.forEach(function(R){R.disconnect()}),this.attributeObserver_.length=0;for(var g=0;g<f.childNodes.length;g++){var S=f.childNodes[g];if(S.nodeType===1){var T=new MutationObserver(this.handleElementChanged.bind(this));T.observe(S,{attributes:!0,subtree:!0}),this.attributeObserver_.push(T)}}}},h.setPropertyFromEvent_=function(f){f.target&&f.key&&this.set(f.key,f.target.get(f.key))},h.getScene=function(){return this.scene_},h.handleMapChanged=function(){var f;this.scenePostRenderListenerRemover_&&(this.scenePostRenderListenerRemover_(),(f=this.element)&&f.parentNode&&f.parentNode.removeChild(f)),this.scenePostRenderListenerRemover_=null;var g=this.getScene();if(g){this.scenePostRenderListenerRemover_=g.postRender.addEventListener(this.updatePixelPosition.bind(this)),this.updatePixelPosition();var S=this.stopEvent?this.synchronizer_.getOverlayContainerStopEvent():this.synchronizer_.getOverlayContainer();this.insertFirst?S.insertBefore(this.element,S.childNodes[0]||null):S.appendChild(this.element)}},h.handlePositionChanged=function(){var f=this.getPosition();if(f){var g=this.parent_.getMap().getView().getProjection();this.positionWGS84_=(0,M.transform)(f,g,"EPSG:4326")}else this.positionWGS84_=void 0;this.updatePixelPosition()},h.handleElementChanged=function(){function f(I,F){var N=I.cloneNode();I.nodeName==="CANVAS"&&N.getContext("2d").drawImage(I,0,0),F&&F.appendChild(N),I.nodeType!=Node.TEXT_NODE&&N.addEventListener("click",function(U){I.dispatchEvent(new MouseEvent("click",U)),U.stopPropagation()});for(var j=I.childNodes,B=0;B<j.length;B++)j[B]&&f(j[B],N);return N}(function(I){for(;I.lastChild;)I.removeChild(I.lastChild)})(this.element);var g=this.getElement();if(g&&g.parentNode&&g.parentNode.childNodes)for(var S,T=pl(g.parentNode.childNodes);!(S=T()).done;){var R=f(S.value,null);this.element.appendChild(R)}g.parentNode&&this.observeTarget_(g.parentNode)},h.updatePixelPosition=function(){var f=this.positionWGS84_;if(this.scene_&&f){var g=0;if(f.length===2){var S=this.scene_.globe.getHeight(Cesium.Cartographic.fromDegrees(f[0],f[1]));S&&this.scene_.globe.tilesLoaded&&(f[2]=S),S&&(g=S)}else g=f[2];var T=Cesium.Cartesian3.fromDegrees(f[0],f[1],g),R=this.scene_.camera,I=new Cesium.BoundingSphere(new Cesium.Cartesian3,6356752);if(new Cesium.Occluder(I,R.position).isPointVisible(T))if(R.frustum.computeCullingVolume(R.position,R.direction,R.up).computeVisibility(new Cesium.BoundingSphere(T))===1){this.setVisible(!0);var F=this.scene_.cartesianToCanvasCoordinates(T),N=[F.x,F.y],j=[this.scene_.canvas.width,this.scene_.canvas.height];this.updateRenderedPosition(N,j)}else this.setVisible(!1);else this.setVisible(!1)}else this.setVisible(!1)},h.destroy=function(){this.scenePostRenderListenerRemover_&&this.scenePostRenderListenerRemover_(),this.observer_&&this.observer_.disconnect(),(0,lt.unByKey)(this.listenerKeys_),this.listenerKeys_.splice(0),this.element.removeNode?this.element.removeNode(!0):this.element.remove(),this.element=null},m}($.n(ml)()),_l=function(){function C(d,m){var h=this;this.map=d,this.overlays_=this.map.getOverlays(),this.scene=m,this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",["click","dblclick","mousedown","touchstart","MSPointerDown","pointerdown","mousewheel","wheel"].forEach(function(f){h.overlayContainerStopEvent_.addEventListener(f,function(g){return g.stopPropagation()})}),this.scene.canvas.parentElement.appendChild(this.overlayContainerStopEvent_),this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.scene.canvas.parentElement.appendChild(this.overlayContainer_),this.overlayMap_={}}var y=C.prototype;return y.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},y.getOverlayContainer=function(){return this.overlayContainer_},y.synchronize=function(){this.destroyAll(),this.addOverlays(),this.overlays_.on("add",this.addOverlayFromEvent_.bind(this)),this.overlays_.on("remove",this.removeOverlayFromEvent_.bind(this))},y.addOverlayFromEvent_=function(d){var m=d.element;this.addOverlay(m)},y.addOverlays=function(){var d=this;this.overlays_.forEach(function(m){d.addOverlay(m)})},y.addOverlay=function(d){if(d){var m=new yl({scene:this.scene,synchronizer:this,parent:d}),h=Ce(d).toString();this.overlayMap_[h]=m}},y.removeOverlayFromEvent_=function(d){var m=d.element;this.removeOverlay(m)},y.removeOverlay=function(d){var m=Ce(d).toString(),h=this.overlayMap_[m];h&&(h.destroy(),delete this.overlayMap_[m])},y.destroyAll=function(){var d=this;Object.keys(this.overlayMap_).forEach(function(m){d.overlayMap_[m].destroy(),delete d.overlayMap_[m]})},C}();function wl(C,y){for(var d=0;d<y.length;d++){var m=y[d];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(C,m.key,m)}}const Sr=function(){function C(h){this.autoRenderLoop_=null,this.map_=h.map,this.time_=h.time||function(){return Cesium.JulianDate.now()},this.to4326Transform_=(0,M.getTransform)(this.map_.getView().getProjection(),"EPSG:4326"),this.resolutionScale_=1,this.canvasClientWidth_=0,this.canvasClientHeight_=0,this.resolutionScaleChanged_=!0;var f="position:absolute;top:0;left:0;width:100%;height:100%;";this.container_=document.createElement("DIV");var g=document.createAttribute("style");g.value=f+"visibility:hidden;",this.container_.setAttributeNode(g);var S=h.target||this.map_.getViewport();if(typeof S=="string"&&(S=document.getElementById(S)),S.appendChild(this.container_),this.isOverMap_=!h.target,this.isOverMap_&&h.stopOpenLayersEventsPropagation)for(var T=["click","dblclick","mousedown","touchstart","MSPointerDown","pointerdown","mousewheel","wheel"],R=0,I=T.length;R<I;++R)this.container_.addEventListener(T[R],function(ee){return ee.stopPropagation()});this.canvas_=document.createElement("CANVAS");var F=document.createAttribute("style");F.value=f,this.canvas_.setAttributeNode(F),Ze.supportsImageRenderingPixelated()&&(this.canvas_.style.imageRendering=Ze.imageRenderingValue()),this.canvas_.oncontextmenu=function(){return!1},this.canvas_.onselectstart=function(){return!1},this.container_.appendChild(this.canvas_),this.enabled_=!1,this.pausedInteractions_=[],this.hiddenRootGroup_=null;var N=h.sceneOptions!==void 0?h.sceneOptions:{};N.canvas=this.canvas_,N.scene3DOnly=!0,this.scene_=new Cesium.Scene(N);var j=this.scene_.screenSpaceCameraController;j.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.SHIFT}),j.tiltEventTypes.push({eventType:Cesium.CameraEventType.LEFT_DRAG,modifier:Cesium.KeyboardEventModifier.ALT}),j.enableLook=!1,this.scene_.camera.constrainedAxis=Cesium.Cartesian3.UNIT_Z,this.camera_=new rl(this.scene_,this.map_),this.globe_=new Cesium.Globe(Cesium.Ellipsoid.WGS84),this.globe_.baseColor=Cesium.Color.WHITE,this.scene_.globe=this.globe_,this.scene_.skyAtmosphere=new Cesium.SkyAtmosphere;var B=new Cesium.SingleTileImageryProvider({url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",rectangle:Cesium.Rectangle.fromDegrees(0,0,1,1)});this.globe_.imageryLayers.addImageryProvider(B,0),this.dataSourceCollection_=new Cesium.DataSourceCollection,this.dataSourceDisplay_=new Cesium.DataSourceDisplay({scene:this.scene_,dataSourceCollection:this.dataSourceCollection_});var U=h.createSynchronizers?h.createSynchronizers(this.map_,this.scene_,this.dataSourceCollection_):[new jn(this.map_,this.scene_),new Hn(this.map_,this.scene_),new _l(this.map_,this.scene_)];this.handleResize_();for(var G=U.length-1;G>=0;--G)U[G].synchronize();this.lastFrameTime_=0,this.renderId_=void 0,this.targetFrameRate_=Number.POSITIVE_INFINITY,this.blockCesiumRendering_=!1,this.warmingUp_=!1,this.trackedFeature_=null,this.trackedEntity_=null,this.entityView_=null,this.needTrackedEntityUpdate_=!1,this.boundingSphereScratch_=new Cesium.BoundingSphere,new Cesium.EventHelper().add(this.scene_.postRender,C.prototype.updateTrackedEntity_,this),Cesium.Camera.enableSuspendTerrainAdjustment=!1}var y,d,m=C.prototype;return m.render_=function(){this.renderId_!==void 0&&(cancelAnimationFrame(this.renderId_),this.renderId_=void 0),!this.enabled_&&!this.warmingUp_||this.blockCesiumRendering_||(this.renderId_=requestAnimationFrame(this.onAnimationFrame_.bind(this)))},m.onAnimationFrame_=function(h){this.renderId_=void 0;var f=1e3/this.targetFrameRate_;if(h-this.lastFrameTime_<f)this.render_();else{this.lastFrameTime_=h;var g=this.time_();if(this.scene_.initializeFrame(),this.handleResize_(),this.dataSourceDisplay_.update(g),this.entityView_){var S=this.trackedEntity_;this.dataSourceDisplay_.getBoundingSphere(S,!1,this.boundingSphereScratch_)===Cesium.BoundingSphereState.DONE&&(this.boundingSphereScratch_.radius=1,this.entityView_.update(g,this.boundingSphereScratch_))}this.scene_.render(g),this.camera_.checkCameraChange(),this.render_()}},m.updateTrackedEntity_=function(){if(this.needTrackedEntityUpdate_){var h=this.trackedEntity_,f=this.scene_,g=this.dataSourceDisplay_.getBoundingSphere(h,!1,this.boundingSphereScratch_);if(g!==Cesium.BoundingSphereState.PENDING){f.screenSpaceCameraController.enableTilt=!1;var S=g!==Cesium.BoundingSphereState.FAILED?this.boundingSphereScratch_:void 0;S&&(S.radius=1),this.entityView_=new Cesium.EntityView(h,f,f.mapProjection.ellipsoid),this.entityView_.update(this.time_(),S),this.needTrackedEntityUpdate_=!1}}},m.handleResize_=function(){var h=this.canvas_.clientWidth,f=this.canvas_.clientHeight;if(!(h===0|f===0)&&(h!==this.canvasClientWidth_||f!==this.canvasClientHeight_||this.resolutionScaleChanged_)){var g=this.resolutionScale_;Ze.supportsImageRenderingPixelated()||(g*=window.devicePixelRatio||1),this.resolutionScaleChanged_=!1,this.canvasClientWidth_=h,this.canvasClientHeight_=f,h*=g,f*=g,this.canvas_.width=h,this.canvas_.height=f,this.scene_.camera.frustum.aspectRatio=h/f}},m.getCamera=function(){return this.camera_},m.getOlMap=function(){return this.map_},m.getOlView=function(){return this.map_.getView()},m.getCesiumScene=function(){return this.scene_},m.getDataSources=function(){return this.dataSourceCollection_},m.getDataSourceDisplay=function(){return this.dataSourceDisplay_},m.getEnabled=function(){return this.enabled_},m.setEnabled=function(h){var f,g=this;if(this.enabled_!==h)if(this.enabled_=h,this.container_.style.visibility=this.enabled_?"visible":"hidden",this.enabled_){if(this.throwOnUnitializedMap_(),this.isOverMap_){(f=this.map_.getInteractions()).forEach(function(T,R,I){g.pausedInteractions_.push(T)}),f.clear(),this.map_.addInteraction=function(T){return g.pausedInteractions_.push(T)},this.map_.removeInteraction=function(T){return g.pausedInteractions_=g.pausedInteractions_.filter(function(R){return R!==T})};var S=this.map_.getLayerGroup();S.getVisible()&&(this.hiddenRootGroup_=S,this.hiddenRootGroup_.setVisible(!1)),this.map_.getOverlayContainer().classList.add("olcs-hideoverlay")}this.camera_.readFromView(),this.render_()}else this.isOverMap_&&(f=this.map_.getInteractions(),this.pausedInteractions_.forEach(function(T){f.push(T)}),this.pausedInteractions_.length=0,this.map_.addInteraction=function(T){return g.map_.getInteractions().push(T)},this.map_.removeInteraction=function(T){return g.map_.getInteractions().remove(T)},this.map_.getOverlayContainer().classList.remove("olcs-hideoverlay"),this.hiddenRootGroup_&&(this.hiddenRootGroup_.setVisible(!0),this.hiddenRootGroup_=null)),this.camera_.updateView()},m.warmUp=function(h,f){var g=this;if(!this.enabled_){this.throwOnUnitializedMap_(),this.camera_.readFromView();var S=this.globe_.ellipsoid,T=this.scene_.camera,R=S.cartesianToCartographic(T.position);R.height<h&&(R.height=h,T.position=S.cartographicToCartesian(R)),this.warmingUp_=!0,this.render_(),setTimeout(function(){g.warmingUp_=!1},f)}},m.setBlockCesiumRendering=function(h){this.blockCesiumRendering_!==h&&(this.blockCesiumRendering_=h,this.render_())},m.enableAutoRenderLoop=function(){this.autoRenderLoop_||(this.autoRenderLoop_=new tl(this))},m.getAutoRenderLoop=function(){return this.autoRenderLoop_},m.setResolutionScale=function(h){(h=Math.max(0,h))!==this.resolutionScale_&&(this.resolutionScale_=Math.max(0,h),this.resolutionScaleChanged_=!0,this.autoRenderLoop_&&this.autoRenderLoop_.restartRenderLoop())},m.setTargetFrameRate=function(h){this.targetFrameRate_!==h&&(this.targetFrameRate_=h,this.render_())},m.throwOnUnitializedMap_=function(){var h=this.map_.getView(),f=h.getCenter();if(!h.isDef()||isNaN(f[0])||isNaN(f[1]))throw new Error("The OpenLayers map is not properly initialized: "+f+" / "+h.getResolution())},y=C,(d=[{key:"trackedFeature",get:function(){return this.trackedFeature_},set:function(h){if(this.trackedFeature_!==h){var f=this.scene_;if(!h||!h.getGeometry())return this.needTrackedEntityUpdate_=!1,f.screenSpaceCameraController.enableTilt=!0,this.trackedEntity_&&this.dataSourceDisplay_.defaultDataSource.entities.remove(this.trackedEntity_),this.trackedEntity_=null,this.trackedFeature_=null,this.entityView_=null,void f.camera.lookAtTransform(Cesium.Matrix4.IDENTITY);this.trackedFeature_=h,this.needTrackedEntityUpdate_=!0;var g=this.to4326Transform_,S={position:new Cesium.CallbackProperty(function(T,R){return I=h.getGeometry().getCoordinates(),F=g(I,void 0,I.length),we.ol4326CoordinateToCesiumCartesian(F);var I,F},!1),point:{pixelSize:1,color:Cesium.Color.TRANSPARENT}};this.trackedEntity_=this.dataSourceDisplay_.defaultDataSource.entities.add(S)}}}])&&wl(y.prototype,d),Object.defineProperty(y,"prototype",{writable:!1}),C}();var Wn=function(){function C(y){this.promise,this.url_=y}return C.prototype.load=function(){var y=this;return this.promise||(this.promise=new Promise(function(d,m){var h=document.createElement("script");h.onload=function(){return d()},h.onerror=function(){return m()},document.head.appendChild(h),h.src=y.url_})),this.promise},C}();function Ai(C,y,d){return Ai=vl()?Reflect.construct.bind():function(m,h,f){var g=[null];g.push.apply(g,h);var S=new(Function.bind.apply(m,g));return f&&Oi(S,f.prototype),S},Ai.apply(null,arguments)}function vl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Oi(C,y){return Oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(d,m){return d.__proto__=m,d},Oi(C,y)}const Sl=function(C){var y,d;function m(f,g){var S,T=g===void 0?{}:g,R=T.map,I=T.cameraExtentInRadians,F=T.cesiumIonDefaultAccessToken;return(S=C.call(this)||this).cesiumUrl_=f,S.map=R,S.cameraExtentInRadians=I||null,S.boundingSphere_,S.blockLimiter_=!1,S.promise_,S.cesiumIonDefaultAccessToken_=F,S.ol3d,S.cesiumInitialTilt_=Ft(50),S.fogDensity=1e-4,S.fogSSEFactor=25,S.minimumZoomDistance=2,S.maximumZoomDistance=1e7,S.limitCameraToBoundingSphereRatio=function(N){return N>3e3?9:3},S}d=C,(y=m).prototype=Object.create(d.prototype),y.prototype.constructor=y,Oi(y,d);var h=m.prototype;return h.load=function(){var f=this;if(!this.promise_){var g=new Wn(this.cesiumUrl_);this.promise_=g.load().then(function(){return f.onCesiumLoaded()})}return this.promise_},h.onCesiumLoaded=function(){if(this.cameraExtentInRadians){var f=Ai(Cesium.Rectangle,this.cameraExtentInRadians);Cesium.Camera.DEFAULT_VIEW_RECTANGLE=f,this.boundingSphere_=Cesium.BoundingSphere.fromRectangle3D(f,Cesium.Ellipsoid.WGS84,300)}this.cesiumIonDefaultAccessToken_&&(Cesium.Ion.defaultAccessToken=this.cesiumIonDefaultAccessToken_),this.ol3d=this.instantiateOLCesium();var g=this.ol3d.getCesiumScene();return this.configureForUsability(g),this.configureForPerformance(g),this.dispatchEvent("load"),this.ol3d},h.instantiateOLCesium=function(){var f=new Sr({map:this.map}),g=f.getCesiumScene(),S=Cesium.createWorldTerrain();return g.terrainProvider=S,f},h.configureForPerformance=function(f){var g=f.fog;g.enabled=!0,g.density=this.fogDensity,g.screenSpaceErrorFactor=this.fogSSEFactor},h.configureForUsability=function(f){var g=f.screenSpaceCameraController;g.minimumZoomDistance=this.minimumZoomDistance,g.maximumZoomDistance=this.maximumZoomDistance,f.globe.depthTestAgainstTerrain=!0,f.globe.baseColor=Cesium.Color.WHITE,f.backgroundColor=Cesium.Color.WHITE,this.boundingSphere_&&f.postRender.addEventListener(this.limitCameraToBoundingSphere.bind(this),f),this.ol3d.enableAutoRenderLoop()},h.limitCameraToBoundingSphere=function(){var f=this;if(this.boundingSphere_&&!this.blockLimiter_){var g=this.ol3d.getCesiumScene().camera,S=g.position,T=Cesium.Cartographic.fromCartesian(S),R=this.limitCameraToBoundingSphereRatio(T.height);if(Cesium.Cartesian3.distance(this.boundingSphere_.center,S)>this.boundingSphere_.radius*R){if(g.flying===!0)return;this.blockLimiter_=!0;var I=function(){return f.blockLimiter_=!1};g.flyToBoundingSphere(this.boundingSphere_,{complete:I,cancel:I})}}},h.toggle3d=function(){var f=this;return this.load().then(function(g){var S=g.getEnabled(),T=g.getCesiumScene();return S?we.resetToNorthZenith(f.map,T).then(function(){g.setEnabled(!1),f.dispatchEvent("toggle")}):(g.setEnabled(!0),f.dispatchEvent("toggle"),we.rotateAroundBottomCenter(T,f.cesiumInitialTilt_))})},h.set3dWithView=function(f,g,S,T,R){var I=this;return this.load().then(function(F){var N=F.getEnabled(),j=F.getCesiumScene().camera,B=Cesium.Cartesian3.fromDegrees(f,g,S),U={heading:Cesium.Math.toRadians(T),pitch:Cesium.Math.toRadians(R),roll:0};N||(F.setEnabled(!0),I.dispatchEvent("toggle")),j.setView({destination:B,orientation:U})})},h.is3dEnabled=function(){return!!this.ol3d&&this.ol3d.getEnabled()},h.getHeading=function(){return this.map&&this.map.getView().getRotation()||0},h.getTiltOnGlobe=function(){var f=this.ol3d.getCesiumScene();return-we.computeSignedTiltAngleOnGlobe(f)},h.setHeading=function(f){var g=this.ol3d.getCesiumScene(),S=we.pickBottomPoint(g);S&&we.setHeadingUsingBottomCenter(g,f,S)},h.getOl3d=function(){return this.ol3d},h.getOlView=function(){return this.map.getView()},h.getCesiumViewMatrix=function(){return this.ol3d.getCesiumScene().camera.viewMatrix},h.getCesiumScene=function(){return this.ol3d.getCesiumScene()},h.flyToRectangle=function(f,g){var S=this;g===void 0&&(g=0);var T=this.getCesiumScene().camera,R=T.getRectangleCameraCoordinates(f),I=Cesium.Cartesian3.magnitude(R)+g;return Cesium.Cartesian3.normalize(R,R),Cesium.Cartesian3.multiplyByScalar(R,I,R),new Promise(function(F,N){S.cameraExtentInRadians?T.flyTo({destination:R,complete:function(){return F()},cancel:function(){return N()},endTransform:Cesium.Matrix4.IDENTITY}):N()})},h.getCameraExtentRectangle=function(){if(this.cameraExtentInRadians)return Ai(Cesium.Rectangle,this.cameraExtentInRadians)},m}(il()),Cl=Sr;var tt=window.olcs={};tt.OLCesium=Sr,tt.AbstractSynchronizer=yr,tt.RasterSynchronizer=jn,tt.VectorSynchronizer=Hn,tt.core=we,tt.core.OLImageryProvider=Fn,tt.core.VectorLayerCounterpart=Kn,tt.contrib={},tt.contrib.LazyLoader=Wn,tt.contrib.Manager=Sl})(),et})())})(Hf);const lm=ru(nn);const cm=We("br",null,null,-1),um=We("br",null,null,-1),hm=We("br",null,null,-1),dm=We("br",null,null,-1),fm=We("br",null,null,-1),gm=We("br",null,null,-1),mm=nu('<div id="openlayer-map" tabindex="0" class="openlayer-map"></div><div id="overiew-map" class="overiew-map"></div><div id="anchor"><img src="'+_f+'" alt="示例锚点"></div><div id="popup" class="ol-popup"><a href="#" id="popup-closer" class="ol-popup-closer"></a><div id="popup-content"></div></div>',4),Vr=Ri(""),jr=Ri(""),kr=Ri(""),Br=Ri(""),Ur=Ri(""),pm=[{label:"OSM",value:"OSM",state:!0},{label:"Stamen",value:"Stamen",state:!0},{label:"天地图(XYZ)",value:"http://t{0-7}.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=12c00f9a0d966a5f834e00fe91e4bb3e",state:!0},{label:"OSM(XYZ)",value:"http://{a-c}.tile.openstreetemp.org/{z}/{x}/{y}.png",state:!1},{label:"高德地图",value:"http://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",state:!0}],ym=[{label:"park_roads3",value:"./src/data/park_roads3.json"},{label:"test",value:"./src/data/test.json"},{label:"park-location-1",value:"./src/data/park-location-1.json"},{label:"park-location-2",value:"./src/data/park-location-2.json"},{label:"my-park-20230202-2234",value:"./src/data/my-park-20230202-2234.json"},{label:"停车场",value:"./src/data/停车场.json"},{label:"停车场(1)",value:"./src/data/停车场(1).json"},{label:"停车场(2)",value:"./src/data/停车场(2).json"},{label:"停车场-location",value:"./src/data/停车场-location.json"},{label:"my-park-0206-1",value:"./src/data/my-park-0206-1.json"},{label:"TEST_V1_P_WKS_LAYER_DOWN3",value:"./src/data/TEST_V1_P_WKS_LAYER_DOWN3.json"},{label:"TEST_V0_PARK_SIMPLE",value:"./src/data/TEST_V0_PARK_SIMPLE.json"}],_m=[{label:"681675333451_.pic.jpg",value:"./src/image/681675333451_.pic.jpg"}],wm=[{label:"地理经纬度(投影坐标系)",value:"EPSG:4326",state:!1},{label:"Web墨卡托(投影坐标系)",value:"X-EPSG:3857",state:!1},{label:"EPSG:3857(大坐标)",value:"EPSG:3857",state:!0},{label:"EPSG:4326(小坐标)",value:"EPSG:4326",state:!0},{label:"EPSG:4490(中国大地2000)",value:"EPSG:4490",state:!1}];new Ee({text:new Ki({font:'bold 11px "Open Sans"',placement:"line",fill:new Be({color:"black"})})});const vm={Point:[new Ee({image:new Zi({radius:5,fill:null,stroke:new ot({color:"rgb(67, 189, 67)",width:1})})})],MultiPoint:[new Ee({image:new Zi({radius:5,fill:null,stroke:new ot({color:"rgb(67, 189, 67)",width:1})})})],LineString:[new Ee({fill:new Be({color:"#f40"}),stroke:new ot({color:"rgb(25, 189, 14)",width:1})})],MultiLineString:[new Ee({fill:new Be({color:"#f40"}),stroke:new ot({color:"rgb(25, 189, 14)",width:1})})],Polygon:[new Ee({fill:new Be({color:"#f40"}),stroke:new ot({color:"blue",lineDash:[4],width:3})})],MultiPolygon:[new Ee({stroke:new ot({color:"yellow",width:1}),fill:new Be({color:"#f40"})})]},$r=function(n,e){var t=JSON.parse(n.values_.properties).Text;return console.log(t),t!=null&&t!=null?new Ee({text:new Ki({font:"bold 6px Arial",fill:new Be({color:"blue"}),text:t+"",textAlign:"center"})}):vm[n.getGeometry().getType()]},Sm=[{label:"无",value:"None"},{value:"Point",label:"点"},{value:"LineString",label:"线"},{value:"Polygon",label:"面"},{value:"Circle",label:"圆"},{label:"正方形",value:"Square"},{label:"长方形",value:"Box"}];var bt=null;const Cm={data(){return{optionBox:!0,mapInfo:{},key:"xxx",currentCoordinateType:"EPSG:3857",map:"",view:"",tileLayer:"",vectorLayer:"",drawLayer:"",center:[],location1:"107",location2:"57",interactionSwitch:!0,draw:"",drawSwitch:!1,wfsVectorLayer:null,modifySwitch:!1,startToEnd:[],roadLayer:"",startLayer:"",endLayer:"",checkRoadSwitch:!1}},mounted(){this.view=new fi({projection:"EPSG:4326",center:[0,0],zoom:2,maxZoom:30,minZoom:1}),this.map=new Wr({controls:[],interactions:Rr(),target:"openlayer-map",layers:[],view:this.view}),this.center=ut([this.location1,this.location2],"EPSG:4326",this.currentCoordinateType),console.log(this.center),this.map.on("singleclick",n=>{console.log(n.coordinate)})},watch:{location1:function(){this.center=ut([this.location1,this.location2],"EPSG:4326",this.currentCoordinateType),console.log(this.center)},location2:function(){this.center=ut([this.location1,this.location2],"EPSG:4326",this.currentCoordinateType),console.log(this.center)}},methods:{printMapInfo(){this.mapInfo.projection=this.view.getProjection().getCode(),this.mapInfo.layerCount=this.map.getLayers().getLength(),this.mapInfo.zoom=this.view.getZoom(),this.mapInfo.resolution=this.view.getResolution(),console.log(this.map),console.log(this.view)},changeCoordinateType(n){this.center=ut([this.location1,this.location2],"EPSG:4326",n),console.log(this.center),this.currentCoordinateType=n,console.log(n),this.view=new fi({projection:n,center:this.center,zoom:1,maxZoom:30,minZoom:1}),this.map.setView(this.view),this.map.render()},changeTileLayer(n){n==="OSM"?this.tileLayer=new Bt({source:new Bi}):n==="Stamen"?this.tileLayer=new Bt({source:new la({layer:"watercolor"})}):this.tileLayer=new Bt({source:new xi({url:n,crossOrigin:"anonymous",wrapX:!1})}),this.map.removeLayer(this.map.getLayers().item(0)),this.map.addLayer(this.tileLayer)},doTileGird(){var n=new Bt({source:new ca({projection:this.currentCoordinateType,tileGrid:new Bi().getTileGrid()})});this.map.addLayer(n)},changeVectorLayer(n){new Ee({text:new Ki({font:'bold 11px "Open Sans"',placement:"line",fill:new Be({color:"black"})})}),console.log(n),this.vectorLayer=new Me({source:new Ae({format:new oi,url:n,wrapX:!1}),style:$r}),this.map.addLayer(this.vectorLayer),this.view.setCenter(this.center),this.view.animate({center:this.center,duration:2e3,zoom:10}),this.map.render()},changeImageLayer(n){console.log(n);var e=[center[0]-1216*1e3/2,center[1]-870*1e3/2,center[0]+1216*1e3/2,center[1]+870*1e3/2];this.imageLayer=new pi({source:new Tn({url:n,imageExtent:e})}),this.view.setCenter(this.center),this.view.setZoom(7),this.map.addLayer(this.imageLayer),this.map.render()},doLabel(){},doMousePosition(){this.map.addControl(new ff)},doOverviewMap(){this.map.addControl(new yf({target:"overiew-map",collapsed:!1}))},doFullScreen(){var n=new Xc;this.map.addControl(n)},testZoom(){var n=new Qc;this.map.addControl(n);var e=new Jc({extent:[131e5,-829e4,132e5,-821e4]});this.map.addControl(e)},doLocation(){console.log(this.center),this.view.setCenter(this.center),this.view.animate({center:this.center,duration:2e3,zoom:10}),this.map.render()},doFit(){var n=[104,30.6,104.12,30.74],e=ut([n[0],n[1]],"EPSG:4326",this.currentCoordinateType),t=ut([n[2],n[3]],"EPSG:4326",this.currentCoordinateType);this.view.fit([e[0],e[1],t[0],t[1]])},switchInteraction(){this.interactionSwitch?(this.map.interactions=Rr({doubleClickZoom:!1,mouseWheelZoom:!1,shiftDragZoom:!1,pinchZoom:!1}),console.log("close")):(this.map.interactions=Rr(),console.log("open")),this.interactionSwitch=!this.interactionSwitch,this.map.render()},doInsertImageOld(){var n=new er({element:document.getElementById("anchor")});n.setPosition(this.center),this.map.addOverlay(n)},doInsertImage(){var n=new Me({source:new Ae}),e=new nt({geometry:new He(this.center)});e.setStyle(new Ee({image:new ai({src:"../定位.png",anchor:[0,0]})})),n.getSource().addFeature(e),this.map.addLayer(n),this.view.setCenter(this.center),this.map.render(),this.view.on("change:resolution",function(){var t=e.getStyle();t.getImage().setScale(this.getZoom()/10),e.setStyle(t)})},doInsertRegularShape(){var n=new Me({source:new Ae}),e=new nt({geometry:new He(this.center)});e.setStyle(new Ee({image:new ys({points:5,radius1:20,radius2:10,stroke:new ot({color:"red",size:2}),fill:new Be({color:"blue"})})})),n.getSource().addFeature(e),this.map.addLayer(n),this.view.setCenter(this.center),this.view.setZoom(16),this.map.render()},doInsertCanvas(){var n=new Me({source:new Ae}),e=document.createElement("canvas");e.width=20,e.height=20;var t=e.getContext("2d");t.strokeStyle="red",t.lineWidth=1,t.beginPath(),t.moveTo(0,0),t.lineTo(20,10),t.lineTo(0,20),t.lineTo(10,10),t.lineTo(0,0),t.stroke();var i=new Ee({image:new ai({img:e,imgSize:[e.width,e.height],rotation:90*Math.PI/180})}),r=new nt({geometry:new He(this.center)});r.setStyle(i),n.getSource().addFeature(r),this.map.addLayer(n),this.view.setCenter(this.center),this.view.setZoom(16),this.map.render()},doInsertText(){var n=new Me({source:new Ae}),e=new nt({geometry:new He(this.center)});e.setStyle(new Ee({text:new Ki({text:"我的位置",fill:new Be({color:"red"})})})),n.getSource().addFeature(e),this.map.addLayer(n),this.view.setCenter(this.center),this.view.setZoom(16),this.map.render()},doStyleFunction(){var n=this.map,e=new Me({source:new Ae}),t=new nt({geometry:new He(this.center)});t.setStyle(function(i){return[new Ee({image:new ai({src:"../定位.png",scale:n.getView().getZoom()/10})})]}),e.getSource().addFeature(t),this.map.addLayer(e),this.view.setCenter(this.center),this.view.setZoom(16),this.map.render()},doMultiMark(){for(var n=new Me({source:new Ae}),e=new Ee({image:new ai({src:"../定位.png"})}),t=[],i=0;i<35;i++){var r=new nt({geometry:new He(ut([i*10-175,0],"EPSG:4326",this.currentCoordinateType))});r.setStyle(e),t.push(r)}n.getSource().addFeatures(t),this.map.addLayer(n),this.map.render()},doOpenClickTopic(){var n=document.getElementById("popup"),e=document.getElementById("popup-content");document.getElementById("popup-closer");var t=new er({element:n,autoPan:!0,autoPanAnimation:{duration:250}}),i=r=>{var s=r.coordinate,o=Mc(s);e.innerHTML="<p>You clicked here:</p><code>"+o+"</code>",t.setPosition(s),this.map.un("singleclick",i)};this.map.on("singleclick",i),this.map.addOverlay(t)},doFeatureStyle(){var n=new Me({source:new Ae}),e=new Me({source:new Ae}),t=new nt({geometry:new He(this.center)});t.setStyle(new Ee({image:new Zi({radius:10,fill:new Be({color:"red"})})}));var i=new nt({geometry:new He([this.center])});i.setStyle(new Ee({image:new ys({points:5,radius1:20,radius2:10,fill:new Be({color:"red"})})})),n.getSource().addFeature(t),e.getSource().addFeature(i);var r=new _s({condition:Fc,style:new Ee({image:new Zi({radius:10,fill:new Be({color:"blue"})})}),filter:function(s,o){return o===n}});this.map.addInteraction(r),r.on("select"),this.map.addLayer(n),this.map.addLayer(e),this.view.setCenter(this.center),this.view.setZoom(16),this.map.render()},changeDraw(n){console.log(n),this.map.removeInteraction(this.draw),this.addInteraction(n)},doStartDraw(){this.drawLayer=new Me({source:new Ae({wrapX:!1})}),this.map.addLayer(this.drawLayer)},addInteraction(n){if(n!=="None"){var e,t;n==="Square"?(n="Circle",e=iu(4)):n==="Box"&&(n="LineString",t=2,e=function(i,r){var s=i[0],o=i[1];return r||(r=new or([[s,[s[0],o[1]],o,[o[0],s[1]],s]])),r.setCoordinates([[s,[s[0],o[1]],o,[o[0],s[1]],s]]),r}),this.draw=new eu({source:this.drawLayer.getSource(),type:n,geometryFunction:e,maxPoints:t}),this.draw.on("drawend",function(i){alert(i.feature.getGeometry().getCoordinates())}),this.map.addInteraction(this.draw)}},doLoadGeoServer(){this.vectorLayer=new Me({source:new Ae({format:new oi,url:"http://localhost:8080/geoserver/ows?service=WFS&version=1.1.0&request=GetFeature&typeName=test_park:park_roads3&maxFeatures=50&outputFormat=application/json&srsname=EPSG:4326"})}),this.map.addLayer(this.vectorLayer),this.map.render()},doModifyGeoServer(){var n=new _s({style:new Ee({stroke:new ot({color:"green",width:2})})});this.map.addInteraction(n);var e=new tu({style:new Ee({stroke:new ot({color:"red",width:5})}),features:n.getFeatures()});this.map.addInteraction(e),this.modifySwitch?(this.map.removeInteraction(n),this.map.removeInteraction(e)):e.on("modifyend",function(t){console.log(t.features),bt=t.features,console.log(bt)}),this.modifySwitch=!this.modifySwitch},doSaveGeoServer(){if(console.log(bt),bt&&bt.getLength()>0){var n=bt.item(0).clone();n.setId(bt.item(0).getId()),n.getGeometry().applyTransform(function(e,t,i){for(var r=0;r<e.length;r+=i){var s=e[r],o=e[r+1];e[r]=o,e[r+1]=s}}),this.modifyWFS([n])}},modifyWFS(n){console.log("y");var e=new qf,t=e.writeTransaction(null,n,null,{featureType:"test_park_wks_road_split",featureNS:"http://geoserver.org/test_park",srsName:"EPSG:4326"}),i=new XMLSerializer,r=i.serializeToString(t);r=r.replace("geometry","geom");var s=new XMLHttpRequest;s.open("POST","http://localhost:8080/geoserver/wfs?service=wfs"),s.setRequestHeader("Content-Type","text/xml"),s.send(r)},doDrawRoad(){var n=this.startToEnd[0]||[32.25783016406104,72.12607562163872],e=this.startToEnd[1]||[46.43733140722661,82.97864003247012],t=["x1:"+n[0],"y1:"+n[1],"x2:"+e[0],"y2:"+e[1]];const i={LAYERS:"park_map:load_road_shortest",VERSION:"1.1.0",REQUEST:"GetMap",FORMAT:"image/png",exceptions:"application/vnd.ogc.se_inimage"};i.viewparams=t.join(";"),this.roadLayer=new pi({source:new Ji({url:"http://localhost:8080/geoserver/wms",params:i}),style:function(r,s){return new Ee({stroke:new ot({color:"red",width:8}),fill:new Be({color:"red"})})}}),this.map.addLayer(this.roadLayer)},doLoadGeoServer4WMS(){this.vectorLayer=new pi({opacity:.1,source:new Ji({url:"http://localhost:8080/geoserver/test_park/wms",params:{REQUEST:"GetMap",FORMAT:"image/png",VERSION:"1.3.0",LAYERS:"test_park:park_roads3",exceptions:"application/vnd.ogc.se_inimage"}})}),this.map.addLayer(this.vectorLayer)},doLoadGeoServer4WFS(){this.vectorLayer=new Me({source:new Ae({format:new oi,url:"http://localhost:8080/geoserver/wfs?version=1.1.0&request=GetFeature&typeName=park_map:bj_hx_live_wks_0217_b2_base&outputFormat=application/json&srsname=EPSG:4326"}),style:$r}),this.map.addLayer(this.vectorLayer)},doLoadMark4WFS(){this.vectorLayer=new Me({source:new Ae({format:new oi,url:"http://localhost:8080/geoserver/wfs?version=1.1.0&request=GetFeature&typeName=park_map:bj_hx_live_wks_0217_b2_mark&outputFormat=application/json&srsname=EPSG:4326"}),style:$r}),this.map.addLayer(this.vectorLayer)},doLoadRoadInfo4WFS(){this.vectorLayer=new Me({source:new Ae({format:new oi,url:"http://localhost:8080/geoserver/wfs?version=1.1.0&request=GetFeature&typeName=park_map:bj_hx_live_wks_0217_b2_road&outputFormat=application/json&srsname=EPSG:4326"})}),this.map.addLayer(this.vectorLayer)},doCheckStartToEnd(){if(this.checkRoadSwitch){this.map.un("singleclick",n),this.startToEnd=[],this.map.removeLayer(this.roadLayer),this.map.removeLayer(this.startLayer),this.map.removeLayer(this.endLayer),this.startLayer="",this.endLayer="",this.checkRoadSwitch=!this.checkRoadSwitch;return}var n=e=>{var t=e.coordinate;this.startToEnd.push(t),console.log(this.startToEnd);var i=new nt({geometry:new He(t)});i.setStyle(new Ee({image:new ai({src:"../定位.png",anchor:[.5,1]})})),console.log(this.startToEnd.length),this.startToEnd.length==1?(this.startLayer=new Me({source:new Ae}),this.startLayer.getSource().addFeature(i),this.map.addLayer(this.startLayer)):this.startToEnd.length==2?(this.endLayer=new Me({source:new Ae}),this.endLayer.getSource().addFeature(i),this.map.addLayer(this.endLayer)):(this.startToEnd=[],this.map.removeLayer(this.roadLayer),this.map.removeLayer(this.startLayer),this.map.removeLayer(this.endLayer),this.startLayer="",this.endLayer="")};this.map.on("singleclick",n),this.checkRoadSwitch=!this.checkRoadSwitch},resetCheckStartToEnd(){this.startToEnd=[],this.map.removeLayer(this.roadLayer),this.map.removeLayer(this.startLayer),this.map.removeLayer(this.endLayer),this.startLayer="",this.endLayer=""},doDimensionsAndTilt(){this.view=new fi({center:this.center,rotation:Math.PI/4,tile:60}),this.map.render()},doCesium4OpenLayer(){const n=new Wr({target:"openlayer-map",view:new fi({center:[0,0],zoom:2})});this.tileLayer=new Bt({source:new Bi}),n.addLayer(this.tileLayer);const e=new au("openlayer-map");this.cesiumScene=new lu(e),new lm({map:n}).start()}}},Em=Object.assign(Cm,{__name:"index-test",setup(n){return(e,t)=>{const i=Pt("el-button"),r=Pt("el-tag"),s=Pt("el-option"),o=Pt("el-select"),a=Pt("el-col"),l=Pt("el-input"),u=Pt("el-row");return yt(),Gt("div",null,[We("div",null,[H(i,{size:"small",onClick:t[0]||(t[0]=c=>e.printMapInfo())},{default:Y(()=>[ie("获取图层信息")]),_:1}),H(r,null,{default:Y(()=>[ie(" 图层数:"),We("span",null,Dt(e.mapInfo.layerCount),1)]),_:1}),H(r,null,{default:Y(()=>[ie(" 坐标系:"),We("span",null,Dt(e.mapInfo.projection),1)]),_:1}),H(r,null,{default:Y(()=>[ie(" 深度:"),We("span",null,Dt(e.mapInfo.zoom),1)]),_:1}),H(r,null,{default:Y(()=>[ie(" 分辨率:"),We("span",null,Dt(e.mapInfo.resolution),1)]),_:1}),cm,H(r,{for:""},{default:Y(()=>[ie("坐标转换")]),_:1}),H(o,{onChange:t[1]||(t[1]=c=>e.changeCoordinateType(Br.value)),modelValue:Br.value,"onUpdate:modelValue":t[2]||(t[2]=c=>Br.value=c),class:"m-2",placeholder:"Select",size:"small"},{default:Y(()=>[(yt(),Gt(li,null,ci(wm,c=>H(s,{key:c.value,label:c.label,value:c.value,disabled:!c.state},null,8,["label","value","disabled"])),64))]),_:1},8,["modelValue"]),um,H(r,{for:""},{default:Y(()=>[ie("图层管理")]),_:1}),H(o,{modelValue:Vr.value,"onUpdate:modelValue":t[3]||(t[3]=c=>Vr.value=c),class:"m-2",placeholder:"选择瓦片图层",size:"small",onChange:t[4]||(t[4]=c=>e.changeTileLayer(Vr.value))},{default:Y(()=>[(yt(),Gt(li,null,ci(pm,c=>H(s,{key:c.value,label:c.label,value:c.value,disabled:!c.state},null,8,["label","value","disabled"])),64))]),_:1},8,["modelValue"]),H(i,{size:"small",onClick:t[5]||(t[5]=c=>e.doTileGird())},{default:Y(()=>[ie("加载瓦片网格")]),_:1}),H(o,{modelValue:jr.value,"onUpdate:modelValue":t[6]||(t[6]=c=>jr.value=c),class:"m-2",placeholder:"选择矢量图层",size:"small",onChange:t[7]||(t[7]=c=>e.changeVectorLayer(jr.value))},{default:Y(()=>[(yt(),Gt(li,null,ci(ym,c=>H(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),H(o,{modelValue:kr.value,"onUpdate:modelValue":t[8]||(t[8]=c=>kr.value=c),class:"m-2",placeholder:"选择静态图层",size:"small",onChange:t[9]||(t[9]=c=>e.changeImageLayer(kr.value))},{default:Y(()=>[(yt(),Gt(li,null,ci(_m,c=>H(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),hm,H(r,{for:""},{default:Y(()=>[ie("控件管理")]),_:1}),H(i,{size:"small",onClick:t[10]||(t[10]=c=>e.doMousePosition())},{default:Y(()=>[ie("坐标提取")]),_:1}),H(i,{size:"small",onClick:t[11]||(t[11]=c=>e.testZoom())},{default:Y(()=>[ie("缩放控件")]),_:1}),H(i,{size:"small",onClick:t[12]||(t[12]=c=>e.doOverviewMap())},{default:Y(()=>[ie("鹰眼控件")]),_:1}),H(i,{size:"small",onClick:t[13]||(t[13]=c=>e.doFullScreen())},{default:Y(()=>[ie("全屏控件")]),_:1}),e.interactionSwitch?(yt(),ws(i,{key:1,size:"small",onClick:t[15]||(t[15]=c=>e.switchInteraction())},{default:Y(()=>[ie(" 关闭控件")]),_:1})):(yt(),ws(i,{key:0,size:"small",onClick:t[14]||(t[14]=c=>e.switchInteraction())},{default:Y(()=>[ie(" 打开控件 ")]),_:1})),H(u,{gutter:15},{default:Y(()=>[H(a,{span:3},{default:Y(()=>[H(r,{for:""},{default:Y(()=>[ie("地图导航")]),_:1})]),_:1}),H(a,{span:4},{default:Y(()=>[H(l,{modelValue:e.location1,"onUpdate:modelValue":t[16]||(t[16]=c=>e.location1=c),size:"small"},null,8,["modelValue"])]),_:1}),H(a,{span:4},{default:Y(()=>[H(l,{modelValue:e.location2,"onUpdate:modelValue":t[17]||(t[17]=c=>e.location2=c),size:"small"},null,8,["modelValue"])]),_:1}),H(a,{span:3},{default:Y(()=>[H(i,{size:"small",onClick:t[18]||(t[18]=c=>e.doLocation())},{default:Y(()=>[ie("定位当前")]),_:1})]),_:1}),H(a,{span:3},{default:Y(()=>[H(i,{size:"small",onClick:t[19]||(t[19]=c=>e.doFit())},{default:Y(()=>[ie("自适配区域")]),_:1})]),_:1})]),_:1}),H(r,{for:""},{default:Y(()=>[ie("绘制标注")]),_:1}),H(i,{size:"small",onClick:t[20]||(t[20]=c=>e.doInsertImage())},{default:Y(()=>[ie(" 插入Image ")]),_:1}),H(i,{size:"small",onClick:t[21]||(t[21]=c=>e.doInsertRegularShape())},{default:Y(()=>[ie(" 插入几何 ")]),_:1}),H(i,{size:"small",onClick:t[22]||(t[22]=c=>e.doInsertCanvas())},{default:Y(()=>[ie(" 插入Canvas ")]),_:1}),H(i,{size:"small",onClick:t[23]||(t[23]=c=>e.doInsertText())},{default:Y(()=>[ie(" 插入Text ")]),_:1}),H(i,{size:"small",onClick:t[24]||(t[24]=c=>e.doStyleFunction())},{default:Y(()=>[ie(" 应用StyleFun ")]),_:1}),H(i,{size:"small",onClick:t[25]||(t[25]=c=>e.doMultiMark())},{default:Y(()=>[ie(" 批量插入 ")]),_:1}),H(i,{size:"small",onClick:t[26]||(t[26]=c=>e.doOpenClickTopic())},{default:Y(()=>[ie(" 点击提示 ")]),_:1}),dm,H(r,{for:""},{default:Y(()=>[ie("绘制进阶")]),_:1}),H(i,{size:"small",onClick:t[27]||(t[27]=c=>e.doStartDraw())},{default:Y(()=>[ie(" 开启绘制 ")]),_:1}),H(o,{modelValue:Ur.value,"onUpdate:modelValue":t[28]||(t[28]=c=>Ur.value=c),class:"m-2",placeholder:"Select",size:"small",onChange:t[29]||(t[29]=c=>e.changeDraw(Ur.value))},{default:Y(()=>[(yt(),Gt(li,null,ci(Sm,c=>H(s,{key:c.value,label:c.label,value:c.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),fm,H(r,{for:""},{default:Y(()=>[ie("事件管理")]),_:1}),H(i,{size:"small",onClick:t[30]||(t[30]=c=>e.doFeatureStyle())},{default:Y(()=>[ie(" Feature样式/过滤/取消 ")]),_:1}),gm,H(r,{for:""},{default:Y(()=>[ie("GeoServer")]),_:1}),H(i,{size:"small",onClick:t[31]||(t[31]=c=>e.doModifyGeoServer())},{default:Y(()=>[ie("修改地图:"+Dt(e.modifySwitch),1)]),_:1}),H(i,{size:"small",onClick:t[32]||(t[32]=c=>e.doSaveGeoServer())},{default:Y(()=>[ie("保存地图")]),_:1}),H(i,{size:"small",onClick:t[33]||(t[33]=c=>e.doLoadGeoServer4WMS())},{default:Y(()=>[ie(" 加载地图(WMS) ")]),_:1}),H(i,{size:"small",onClick:t[34]||(t[34]=c=>e.doLoadGeoServer4WFS())},{default:Y(()=>[ie(" 加载地图(WFS) ")]),_:1}),H(i,{size:"small",onClick:t[35]||(t[35]=c=>e.doLoadMark4WFS())},{default:Y(()=>[ie(" 加载标注(WFS) ")]),_:1}),H(i,{size:"small",onClick:t[36]||(t[36]=c=>e.doLoadRoadInfo4WFS())},{default:Y(()=>[ie(" 加载路网(WFS) ")]),_:1}),H(i,{size:"small",onClick:t[37]||(t[37]=c=>e.doCheckStartToEnd())},{default:Y(()=>[ie(Dt(e.checkRoadSwitch?"关闭选点":"开启选点"),1)]),_:1}),H(i,{size:"small",onClick:t[38]||(t[38]=c=>e.doDrawRoad())},{default:Y(()=>[ie("绘制路径")]),_:1}),H(i,{size:"small",onClick:t[39]||(t[39]=c=>e.resetCheckStartToEnd())},{default:Y(()=>[ie("重新选点")]),_:1})]),H(r,{for:""},{default:Y(()=>[ie("进阶")]),_:1}),H(i,{size:"small",onClick:t[40]||(t[40]=c=>e.do3D())},{default:Y(()=>[ie("3D渲染")]),_:1}),H(i,{disabled:"ture",size:"small",onClick:t[41]||(t[41]=c=>e.doDimensionsAndTilt())},{default:Y(()=>[ie("维度与仰角")]),_:1}),H(i,{size:"small",onClick:t[42]||(t[42]=c=>e.doCesium4OpenLayer())},{default:Y(()=>[ie("Cesium2.5D插件")]),_:1}),mm])}}}),Zm=Object.freeze(Object.defineProperty({__proto__:null,default:Em},Symbol.toStringTag,{value:"Module"}));export{km as L,Bm as a,Zm as i};
